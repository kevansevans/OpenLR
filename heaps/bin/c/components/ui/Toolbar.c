// Generated by HLC 4.1.5 (HL v5)
#define HLC_BOOT
#include <hlc.h>
#include <components/ui/Toolbar.h>
#include <components/tool/ToolBehavior.h>
#include <_std/Main.h>
bool components_ui_UIButton_set_selected(components__ui__UIButton,bool);
extern $Main g$_Main;
void components_tool_ToolBehavior_setToolPencil(components__tool__ToolBehavior);
void components_tool_ToolBehavior_setToolLine(components__tool__ToolBehavior);
void components_tool_ToolBehavior_setToolEraser(components__tool__ToolBehavior);
#include <components/ui/Icon.h>
void h2d_Object_new(h2d__Object,h2d__Object);
extern hl_type t$hl_types_ArrayObj;
void hl_types_ArrayObj_new(hl__types__ArrayObj);
extern hl_type t$components_ui_UIButton;
extern venum* g$components_ui_Icon_PENCIL;
void components_ui_UIButton_new(components__ui__UIButton,venum*);
int hl_types_ArrayObj_push(hl__types__ArrayObj,vdynamic*);
extern venum* g$components_ui_Icon_LINE;
extern venum* g$components_ui_Icon_ERASER;
extern hl_type t$fun_e358c02;
void components_ui_Toolbar_sort(components__ui__Toolbar);
void h2d_Object_addChild(h2d__Object,h2d__Object);

void components_ui_Toolbar_new__$1(components__ui__Toolbar r0) {
	components__ui__UIButton r2;
	bool r1;
	$Main r5;
	components__tool__ToolBehavior r4;
	if( r0 == NULL ) hl_null_access();
	r2 = r0->activetool;
	if( r2 == NULL ) hl_null_access();
	r1 = false;
	r1 = components_ui_UIButton_set_selected(r2,r1);
	r2 = r0->pencil;
	if( r2 == NULL ) hl_null_access();
	r1 = true;
	r1 = components_ui_UIButton_set_selected(r2,r1);
	r2 = r0->pencil;
	r0->activetool = r2;
	r5 = ($Main)g$_Main;
	r4 = r5->toolControl;
	if( r4 == NULL ) hl_null_access();
	components_tool_ToolBehavior_setToolPencil(r4);
	return;
}

void components_ui_Toolbar_new__$2(components__ui__Toolbar r0) {
	components__ui__UIButton r2;
	bool r1;
	$Main r5;
	components__tool__ToolBehavior r4;
	if( r0 == NULL ) hl_null_access();
	r2 = r0->activetool;
	if( r2 == NULL ) hl_null_access();
	r1 = false;
	r1 = components_ui_UIButton_set_selected(r2,r1);
	r2 = r0->line;
	if( r2 == NULL ) hl_null_access();
	r1 = true;
	r1 = components_ui_UIButton_set_selected(r2,r1);
	r2 = r0->line;
	r0->activetool = r2;
	r5 = ($Main)g$_Main;
	r4 = r5->toolControl;
	if( r4 == NULL ) hl_null_access();
	components_tool_ToolBehavior_setToolLine(r4);
	return;
}

void components_ui_Toolbar_new__$3(components__ui__Toolbar r0) {
	components__ui__UIButton r2;
	bool r1;
	$Main r5;
	components__tool__ToolBehavior r4;
	if( r0 == NULL ) hl_null_access();
	r2 = r0->activetool;
	if( r2 == NULL ) hl_null_access();
	r1 = false;
	r1 = components_ui_UIButton_set_selected(r2,r1);
	r2 = r0->eraser;
	if( r2 == NULL ) hl_null_access();
	r1 = true;
	r1 = components_ui_UIButton_set_selected(r2,r1);
	r2 = r0->eraser;
	r0->activetool = r2;
	r5 = ($Main)g$_Main;
	r4 = r5->toolControl;
	if( r4 == NULL ) hl_null_access();
	components_tool_ToolBehavior_setToolEraser(r4);
	return;
}

void components_ui_Toolbar_new(components__ui__Toolbar r0,h2d__Object r1) {
	components__ui__UIButton r5;
	hl__types__ArrayObj r3;
	venum *r6;
	bool r7;
	vclosure *r8;
	int r4;
	h2d_Object_new(((h2d__Object)r0),r1);
	r3 = (hl__types__ArrayObj)hl_alloc_obj(&t$hl_types_ArrayObj);
	hl_types_ArrayObj_new(r3);
	r0->icons = r3;
	r3 = r0->icons;
	if( r3 == NULL ) hl_null_access();
	r5 = (components__ui__UIButton)hl_alloc_obj(&t$components_ui_UIButton);
	r6 = (venum*)g$components_ui_Icon_PENCIL;
	components_ui_UIButton_new(r5,r6);
	r0->pencil = r5;
	r4 = hl_types_ArrayObj_push(r3,((vdynamic*)r5));
	r3 = r0->icons;
	if( r3 == NULL ) hl_null_access();
	r5 = (components__ui__UIButton)hl_alloc_obj(&t$components_ui_UIButton);
	r6 = (venum*)g$components_ui_Icon_LINE;
	components_ui_UIButton_new(r5,r6);
	r0->line = r5;
	r4 = hl_types_ArrayObj_push(r3,((vdynamic*)r5));
	r3 = r0->icons;
	if( r3 == NULL ) hl_null_access();
	r5 = (components__ui__UIButton)hl_alloc_obj(&t$components_ui_UIButton);
	r6 = (venum*)g$components_ui_Icon_ERASER;
	components_ui_UIButton_new(r5,r6);
	r0->eraser = r5;
	r4 = hl_types_ArrayObj_push(r3,((vdynamic*)r5));
	r5 = r0->pencil;
	if( r5 == NULL ) hl_null_access();
	r7 = true;
	r7 = components_ui_UIButton_set_selected(r5,r7);
	r5 = r0->pencil;
	r0->activetool = r5;
	r5 = r0->pencil;
	if( r5 == NULL ) hl_null_access();
	r8 = hl_alloc_closure_ptr(&t$fun_e358c02,components_ui_Toolbar_new__$1,r0);
	r5->onClick = r8;
	r5 = r0->line;
	if( r5 == NULL ) hl_null_access();
	r8 = hl_alloc_closure_ptr(&t$fun_e358c02,components_ui_Toolbar_new__$2,r0);
	r5->onClick = r8;
	r5 = r0->eraser;
	if( r5 == NULL ) hl_null_access();
	r8 = hl_alloc_closure_ptr(&t$fun_e358c02,components_ui_Toolbar_new__$3,r0);
	r5->onClick = r8;
	components_ui_Toolbar_sort(r0);
	return;
}

void components_ui_Toolbar_sort(components__ui__Toolbar r0) {
	components__ui__UIButton r8;
	hl__types__ArrayObj r4;
	bool r11;
	double r12;
	vdynamic *r9;
	varray *r10;
	int r1, r3, r5, r6, r7;
	r1 = 0;
	r4 = r0->icons;
	if( r4 == NULL ) hl_null_access();
	r3 = r4->length;
	label$f59b206_5_4:
	if( r1 >= r3 ) goto label$f59b206_5_29;
	r5 = r1;
	++r1;
	r4 = r0->icons;
	if( r4 == NULL ) hl_null_access();
	r7 = r4->length;
	if( ((unsigned)r5) < ((unsigned)r7) ) goto label$f59b206_5_14;
	r8 = NULL;
	goto label$f59b206_5_17;
	label$f59b206_5_14:
	r10 = r4->array;
	r9 = ((vdynamic**)(r10 + 1))[r5];
	r8 = (components__ui__UIButton)r9;
	label$f59b206_5_17:
	h2d_Object_addChild(((h2d__Object)r0),((h2d__Object)r8));
	if( r8 == NULL ) hl_null_access();
	r11 = true;
	r8->posChanged = r11;
	r6 = 30;
	r6 = r6 * r5;
	r7 = 3;
	r7 = r7 * r5;
	r6 = r6 + r7;
	r12 = (double)r6;
	r8->x = r12;
	goto label$f59b206_5_4;
	label$f59b206_5_29:
	return;
}

double components_ui_Toolbar_get_width(components__ui__Toolbar r0) {
	hl__types__ArrayObj r3;
	double r5;
	int r1, r2, r4;
	r1 = 30;
	r3 = r0->icons;
	if( r3 == NULL ) hl_null_access();
	r2 = r3->length;
	r1 = r1 * r2;
	r2 = 3;
	r3 = r0->icons;
	if( r3 == NULL ) hl_null_access();
	r4 = r3->length;
	r2 = r2 * r4;
	r1 = r1 + r2;
	r5 = (double)r1;
	return r5;
}

