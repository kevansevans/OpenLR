// Generated by HLC 4.1.5 (HL v5)
#define HLC_BOOT
#include <hlc.h>
#include <components/tool/ToolFunction.h>
#include <components/stage/Canvas.h>
#include <_std/Main.h>
#include <haxe/ds/StringMap.h>
#include <hxlr/engine/Grid.h>
#include <hxlr/engine/Cell.h>
#include <hl/types/ArrayObj.h>
#include <h2d/col/Point.h>
#include <components/tool/ToolBehavior.h>
extern String s$;
extern $Main g$_Main;
vvirtual* hxlr_engine_Cell_getInfo(double,double);
extern hl_type t$String;
vdynamic* haxe_ds_StringMap_get(haxe__ds__StringMap,String);
#include <hl/natives.h>
extern components__tool__$ToolFunction g$_components_tool_ToolFunction;
void components_tool_ToolFunction_tryDispose(hxlr__lines__LineBase);
#include <components/stage/DrawMode.h>
venum* components_stage_Canvas_get_drawMode(components__stage__Canvas);
void hxlr_engine_Grid_unregister(hxlr__engine__Grid,hxlr__lines__LineBase);

void components_tool_ToolFunction_eraseDefault(double r0,double r1) {
	String r2, r13;
	hl__types__ArrayObj r21;
	haxe__ds__StringMap r18;
	vvirtual *r14;
	bool r34;
	components__tool__$ToolFunction r33;
	hxlr__engine__Grid r19;
	hxlr__engine__Cell r20;
	$Main r7;
	components__tool__ToolBehavior r35;
	h2d__col__Point r26;
	hxlr__lines__LineBase r24;
	components__stage__Canvas r6;
	double r4, r5, r15, r16, r27, r28, r29, r30, r31, r32;
	vdynamic *r17;
	varray *r25;
	int r8, r9, r10, r11, r12, r22, r23;
	r2 = (String)s$;
	r4 = 1.;
	r7 = ($Main)g$_Main;
	r6 = r7->canvas;
	if( r6 == NULL ) hl_null_access();
	r5 = r6->scaleX;
	r4 = r4 / r5;
	r8 = -1;
	label$24f39e4_1_8:
	r10 = 2;
	if( r8 >= r10 ) goto label$24f39e4_1_146;
	r9 = r8;
	++r8;
	r10 = -1;
	label$24f39e4_1_14:
	r12 = 2;
	if( r10 >= r12 ) goto label$24f39e4_1_145;
	r11 = r10;
	++r10;
	r15 = (double)r9;
	r5 = r0 + r15;
	r16 = (double)r11;
	r15 = r1 + r16;
	r14 = hxlr_engine_Cell_getInfo(r5,r15);
	if( r14 == NULL ) hl_null_access();
	r13 = hl_vfields(r14)[2] ? (*(String*)(hl_vfields(r14)[2])) : (String)hl_dyn_getp(r14->value,5343647/*key*/,&t$String);
	r7 = ($Main)g$_Main;
	r19 = r7->grid;
	if( r19 == NULL ) hl_null_access();
	r18 = r19->registry;
	if( r18 == NULL ) hl_null_access();
	r17 = haxe_ds_StringMap_get(r18,r13);
	r20 = (hxlr__engine__Cell)r17;
	if( r20 ) goto label$24f39e4_1_35;
	goto label$24f39e4_1_14;
	label$24f39e4_1_35:
	r7 = ($Main)g$_Main;
	r19 = r7->grid;
	if( r19 == NULL ) hl_null_access();
	r18 = r19->registry;
	if( r18 == NULL ) hl_null_access();
	r17 = haxe_ds_StringMap_get(r18,r13);
	r20 = (hxlr__engine__Cell)r17;
	r12 = 0;
	if( r20 == NULL ) hl_null_access();
	r21 = r20->allLines;
	label$24f39e4_1_45:
	if( r21 == NULL ) hl_null_access();
	r23 = r21->length;
	if( r12 >= r23 ) goto label$24f39e4_1_144;
	r23 = r21->length;
	if( ((unsigned)r12) < ((unsigned)r23) ) goto label$24f39e4_1_53;
	r24 = NULL;
	goto label$24f39e4_1_56;
	label$24f39e4_1_53:
	r25 = r21->array;
	r17 = ((vdynamic**)(r25 + 1))[r12];
	r24 = (hxlr__lines__LineBase)r17;
	label$24f39e4_1_56:
	++r12;
	if( r24 ) goto label$24f39e4_1_59;
	goto label$24f39e4_1_45;
	label$24f39e4_1_59:
	if( r24 == NULL ) hl_null_access();
	r26 = r24->start;
	if( r26 == NULL ) hl_null_access();
	r16 = r26->x;
	r15 = r0 - r16;
	r26 = r24->start;
	if( r26 == NULL ) hl_null_access();
	r27 = r26->y;
	r16 = r1 - r27;
	r28 = 2.;
	r27 = hl_math_pow(r15,r28);
	r29 = 2.;
	r28 = hl_math_pow(r16,r29);
	r27 = r27 + r28;
	r27 = hl_math_sqrt(r27);
	r26 = r24->end;
	if( r26 == NULL ) hl_null_access();
	r29 = r26->x;
	r28 = r0 - r29;
	r29 = 2.;
	r28 = hl_math_pow(r28,r29);
	r26 = r24->end;
	if( r26 == NULL ) hl_null_access();
	r30 = r26->y;
	r29 = r1 - r30;
	r30 = 2.;
	r29 = hl_math_pow(r29,r30);
	r28 = r28 + r29;
	r28 = hl_math_sqrt(r28);
	r29 = r24->nx;
	r29 = r29 * r15;
	r30 = r24->ny;
	r30 = r30 * r16;
	r29 = r29 + r30;
	r29 = hl_math_abs(r29);
	r31 = r24->dx;
	r30 = r15 * r31;
	r32 = r24->dy;
	r31 = r16 * r32;
	r30 = r30 + r31;
	r31 = r24->invSqrDistance;
	r30 = r30 * r31;
	r33 = (components__tool__$ToolFunction)g$_components_tool_ToolFunction;
	r32 = r33->eraserSize;
	r32 = r32 * r4;
	if( r27 < r32 ) goto label$24f39e4_1_117;
	r33 = (components__tool__$ToolFunction)g$_components_tool_ToolFunction;
	r32 = r33->eraserSize;
	r32 = r32 * r4;
	if( r28 < r32 ) goto label$24f39e4_1_117;
	r33 = (components__tool__$ToolFunction)g$_components_tool_ToolFunction;
	r32 = r33->eraserSize;
	r32 = r32 * r4;
	if( !(r29 < r32) ) goto label$24f39e4_1_143;
	r32 = 0.;
	if( !(r30 >= r32) ) goto label$24f39e4_1_143;
	r32 = 1.;
	if( !(r32 >= r30) ) goto label$24f39e4_1_143;
	label$24f39e4_1_117:
	r7 = ($Main)g$_Main;
	r35 = r7->toolControl;
	if( r35 == NULL ) hl_null_access();
	r34 = r35->colorEraser;
	if( !r34 ) goto label$24f39e4_1_141;
	r22 = 3;
	r7 = ($Main)g$_Main;
	r35 = r7->toolControl;
	if( r35 == NULL ) hl_null_access();
	r23 = r35->color;
	switch(r23) {
		default:
			goto label$24f39e4_1_137;
		case 0:
			r23 = 0;
			r22 = r23;
			goto label$24f39e4_1_137;
		case 1:
			r23 = 1;
			r22 = r23;
			goto label$24f39e4_1_137;
		case 2:
			r23 = 2;
			r22 = r23;
	}
	label$24f39e4_1_137:
	r23 = r24->type;
	if( r23 != r22 ) goto label$24f39e4_1_140;
	components_tool_ToolFunction_tryDispose(r24);
	label$24f39e4_1_140:
	goto label$24f39e4_1_142;
	label$24f39e4_1_141:
	components_tool_ToolFunction_tryDispose(r24);
	label$24f39e4_1_142:
	goto label$24f39e4_1_45;
	label$24f39e4_1_143:
	goto label$24f39e4_1_45;
	label$24f39e4_1_144:
	goto label$24f39e4_1_14;
	label$24f39e4_1_145:
	goto label$24f39e4_1_8;
	label$24f39e4_1_146:
	return;
}

void components_tool_ToolFunction_tryDispose(hxlr__lines__LineBase r0) {
	venum *r3;
	hxlr__engine__Grid r6;
	$Main r5;
	components__stage__Canvas r4;
	int r2, r7;
	r5 = ($Main)g$_Main;
	r4 = r5->canvas;
	if( r4 == NULL ) hl_null_access();
	r3 = components_stage_Canvas_get_drawMode(r4);
	if( r3 == NULL ) hl_null_access();
	r2 = HL__ENUM_INDEX__(r3);
	switch(r2) {
		default:
			goto label$24f39e4_2_30;
		case 0:
		case 1:
			r5 = ($Main)g$_Main;
			r6 = r5->grid;
			if( r6 == NULL ) hl_null_access();
			hxlr_engine_Grid_unregister(r6,r0);
			goto label$24f39e4_2_30;
		case 2:
		case 3:
			if( r0 == NULL ) hl_null_access();
			r2 = r0->type;
			r7 = 2;
			if( r2 == r7 ) goto label$24f39e4_2_21;
			r5 = ($Main)g$_Main;
			r6 = r5->grid;
			if( r6 == NULL ) hl_null_access();
			hxlr_engine_Grid_unregister(r6,r0);
			label$24f39e4_2_21:
			goto label$24f39e4_2_30;
		case 4:
		case 5:
			if( r0 == NULL ) hl_null_access();
			r2 = r0->type;
			r7 = 2;
			if( r2 != r7 ) goto label$24f39e4_2_30;
			r5 = ($Main)g$_Main;
			r6 = r5->grid;
			if( r6 == NULL ) hl_null_access();
			hxlr_engine_Grid_unregister(r6,r0);
	}
	label$24f39e4_2_30:
	return;
}

