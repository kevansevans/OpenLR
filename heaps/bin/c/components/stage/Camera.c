// Generated by HLC 4.1.5 (HL v5)
#define HLC_BOOT
#include <hlc.h>
#include <components/stage/Camera.h>
#include <components/stage/Canvas.h>
#include <_std/Main.h>
#include <hxlr/components/ContactPoint.h>
#include <h3d/Engine.h>
extern hl_type t$h2d_col_Point;
extern $Main g$_Main;
void h2d_col_Point_new(h2d__col__Point,double*,double*);
#include <h2d/Object.h>
h2d__col__Point h2d_Object_localToGlobal(h2d__Object,h2d__col__Point);
#include <haxe/ds/StringMap.h>
#include <components/managers/Riders.h>
vdynamic* haxe_ds_StringMap_get(haxe__ds__StringMap,String);

void components_stage_Camera_start(components__stage__Camera r0) {
	String r3;
	bool r2;
	components__sledder__RiderBase r14;
	$Main r7;
	h3d__Engine r16;
	h2d__col__Point r4;
	hxlr__components__ContactPoint r13;
	components__stage__Canvas r6;
	double r5, r9, r11, r12, r17;
	double *r8, *r10;
	int r15;
	r2 = r0->enabled;
	if( r2 ) goto label$ddcd7e0_1_5;
	r3 = r0->riderFollow;
	if( r3 ) goto label$ddcd7e0_1_5;
	return;
	label$ddcd7e0_1_5:
	r4 = (h2d__col__Point)hl_alloc_obj(&t$h2d_col_Point);
	r7 = ($Main)g$_Main;
	r6 = r7->canvas;
	if( r6 == NULL ) hl_null_access();
	r5 = r6->x;
	r8 = &r5;
	r7 = ($Main)g$_Main;
	r6 = r7->canvas;
	if( r6 == NULL ) hl_null_access();
	r9 = r6->y;
	r10 = &r9;
	h2d_col_Point_new(r4,r8,r10);
	r0->lastPosition = r4;
	r7 = ($Main)g$_Main;
	r6 = r7->canvas;
	if( r6 == NULL ) hl_null_access();
	r11 = r6->scaleX;
	r0->lastScale = r11;
	r7 = ($Main)g$_Main;
	r6 = r7->canvas;
	r11 = r0->cameraScale;
	if( r6 == NULL ) hl_null_access();
	r2 = true;
	r6->posChanged = r2;
	r6->scaleX = r11;
	r2 = true;
	r6->posChanged = r2;
	r6->scaleY = r11;
	r7 = ($Main)g$_Main;
	r6 = r7->canvas;
	if( r6 == NULL ) hl_null_access();
	r2 = true;
	r6->posChanged = r2;
	r14 = r0->rider;
	if( r14 == NULL ) hl_null_access();
	r13 = r14->cameraPoint;
	if( r13 == NULL ) hl_null_access();
	r4 = r13->pos;
	if( r4 == NULL ) hl_null_access();
	r11 = r4->x;
	r7 = ($Main)g$_Main;
	r16 = r7->locengine;
	if( r16 == NULL ) hl_null_access();
	r15 = r16->width;
	r12 = (double)r15;
	r17 = 2.;
	r12 = r12 / r17;
	r11 = r11 + r12;
	r6->x = r11;
	r7 = ($Main)g$_Main;
	r6 = r7->canvas;
	if( r6 == NULL ) hl_null_access();
	r2 = true;
	r6->posChanged = r2;
	r14 = r0->rider;
	if( r14 == NULL ) hl_null_access();
	r13 = r14->cameraPoint;
	if( r13 == NULL ) hl_null_access();
	r4 = r13->pos;
	if( r4 == NULL ) hl_null_access();
	r11 = r4->y;
	r7 = ($Main)g$_Main;
	r16 = r7->locengine;
	if( r16 == NULL ) hl_null_access();
	r15 = r16->height;
	r12 = (double)r15;
	r17 = 2.;
	r12 = r12 / r17;
	r11 = r11 + r12;
	r6->y = r11;
	r2 = true;
	r0->running = r2;
	return;
}

void components_stage_Camera_follow(components__stage__Camera r0) {
	bool r22;
	$Main r7;
	components__sledder__RiderBase r3;
	h3d__Engine r14;
	h2d__col__Point r1, r5;
	hxlr__components__ContactPoint r2;
	components__stage__Canvas r6;
	double r8, r10, r12, r15, r16, r17, r18, r19, r20, r21;
	double *r9, *r11;
	int r13;
	r3 = r0->rider;
	if( r3 == NULL ) hl_null_access();
	r2 = r3->cameraPoint;
	if( r2 == NULL ) hl_null_access();
	r1 = r2->pos;
	r7 = ($Main)g$_Main;
	r6 = r7->canvas;
	if( r6 == NULL ) hl_null_access();
	r5 = (h2d__col__Point)hl_alloc_obj(&t$h2d_col_Point);
	if( r1 == NULL ) hl_null_access();
	r8 = r1->x;
	r9 = &r8;
	r10 = r1->y;
	r11 = &r10;
	h2d_col_Point_new(r5,r9,r11);
	r5 = h2d_Object_localToGlobal(((h2d__Object)r6),r5);
	r7 = ($Main)g$_Main;
	r14 = r7->locengine;
	if( r14 == NULL ) hl_null_access();
	r13 = r14->width;
	r12 = (double)r13;
	r15 = 0.59999999999999998;
	r12 = r12 * r15;
	r7 = ($Main)g$_Main;
	r14 = r7->locengine;
	if( r14 == NULL ) hl_null_access();
	r13 = r14->width;
	r15 = (double)r13;
	r16 = 0.29999999999999999;
	r15 = r15 * r16;
	r7 = ($Main)g$_Main;
	r14 = r7->locengine;
	if( r14 == NULL ) hl_null_access();
	r13 = r14->height;
	r16 = (double)r13;
	r17 = 0.29999999999999999;
	r16 = r16 * r17;
	r7 = ($Main)g$_Main;
	r14 = r7->locengine;
	if( r14 == NULL ) hl_null_access();
	r13 = r14->height;
	r17 = (double)r13;
	r18 = 0.59999999999999998;
	r17 = r17 * r18;
	r18 = 0.;
	r19 = 0.;
	if( r5 == NULL ) hl_null_access();
	r20 = r5->x;
	if( !(r12 < r20) ) goto label$ddcd7e0_2_53;
	r21 = r5->x;
	r20 = r12 - r21;
	r18 = r20;
	goto label$ddcd7e0_2_58;
	label$ddcd7e0_2_53:
	r20 = r5->x;
	if( !(r20 < r15) ) goto label$ddcd7e0_2_58;
	r21 = r5->x;
	r20 = r15 - r21;
	r18 = r20;
	label$ddcd7e0_2_58:
	r20 = r5->y;
	if( !(r17 < r20) ) goto label$ddcd7e0_2_64;
	r21 = r5->y;
	r20 = r17 - r21;
	r19 = r20;
	goto label$ddcd7e0_2_69;
	label$ddcd7e0_2_64:
	r20 = r5->y;
	if( !(r20 < r16) ) goto label$ddcd7e0_2_69;
	r21 = r5->y;
	r20 = r16 - r21;
	r19 = r20;
	label$ddcd7e0_2_69:
	r7 = ($Main)g$_Main;
	r6 = r7->canvas;
	if( r6 == NULL ) hl_null_access();
	r22 = true;
	r6->posChanged = r22;
	r20 = r6->x;
	r20 = r20 + r18;
	r6->x = r20;
	r7 = ($Main)g$_Main;
	r6 = r7->canvas;
	if( r6 == NULL ) hl_null_access();
	r22 = true;
	r6->posChanged = r22;
	r20 = r6->y;
	r20 = r20 + r19;
	r6->y = r20;
	return;
}

void components_stage_Camera_stop(components__stage__Camera r0) {
	bool r1;
	r1 = false;
	r0->running = r1;
	return;
}

String components_stage_Camera_set_riderFollow(components__stage__Camera r0,String r1) {
	components__managers__Riders r4;
	haxe__ds__StringMap r3;
	components__sledder__RiderBase r6;
	$Main r5;
	vdynamic *r2;
	r5 = ($Main)g$_Main;
	r4 = r5->riders;
	if( r4 == NULL ) hl_null_access();
	r3 = r4->riders;
	if( r3 == NULL ) hl_null_access();
	r2 = haxe_ds_StringMap_get(r3,r1);
	r6 = (components__sledder__RiderBase)r2;
	r0->rider = r6;
	r0->riderFollow = r1;
	return r1;
}

void components_stage_Camera_new(components__stage__Camera r0,String r1) {
	String r4;
	bool r3;
	double r2;
	r2 = 6.;
	r0->cameraScale = r2;
	r3 = false;
	r0->running = r3;
	r3 = false;
	r0->enabled = r3;
	r4 = components_stage_Camera_set_riderFollow(r0,r1);
	return;
}

