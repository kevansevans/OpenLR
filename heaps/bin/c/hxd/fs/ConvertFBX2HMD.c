// Generated by HLC 4.1.5 (HL v5)
#define HLC_BOOT
#include <hlc.h>
#include <hxd/fs/ConvertFBX2HMD.h>
extern String s$fbx;
extern hl_type t$vrt_f85eed7;
extern String s$hmd;
void hxd_fs_Convert_new(hxd__fs__Convert,vvirtual*,String);
#include <haxe/Exception.h>
#include <hxd/fmt/fbx/HMDOut.h>
#include <hxd/fmt/hmd/Data.h>
#include <haxe/io/BytesOutput.h>
#include <hxd/fmt/hmd/Writer.h>
vvirtual* hxd_fmt_fbx_Parser_parse(haxe__io__Bytes);
haxe__Exception haxe_Exception_caught(vdynamic*);
String Std_string(vdynamic*);
extern String s$2865b0e;
String String___add__(String,String);
vdynamic* haxe_Exception_thrown(vdynamic*);
extern hl_type t$hxd_fmt_fbx_HMDOut;
void hxd_fmt_fbx_HMDOut_new(hxd__fmt__fbx__HMDOut,String);
#include <hxd/fmt/fbx/BaseLibrary.h>
void hxd_fmt_fbx_BaseLibrary_load(hxd__fmt__fbx__BaseLibrary,vvirtual*);
extern String s$Anim_;
bool StringTools_startsWith(String,String);
String String_toLowerCase(String);
extern String s$_anim_;
int String_indexOf(String,String,vdynamic*);
hxd__fmt__hmd__Data hxd_fmt_fbx_HMDOut_toHMD(hxd__fmt__fbx__HMDOut,String,bool);
extern hl_type t$haxe_io_BytesOutput;
void haxe_io_BytesOutput_new(haxe__io__BytesOutput);
extern hl_type t$hxd_fmt_hmd_Writer;
#include <haxe/io/Output.h>
void hxd_fmt_hmd_Writer_new(hxd__fmt__hmd__Writer,haxe__io__Output);
void hxd_fmt_hmd_Writer_write(hxd__fmt__hmd__Writer,hxd__fmt__hmd__Data);
haxe__io__Bytes haxe_io_BytesOutput_getBytes(haxe__io__BytesOutput);
void hxd_fs_Convert_save(hxd__fs__Convert,haxe__io__Bytes);

void hxd_fs_ConvertFBX2HMD_new(hxd__fs__ConvertFBX2HMD r0) {
	String r2;
	vvirtual *r3;
	r2 = (String)s$fbx;
	r3 = hl_to_virtual(&t$vrt_f85eed7,(vdynamic*)r2);
	r2 = (String)s$hmd;
	hxd_fs_Convert_new(((hxd__fs__Convert)r0),r3,r2);
	return;
}

void hxd_fs_ConvertFBX2HMD_convert(hxd__fs__ConvertFBX2HMD r0) {
	hxd__fmt__hmd__Data r15;
	String r8, r9;
	vvirtual *r3;
	hxd__fmt__fbx__HMDOut r10;
	bool r11, r16;
	haxe__io__Bytes r4;
	hxd__fmt__hmd__Writer r18;
	haxe__io__BytesOutput r17;
	haxe__Exception r6;
	vdynamic *r2, *r5, *r7, *r13;
	int r12, r14;
	hl_trap_ctx trap$0;
	hl_trap(trap$0,r2,label$bada073_2_5);
	r4 = r0->srcBytes;
	r3 = hxd_fmt_fbx_Parser_parse(r4);
	hl_endtrap(trap$0);
	goto label$bada073_2_16;
	label$bada073_2_5:
	r5 = NULL;
	r6 = haxe_Exception_caught(r2);
	if( r6 == NULL ) hl_null_access();
	r5 = ((vdynamic* (*)(haxe__Exception))r6->$type->vobj_proto[0])(r6);
	r8 = Std_string(r5);
	r9 = (String)s$2865b0e;
	r8 = String___add__(r8,r9);
	r9 = r0->srcPath;
	r8 = String___add__(r8,r9);
	r7 = haxe_Exception_thrown(((vdynamic*)r8));
	hl_throw((vdynamic*)r7);
	label$bada073_2_16:
	r10 = (hxd__fmt__fbx__HMDOut)hl_alloc_obj(&t$hxd_fmt_fbx_HMDOut);
	r8 = r0->srcPath;
	hxd_fmt_fbx_HMDOut_new(r10,r8);
	hxd_fmt_fbx_BaseLibrary_load(((hxd__fmt__fbx__BaseLibrary)r10),r3);
	r8 = r0->originalFilename;
	r9 = (String)s$Anim_;
	r11 = StringTools_startsWith(r8,r9);
	if( r11 ) goto label$bada073_2_35;
	r8 = r0->originalFilename;
	if( r8 == NULL ) hl_null_access();
	r8 = String_toLowerCase(r8);
	if( r8 == NULL ) hl_null_access();
	r9 = (String)s$_anim_;
	r13 = NULL;
	r12 = String_indexOf(r8,r9,r13);
	r14 = 0;
	if( r14 < r12 ) goto label$bada073_2_35;
	r11 = false;
	goto label$bada073_2_36;
	label$bada073_2_35:
	r11 = true;
	label$bada073_2_36:
	r8 = NULL;
	r16 = !r11;
	r15 = hxd_fmt_fbx_HMDOut_toHMD(r10,r8,r16);
	r17 = (haxe__io__BytesOutput)hl_alloc_obj(&t$haxe_io_BytesOutput);
	haxe_io_BytesOutput_new(r17);
	r18 = (hxd__fmt__hmd__Writer)hl_alloc_obj(&t$hxd_fmt_hmd_Writer);
	hxd_fmt_hmd_Writer_new(r18,((haxe__io__Output)r17));
	hxd_fmt_hmd_Writer_write(r18,r15);
	r4 = haxe_io_BytesOutput_getBytes(r17);
	hxd_fs_Convert_save(((hxd__fs__Convert)r0),r4);
	return;
}

