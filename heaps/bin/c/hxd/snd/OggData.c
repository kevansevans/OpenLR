// Generated by HLC 4.1.5 (HL v5)
#define HLC_BOOT
#include <hlc.h>
#include <hxd/snd/OggData.h>
#include <hl/natives.h>
extern String s$Failed_to_decode_OGG_data;
vdynamic* haxe_Exception_thrown(vdynamic*);
extern venum* g$hxd_snd_SampleFormat_I16;
hxd__snd__Data hxd_snd_Data_resample(hxd__snd__Data,int,venum*,int);
extern hl_type t$hxd_snd_OggData;
extern String s$Invalid_sample_start;
int hxd_snd_Data_getBytesPerSample(hxd__snd__Data);
extern String s$assert;
extern venum* g$hxd_snd_SampleFormat_UI8;

void hxd_snd_OggData_new(hxd__snd__OggData r0,haxe__io__Bytes r1) {
	String r7;
	venum *r15;
	fmt_ogg *r2;
	int *r11, *r12, *r13, *r14;
	vdynamic *r6;
	int r4, r8, r9, r10;
	vbyte *r3;
	r0->bytes = r1;
	if( r1 == NULL ) hl_null_access();
	r3 = r1->b;
	r4 = r1->length;
	r2 = fmt_ogg_open(r3,r4);
	r0->reader = r2;
	r2 = r0->reader;
	if( r2 ) goto label$e9c200e_1_11;
	r7 = (String)s$Failed_to_decode_OGG_data;
	r6 = haxe_Exception_thrown(((vdynamic*)r7));
	hl_throw((vdynamic*)r6);
	label$e9c200e_1_11:
	r4 = 0;
	r8 = 0;
	r9 = 0;
	r10 = 0;
	r2 = r0->reader;
	r11 = &r4;
	r12 = &r8;
	r13 = &r9;
	r14 = &r10;
	fmt_ogg_info(r2,r11,r12,r13,r14);
	r0->channels = r10;
	r0->samples = r9;
	r15 = (venum*)g$hxd_snd_SampleFormat_I16;
	r0->sampleFormat = r15;
	r0->samplingRate = r8;
	return;
}

hxd__snd__Data hxd_snd_OggData_resample(hxd__snd__OggData r0,int r1,venum* r2,int r3) {
	hxd__snd__OggData r8;
	haxe__io__Bytes r9;
	hxd__snd__Data r6;
	int r5, r7;
	if( r2 == NULL ) hl_null_access();
	r5 = HL__ENUM_INDEX__(r2);
	switch(r5) {
		default:
			r6 = hxd_snd_Data_resample(((hxd__snd__Data)r0),r1,r2,r3);
			return r6;
		case 0:
		case 1:
			r7 = r0->channels;
			if( r3 != r7 ) goto label$e9c200e_2_14;
			r7 = r0->samplingRate;
			if( r1 != r7 ) goto label$e9c200e_2_14;
			r8 = (hxd__snd__OggData)hl_alloc_obj(&t$hxd_snd_OggData);
			r9 = r0->bytes;
			hxd_snd_OggData_new(r8,r9);
			r8->sampleFormat = r2;
			return ((hxd__snd__Data)r8);
			label$e9c200e_2_14:
			r6 = hxd_snd_Data_resample(((hxd__snd__Data)r0),r1,r2,r3);
			return r6;
	}
}

void hxd_snd_OggData_decodeBuffer(hxd__snd__OggData r0,haxe__io__Bytes r1,int r2,int r3,int r4) {
	String r11;
	venum *r14, *r20;
	fmt_ogg *r9;
	bool r8;
	vdynamic *r10;
	vbyte *r12, *r13;
	int r6, r7, r15, r16, r17, r18, r19;
	r6 = r0->currentSample;
	if( r6 == r3 ) goto label$e9c200e_3_9;
	r0->currentSample = r3;
	r9 = r0->reader;
	r8 = fmt_ogg_seek(r9,r3);
	if( r8 ) goto label$e9c200e_3_9;
	r11 = (String)s$Invalid_sample_start;
	r10 = haxe_Exception_thrown(((vdynamic*)r11));
	hl_throw((vdynamic*)r10);
	label$e9c200e_3_9:
	r6 = hxd_snd_Data_getBytesPerSample(((hxd__snd__Data)r0));
	if( r1 == NULL ) hl_null_access();
	r12 = r1->b;
	r13 = hl_bytes_offset(r12,r2);
	r12 = r13;
	r14 = r0->sampleFormat;
	if( r14 == NULL ) hl_null_access();
	r7 = HL__ENUM_INDEX__(r14);
	switch(r7) {
		default:
			r11 = (String)s$assert;
			r10 = haxe_Exception_thrown(((vdynamic*)r11));
			hl_throw((vdynamic*)r10);
		case 0:
			r15 = 257;
			r7 = r15;
			goto label$e9c200e_3_26;
		case 1:
			r15 = 2;
			r7 = r15;
	}
	label$e9c200e_3_26:
	r15 = r4 * r6;
	label$e9c200e_3_27:
	r17 = 0;
	if( r17 >= r15 ) goto label$e9c200e_3_53;
	r9 = r0->reader;
	r16 = fmt_ogg_read(r9,r12,r15,r7);
	r18 = 0;
	if( r16 >= r18 ) goto label$e9c200e_3_37;
	r11 = (String)s$Failed_to_decode_OGG_data;
	r10 = haxe_Exception_thrown(((vdynamic*)r11));
	hl_throw((vdynamic*)r10);
	label$e9c200e_3_37:
	r18 = 0;
	if( r16 != r18 ) goto label$e9c200e_3_48;
	r17 = 0;
	r14 = r0->sampleFormat;
	r20 = (venum*)g$hxd_snd_SampleFormat_UI8;
	if( r14 != r20 ) goto label$e9c200e_3_45;
	r19 = 128;
	goto label$e9c200e_3_46;
	label$e9c200e_3_45:
	r19 = 0;
	label$e9c200e_3_46:
	hl_bytes_fill(r12,r17,r15,r19);
	goto label$e9c200e_3_53;
	label$e9c200e_3_48:
	r17 = r15 - r16;
	r15 = r17;
	r13 = hl_bytes_offset(r12,r16);
	r12 = r13;
	goto label$e9c200e_3_27;
	label$e9c200e_3_53:
	r16 = r0->currentSample;
	r16 = r16 + r4;
	r0->currentSample = r16;
	return;
}

