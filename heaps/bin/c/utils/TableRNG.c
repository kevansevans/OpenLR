// Generated by HLC 4.1.5 (HL v5)
#define HLC_BOOT
#include <hlc.h>
#include <utils/TableRNG.h>
extern hl_type t$hl_types_ArrayBytes_Int;
void hl_types_ArrayBytes_Int_new(hl__types__ArrayBytes_Int);
extern hl_type t$haxe_ds_StringMap;
void haxe_ds_StringMap_new(haxe__ds__StringMap);
int hl_types_ArrayBytes_Int_push(hl__types__ArrayBytes_Int,int);
extern hl_type t$_i32;
hl__types__ArrayBytes_Int utils_TableRNG_riffleShuffle(utils__TableRNG,hl__types__ArrayBytes_Int,int*);
#include <hl/types/ArrayBase.h>
double utils_TableRNG_getRandomNormal(utils__TableRNG,String);
int utils_TableRNG_getRandom(utils__TableRNG,String);
hl__types__ArrayBase hl_types_ArrayBytes_Int_slice(hl__types__ArrayBytes_Int,int,vdynamic*);
extern hl_type t$hl_types_ArrayBase;
vdynamic* hl_types_ArrayBytes_Int_shift(hl__types__ArrayBytes_Int);
extern String s$random;
vdynamic* haxe_ds_StringMap_get(haxe__ds__StringMap,String);
void haxe_ds_StringMap_set(haxe__ds__StringMap,String,vdynamic*);

void utils_TableRNG_new(utils__TableRNG r0,int* r1,int* r2) {
	haxe__ds__StringMap r7;
	hl__types__ArrayBytes_Int r5;
	int r3, r4, r8, r9, r10, r11, r12, r13;
	if( r1 ) goto label$5026d2c_1_3;
	r3 = 256;
	goto label$5026d2c_1_4;
	label$5026d2c_1_3:
	r3 = *r1;
	label$5026d2c_1_4:
	if( r2 ) goto label$5026d2c_1_7;
	r4 = 8;
	goto label$5026d2c_1_8;
	label$5026d2c_1_7:
	r4 = *r2;
	label$5026d2c_1_8:
	r5 = (hl__types__ArrayBytes_Int)hl_alloc_obj(&t$hl_types_ArrayBytes_Int);
	hl_types_ArrayBytes_Int_new(r5);
	r0->values = r5;
	r7 = (haxe__ds__StringMap)hl_alloc_obj(&t$haxe_ds_StringMap);
	haxe_ds_StringMap_new(r7);
	r0->keys = r7;
	r9 = 1;
	r8 = r3 - r9;
	r0->limit = r8;
	r8 = 0;
	r9 = r4;
	label$5026d2c_1_19:
	if( r8 >= r9 ) goto label$5026d2c_1_33;
	++r8;
	r10 = 0;
	r11 = r3;
	label$5026d2c_1_24:
	if( r10 >= r11 ) goto label$5026d2c_1_32;
	r12 = r10;
	++r10;
	r5 = r0->values;
	if( r5 == NULL ) hl_null_access();
	r13 = hl_types_ArrayBytes_Int_push(r5,r12);
	goto label$5026d2c_1_24;
	label$5026d2c_1_32:
	goto label$5026d2c_1_19;
	label$5026d2c_1_33:
	return;
}

void utils_TableRNG_shuffle(utils__TableRNG r0,vdynamic* r1) {
	hl__types__ArrayBytes_Int r3;
	int *r4;
	int r2;
	if( r1 ) goto label$5026d2c_2_3;
	r2 = 1;
	r1 = hl_alloc_dynamic(&t$_i32);
	r1->v.i = r2;
	label$5026d2c_2_3:
	r3 = r0->values;
	if( r1 ) goto label$5026d2c_2_7;
	r4 = NULL;
	goto label$5026d2c_2_9;
	label$5026d2c_2_7:
	r2 = r1 ? r1->v.i : 0;
	r4 = &r2;
	label$5026d2c_2_9:
	r3 = utils_TableRNG_riffleShuffle(r0,r3,r4);
	r0->values = r3;
	return;
}

hl__types__ArrayBytes_Int utils_TableRNG_riffleShuffle(utils__TableRNG r0,hl__types__ArrayBytes_Int r1,int* r2) {
	String r18;
	bool r27;
	hl__types__ArrayBase r20;
	hl__types__ArrayBytes_Int r6, r9, r14, r23, r24;
	double r4, r7, r15, r17;
	vdynamic *r22;
	vbyte *r26;
	int r3, r5, r10, r11, r12, r13, r16, r19, r21, r25;
	if( r2 ) goto label$5026d2c_3_3;
	r3 = 1;
	goto label$5026d2c_3_4;
	label$5026d2c_3_3:
	r3 = *r2;
	label$5026d2c_3_4:
	if( r1 == NULL ) hl_null_access();
	r5 = r1->length;
	r4 = (double)r5;
	r7 = 2.;
	r4 = r4 / r7;
	r5 = (int)r4;
	r6 = (hl__types__ArrayBytes_Int)hl_alloc_obj(&t$hl_types_ArrayBytes_Int);
	hl_types_ArrayBytes_Int_new(r6);
	r9 = r1;
	r10 = 0;
	r11 = r3;
	label$5026d2c_3_15:
	if( r10 >= r11 ) goto label$5026d2c_3_133;
	++r10;
	r12 = 0;
	if( r1 == NULL ) hl_null_access();
	r13 = r1->length;
	r7 = (double)r13;
	r15 = 2.;
	r7 = r7 / r15;
	r13 = (int)r7;
	r16 = r1->length;
	r15 = (double)r16;
	r17 = 8.;
	r15 = r15 / r17;
	r18 = NULL;
	r17 = utils_TableRNG_getRandomNormal(r0,r18);
	r15 = r15 * r17;
	r18 = NULL;
	r16 = utils_TableRNG_getRandom(r0,r18);
	r19 = 2;
	r16 = r19 == 0 ? 0 : r16 % r19;
	r19 = 0;
	if( r16 != r19 ) goto label$5026d2c_3_40;
	r16 = 1;
	goto label$5026d2c_3_41;
	label$5026d2c_3_40:
	r16 = -1;
	label$5026d2c_3_41:
	r17 = (double)r16;
	r15 = r15 * r17;
	r19 = (int)r15;
	r16 = r13 - r19;
	if( r9 == NULL ) hl_null_access();
	r19 = 0;
	r22 = hl_alloc_dynamic(&t$_i32);
	r22->v.i = r16;
	r20 = hl_types_ArrayBytes_Int_slice(r9,r19,r22);
	r14 = (hl__types__ArrayBytes_Int)hl_dyn_castp(&r20,&t$hl_types_ArrayBase,&t$hl_types_ArrayBytes_Int);
	r21 = r9->length;
	r22 = hl_alloc_dynamic(&t$_i32);
	r22->v.i = r21;
	r20 = hl_types_ArrayBytes_Int_slice(r9,r16,r22);
	r23 = (hl__types__ArrayBytes_Int)hl_dyn_castp(&r20,&t$hl_types_ArrayBase,&t$hl_types_ArrayBytes_Int);
	r24 = (hl__types__ArrayBytes_Int)hl_alloc_obj(&t$hl_types_ArrayBytes_Int);
	hl_types_ArrayBytes_Int_new(r24);
	r9 = r24;
	r19 = 0;
	label$5026d2c_3_58:
	if( r23 == NULL ) hl_null_access();
	r25 = r23->length;
	if( r19 >= r25 ) goto label$5026d2c_3_74;
	r25 = r23->length;
	if( ((unsigned)r19) < ((unsigned)r25) ) goto label$5026d2c_3_66;
	r21 = 0;
	goto label$5026d2c_3_70;
	label$5026d2c_3_66:
	r26 = r23->bytes;
	r25 = 2;
	r25 = r19 << r25;
	r21 = *(int*)(r26 + r25);
	label$5026d2c_3_70:
	++r19;
	if( r9 == NULL ) hl_null_access();
	r25 = hl_types_ArrayBytes_Int_push(r9,r21);
	goto label$5026d2c_3_58;
	label$5026d2c_3_74:
	r19 = 0;
	label$5026d2c_3_75:
	if( r14 == NULL ) hl_null_access();
	r25 = r14->length;
	if( r19 >= r25 ) goto label$5026d2c_3_91;
	r25 = r14->length;
	if( ((unsigned)r19) < ((unsigned)r25) ) goto label$5026d2c_3_83;
	r21 = 0;
	goto label$5026d2c_3_87;
	label$5026d2c_3_83:
	r26 = r14->bytes;
	r25 = 2;
	r25 = r19 << r25;
	r21 = *(int*)(r26 + r25);
	label$5026d2c_3_87:
	++r19;
	if( r9 == NULL ) hl_null_access();
	r25 = hl_types_ArrayBytes_Int_push(r9,r21);
	goto label$5026d2c_3_75;
	label$5026d2c_3_91:
	if( r9 == NULL ) hl_null_access();
	r19 = 0;
	r22 = hl_alloc_dynamic(&t$_i32);
	r22->v.i = r5;
	r20 = hl_types_ArrayBytes_Int_slice(r9,r19,r22);
	r24 = (hl__types__ArrayBytes_Int)hl_dyn_castp(&r20,&t$hl_types_ArrayBase,&t$hl_types_ArrayBytes_Int);
	r14 = r24;
	if( r1 == NULL ) hl_null_access();
	r21 = r1->length;
	r22 = hl_alloc_dynamic(&t$_i32);
	r22->v.i = r21;
	r20 = hl_types_ArrayBytes_Int_slice(r9,r5,r22);
	r24 = (hl__types__ArrayBytes_Int)hl_dyn_castp(&r20,&t$hl_types_ArrayBase,&t$hl_types_ArrayBytes_Int);
	r23 = r24;
	r24 = (hl__types__ArrayBytes_Int)hl_alloc_obj(&t$hl_types_ArrayBytes_Int);
	hl_types_ArrayBytes_Int_new(r24);
	r6 = r24;
	label$5026d2c_3_106:
	r27 = true;
	if( !r27 ) goto label$5026d2c_3_131;
	r21 = 2;
	r19 = r21 == 0 ? 0 : r12 % r21;
	r21 = 0;
	if( r19 != r21 ) goto label$5026d2c_3_119;
	if( r6 == NULL ) hl_null_access();
	if( r23 == NULL ) hl_null_access();
	r22 = hl_types_ArrayBytes_Int_shift(r23);
	r19 = r22 ? r22->v.i : 0;
	r19 = hl_types_ArrayBytes_Int_push(r6,r19);
	goto label$5026d2c_3_124;
	label$5026d2c_3_119:
	if( r6 == NULL ) hl_null_access();
	if( r14 == NULL ) hl_null_access();
	r22 = hl_types_ArrayBytes_Int_shift(r14);
	r19 = r22 ? r22->v.i : 0;
	r19 = hl_types_ArrayBytes_Int_push(r6,r19);
	label$5026d2c_3_124:
	++r12;
	r19 = r6->length;
	if( r1 == NULL ) hl_null_access();
	r21 = r1->length;
	if( r19 != r21 ) goto label$5026d2c_3_130;
	goto label$5026d2c_3_131;
	label$5026d2c_3_130:
	goto label$5026d2c_3_106;
	label$5026d2c_3_131:
	r9 = r6;
	goto label$5026d2c_3_15;
	label$5026d2c_3_133:
	return r9;
}

int utils_TableRNG_getRandom(utils__TableRNG r0,String r1) {
	String r2;
	haxe__ds__StringMap r5;
	hl__types__ArrayBytes_Int r9;
	vdynamic *r4, *r6, *r10;
	vbyte *r11;
	int r7, r8;
	if( r1 ) goto label$5026d2c_4_3;
	r2 = (String)s$random;
	r1 = r2;
	label$5026d2c_4_3:
	r5 = r0->keys;
	if( r5 == NULL ) hl_null_access();
	r4 = haxe_ds_StringMap_get(r5,r1);
	r6 = (vdynamic*)r4;
	if( r6 ) goto label$5026d2c_4_13;
	r5 = r0->keys;
	if( r5 == NULL ) hl_null_access();
	r7 = -1;
	r6 = hl_alloc_dynamic(&t$_i32);
	r6->v.i = r7;
	haxe_ds_StringMap_set(r5,r1,((vdynamic*)r6));
	label$5026d2c_4_13:
	r5 = r0->keys;
	if( r5 == NULL ) hl_null_access();
	r4 = haxe_ds_StringMap_get(r5,r1);
	r6 = (vdynamic*)r4;
	r7 = r6 ? r6->v.i : 0;
	r8 = 1;
	r7 = r7 + r8;
	r6 = hl_alloc_dynamic(&t$_i32);
	r6->v.i = r7;
	haxe_ds_StringMap_set(r5,r1,((vdynamic*)r6));
	r5 = r0->keys;
	if( r5 == NULL ) hl_null_access();
	r4 = haxe_ds_StringMap_get(r5,r1);
	r6 = (vdynamic*)r4;
	r9 = r0->values;
	if( r9 == NULL ) hl_null_access();
	r7 = r9->length;
	r10 = hl_alloc_dynamic(&t$_i32);
	r10->v.i = r7;
	if( r6 != r10 && (!r6 || !r10 || (r6->v.i != r10->v.i)) ) goto label$5026d2c_4_36;
	r5 = r0->keys;
	if( r5 == NULL ) hl_null_access();
	r7 = 0;
	r6 = hl_alloc_dynamic(&t$_i32);
	r6->v.i = r7;
	haxe_ds_StringMap_set(r5,r1,((vdynamic*)r6));
	label$5026d2c_4_36:
	r9 = r0->values;
	if( r9 == NULL ) hl_null_access();
	r5 = r0->keys;
	if( r5 == NULL ) hl_null_access();
	r4 = haxe_ds_StringMap_get(r5,r1);
	r6 = (vdynamic*)r4;
	r7 = r6 ? r6->v.i : 0;
	r8 = r9->length;
	if( ((unsigned)r7) < ((unsigned)r8) ) goto label$5026d2c_4_47;
	r7 = 0;
	goto label$5026d2c_4_51;
	label$5026d2c_4_47:
	r11 = r9->bytes;
	r8 = 2;
	r8 = r7 << r8;
	r7 = *(int*)(r11 + r8);
	label$5026d2c_4_51:
	return r7;
}

double utils_TableRNG_getRandomNormal(utils__TableRNG r0,String r1) {
	String r2;
	double r3, r5;
	int r4;
	if( r1 ) goto label$5026d2c_5_3;
	r2 = (String)s$random;
	r1 = r2;
	label$5026d2c_5_3:
	r4 = utils_TableRNG_getRandom(r0,r1);
	r3 = (double)r4;
	r4 = r0->limit;
	r5 = (double)r4;
	r3 = r3 / r5;
	return r3;
}

int utils_TableRNG_getRandomDecrease(utils__TableRNG r0,String r1) {
	String r2;
	haxe__ds__StringMap r5;
	hl__types__ArrayBytes_Int r9;
	vdynamic *r4, *r6;
	vbyte *r10;
	int r7, r8;
	if( r1 ) goto label$5026d2c_6_3;
	r2 = (String)s$random;
	r1 = r2;
	label$5026d2c_6_3:
	r5 = r0->keys;
	if( r5 == NULL ) hl_null_access();
	r4 = haxe_ds_StringMap_get(r5,r1);
	r6 = (vdynamic*)r4;
	if( r6 ) goto label$5026d2c_6_13;
	r5 = r0->keys;
	if( r5 == NULL ) hl_null_access();
	r7 = -1;
	r6 = hl_alloc_dynamic(&t$_i32);
	r6->v.i = r7;
	haxe_ds_StringMap_set(r5,r1,((vdynamic*)r6));
	label$5026d2c_6_13:
	r5 = r0->keys;
	if( r5 == NULL ) hl_null_access();
	r4 = haxe_ds_StringMap_get(r5,r1);
	r6 = (vdynamic*)r4;
	r7 = r6 ? r6->v.i : 0;
	r8 = 1;
	r7 = r7 - r8;
	r6 = hl_alloc_dynamic(&t$_i32);
	r6->v.i = r7;
	haxe_ds_StringMap_set(r5,r1,((vdynamic*)r6));
	r5 = r0->keys;
	if( r5 == NULL ) hl_null_access();
	r4 = haxe_ds_StringMap_get(r5,r1);
	r6 = (vdynamic*)r4;
	r7 = r6 ? r6->v.i : 0;
	r8 = -1;
	if( r8 < r7 ) goto label$5026d2c_6_38;
	r9 = r0->values;
	if( r9 == NULL ) hl_null_access();
	r7 = r9->length;
	r8 = 1;
	r7 = r7 - r8;
	r5 = r0->keys;
	if( r5 == NULL ) hl_null_access();
	r6 = hl_alloc_dynamic(&t$_i32);
	r6->v.i = r7;
	haxe_ds_StringMap_set(r5,r1,((vdynamic*)r6));
	label$5026d2c_6_38:
	r9 = r0->values;
	if( r9 == NULL ) hl_null_access();
	r5 = r0->keys;
	if( r5 == NULL ) hl_null_access();
	r4 = haxe_ds_StringMap_get(r5,r1);
	r6 = (vdynamic*)r4;
	r7 = r6 ? r6->v.i : 0;
	r8 = r9->length;
	if( ((unsigned)r7) < ((unsigned)r8) ) goto label$5026d2c_6_49;
	r7 = 0;
	goto label$5026d2c_6_53;
	label$5026d2c_6_49:
	r10 = r9->bytes;
	r8 = 2;
	r8 = r7 << r8;
	r7 = *(int*)(r10 + r8);
	label$5026d2c_6_53:
	return r7;
}

double utils_TableRNG_getRandomNormalDecrease(utils__TableRNG r0,String r1) {
	String r2;
	double r3, r5;
	int r4;
	if( r1 ) goto label$5026d2c_7_3;
	r2 = (String)s$random;
	r1 = r2;
	label$5026d2c_7_3:
	r4 = utils_TableRNG_getRandomDecrease(r0,r1);
	r3 = (double)r4;
	r4 = r0->limit;
	r5 = (double)r4;
	r3 = r3 / r5;
	return r3;
}

void utils_TableRNG_setKeyOffset(utils__TableRNG r0,String r1,int r2) {
	haxe__ds__StringMap r4;
	vdynamic *r5;
	r4 = r0->keys;
	if( r4 == NULL ) hl_null_access();
	r5 = hl_alloc_dynamic(&t$_i32);
	r5->v.i = r2;
	haxe_ds_StringMap_set(r4,r1,((vdynamic*)r5));
	return;
}

