// Generated by HLC 4.1.5 (HL v5)
#define HLC_BOOT
#include <hlc.h>
#include <hxlr/engine/Cell.h>
#include <hl/natives.h>
extern hl_type t$vrt_689169c;
extern hl_type t$_i32;
extern hl_type t$vrt_2d77f2c;
extern String s$x;
String String___alloc__(vbyte*,int);
String String___add__(String,String);
extern String s$y;
extern hl_type t$String;
extern hl_type t$hl_types_ArrayObj;
void hl_types_ArrayObj_new(hl__types__ArrayObj);
#include <hxlr/lines/LineBase.h>
bool hl_types_ArrayObj_contains(hl__types__ArrayObj,vdynamic*);
int hl_types_ArrayObj_push(hl__types__ArrayObj,vdynamic*);
void hl_types_ArrayObj___expand(hl__types__ArrayObj,int);
extern hxlr__engine__$Cell g$_hxlr_engine_Cell;
bool hl_types_ArrayObj_remove(hl__types__ArrayObj,vdynamic*);

vvirtual* hxlr_engine_Cell_getInfo(double r0,double r1) {
	String r12, r15;
	vvirtual *r7, *r11;
	double r3, r4, r6, r9, r10;
	int *r13;
	vbyte *r14;
	int r2, r5, r8;
	r4 = 14.;
	r3 = r0 / r4;
	r2 = hl_math_floor(r3);
	r3 = (double)r2;
	r2 = (int)r3;
	r6 = 14.;
	r4 = r1 / r6;
	r5 = hl_math_floor(r4);
	r4 = (double)r5;
	r7 = hl_alloc_virtual(&t$vrt_689169c);
	if( hl_vfields(r7)[2] ) *(int*)(hl_vfields(r7)[2]) = (int)r2; else hl_dyn_seti(r7->value,120/*x*/,&t$_i32,r2);
	r5 = (int)r4;
	if( hl_vfields(r7)[3] ) *(int*)(hl_vfields(r7)[3]) = (int)r5; else hl_dyn_seti(r7->value,121/*y*/,&t$_i32,r5);
	r5 = 14;
	r10 = 14.;
	r9 = r0 / r10;
	r8 = hl_math_floor(r9);
	r5 = r5 * r8;
	r9 = (double)r5;
	r6 = r0 - r9;
	if( hl_vfields(r7)[0] ) *(double*)(hl_vfields(r7)[0]) = (double)r6; else hl_dyn_setd(r7->value,23089/*gx*/,r6);
	r5 = 14;
	r10 = 14.;
	r9 = r1 / r10;
	r8 = hl_math_floor(r9);
	r5 = r5 * r8;
	r9 = (double)r5;
	r6 = r1 - r9;
	if( hl_vfields(r7)[1] ) *(double*)(hl_vfields(r7)[1]) = (double)r6; else hl_dyn_setd(r7->value,23090/*gy*/,r6);
	r11 = hl_to_virtual(&t$vrt_2d77f2c,(vdynamic*)r7);
	r12 = (String)s$x;
	r5 = hl_vfields(r11)[3] ? (*(int*)(hl_vfields(r11)[3])) : (int)hl_dyn_geti(r11->value,120/*x*/,&t$_i32);
	r13 = &r5;
	r14 = hl_itos(r5,r13);
	r15 = String___alloc__(r14,r5);
	r12 = String___add__(r12,r15);
	r15 = (String)s$y;
	r12 = String___add__(r12,r15);
	r5 = hl_vfields(r11)[4] ? (*(int*)(hl_vfields(r11)[4])) : (int)hl_dyn_geti(r11->value,121/*y*/,&t$_i32);
	r13 = &r5;
	r14 = hl_itos(r5,r13);
	r15 = String___alloc__(r14,r5);
	r12 = String___add__(r12,r15);
	if( hl_vfields(r11)[2] ) *(String*)(hl_vfields(r11)[2]) = (String)r12; else hl_dyn_setp(r11->value,5343647/*key*/,&t$String,r12);
	return r11;
}

void hxlr_engine_Cell_new(hxlr__engine__Cell r0,vvirtual* r1) {
	hl__types__ArrayObj r2;
	r0->info = r1;
	r2 = (hl__types__ArrayObj)hl_alloc_obj(&t$hl_types_ArrayObj);
	hl_types_ArrayObj_new(r2);
	r0->allLines = r2;
	r2 = (hl__types__ArrayObj)hl_alloc_obj(&t$hl_types_ArrayObj);
	hl_types_ArrayObj_new(r2);
	r0->collidable = r2;
	r2 = (hl__types__ArrayObj)hl_alloc_obj(&t$hl_types_ArrayObj);
	hl_types_ArrayObj_new(r2);
	r0->intangible = r2;
	return;
}

void hxlr_engine_Cell_addLine(hxlr__engine__Cell r0,hxlr__lines__LineBase r1) {
	hxlr__engine__$Cell r9;
	hl__types__ArrayObj r4;
	bool r3;
	vdynamic *r6;
	varray *r8;
	int r5, r7;
	r4 = r0->allLines;
	if( r4 == NULL ) hl_null_access();
	r3 = hl_types_ArrayObj_contains(r4,((vdynamic*)r1));
	if( !r3 ) goto label$f139353_3_5;
	return;
	label$f139353_3_5:
	r4 = r0->allLines;
	if( r4 == NULL ) hl_null_access();
	r5 = hl_types_ArrayObj_push(r4,((vdynamic*)r1));
	if( r1 == NULL ) hl_null_access();
	r3 = r1->tangible;
	if( !r3 ) goto label$f139353_3_21;
	r4 = r0->collidable;
	if( r4 == NULL ) hl_null_access();
	r6 = r1->id;
	r5 = r6 ? r6->v.i : 0;
	r7 = r4->length;
	if( ((unsigned)r5) < ((unsigned)r7) ) goto label$f139353_3_18;
	hl_types_ArrayObj___expand(r4,r5);
	label$f139353_3_18:
	r8 = r4->array;
	((hxlr__lines__LineBase*)(r8 + 1))[r5] = r1;
	goto label$f139353_3_30;
	label$f139353_3_21:
	r4 = r0->intangible;
	if( r4 == NULL ) hl_null_access();
	r6 = r1->id;
	r5 = r6 ? r6->v.i : 0;
	r7 = r4->length;
	if( ((unsigned)r5) < ((unsigned)r7) ) goto label$f139353_3_28;
	hl_types_ArrayObj___expand(r4,r5);
	label$f139353_3_28:
	r8 = r4->array;
	((hxlr__lines__LineBase*)(r8 + 1))[r5] = r1;
	label$f139353_3_30:
	r9 = (hxlr__engine__$Cell)g$_hxlr_engine_Cell;
	r4 = r9->cellList;
	if( r4 == NULL ) hl_null_access();
	r3 = hl_types_ArrayObj_contains(r4,((vdynamic*)r0));
	if( r3 ) goto label$f139353_3_39;
	r9 = (hxlr__engine__$Cell)g$_hxlr_engine_Cell;
	r4 = r9->cellList;
	if( r4 == NULL ) hl_null_access();
	r5 = hl_types_ArrayObj_push(r4,((vdynamic*)r0));
	label$f139353_3_39:
	return;
}

void hxlr_engine_Cell_removeLine(hxlr__engine__Cell r0,hxlr__lines__LineBase r1) {
	hxlr__engine__$Cell r7;
	hl__types__ArrayObj r4;
	bool r3;
	int r5, r6;
	r4 = r0->allLines;
	if( r4 == NULL ) hl_null_access();
	r3 = hl_types_ArrayObj_contains(r4,((vdynamic*)r1));
	if( r3 ) goto label$f139353_4_5;
	return;
	label$f139353_4_5:
	r4 = r0->allLines;
	if( r4 == NULL ) hl_null_access();
	r3 = hl_types_ArrayObj_remove(r4,((vdynamic*)r1));
	if( r1 == NULL ) hl_null_access();
	r3 = r1->tangible;
	if( !r3 ) goto label$f139353_4_15;
	r4 = r0->collidable;
	if( r4 == NULL ) hl_null_access();
	r3 = hl_types_ArrayObj_remove(r4,((vdynamic*)r1));
	goto label$f139353_4_18;
	label$f139353_4_15:
	r4 = r0->intangible;
	if( r4 == NULL ) hl_null_access();
	r3 = hl_types_ArrayObj_remove(r4,((vdynamic*)r1));
	label$f139353_4_18:
	r4 = r0->allLines;
	if( r4 == NULL ) hl_null_access();
	r5 = r4->length;
	r6 = 0;
	if( r5 != r6 ) goto label$f139353_4_27;
	r7 = (hxlr__engine__$Cell)g$_hxlr_engine_Cell;
	r4 = r7->cellList;
	if( r4 == NULL ) hl_null_access();
	r3 = hl_types_ArrayObj_remove(r4,((vdynamic*)r0));
	label$f139353_4_27:
	return;
}

