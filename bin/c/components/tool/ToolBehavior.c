// Generated by HLC 4.1.5 (HL v5)
#define HLC_BOOT
#include <hlc.h>
#include <components/tool/ToolBehavior.h>
#include <hxd/Event.h>
#include <hl/types/ArrayDyn.h>
#include <haxe/Log.h>
#include <components/stage/Canvas.h>
#include <_std/Main.h>
#include <components/managers/Simulation.h>
extern haxe__$Log g$_haxe_Log;
extern hl_type t$_i32;
extern hl_type t$vrt_329ffa8;
extern String s$3b33a12;
extern hl_type t$String;
extern String s$components_tool_ToolBehavior;
extern String s$mouseDown;
extern hl_type t$vrt_eaa6a3b;
extern hl_type t$h2d_col_Point;
extern $Main g$_Main;
#include <h2d/Scene.h>
double h2d_Scene_get_mouseX(h2d__Scene);
double h2d_Scene_get_mouseY(h2d__Scene);
void h2d_col_Point_new(h2d__col__Point,double*,double*);
#include <hl/natives.h>
void components_stage_Canvas_erase(components__stage__Canvas);
void components_managers_Simulation_backSim(components__managers__Simulation);
void components_managers_Simulation_stepSim(components__managers__Simulation);
void components_stage_Canvas_zoomCanvas(components__stage__Canvas,int);
void components_tool_ToolBehavior_drawLine(components__tool__ToolBehavior);
void components_tool_ToolBehavior_updatePreview(components__tool__ToolBehavior);
void components_stage_Canvas_addCanvasPosition(components__stage__Canvas,double,double);
#include <components/managers/Grid.h>
#include <h2d/Object.h>
#include <h2d/Graphics.h>
void components_managers_Grid_unregister(components__managers__Grid,components__lines__LineBase);
void components_stage_Canvas_addLine(components__stage__Canvas,int,double,double,double,double,vdynamic*,vdynamic*);
#include <hxd/EventKind.h>
#include <components/stage/DrawMode.h>
#include <components/managers/Musicplayer.h>
#include <components/stage/LRConsole.h>
venum* components_stage_Canvas_get_drawMode(components__stage__Canvas);
extern venum* g$994fdec;
venum* components_stage_Canvas_set_drawMode(components__stage__Canvas,venum*);
extern venum* g$92fe76c;
extern venum* g$ab5747c;
extern venum* g$ba7542c;
extern venum* g$2a65ad1;
extern venum* g$6537d82;
void components_managers_Musicplayer_stopMusic(components__managers__Musicplayer);
void components_managers_Simulation_pauseSim(components__managers__Simulation);
void components_managers_Simulation_resumeSim(components__managers__Simulation);
void components_tool_ToolBehavior_updateCursor(components__tool__ToolBehavior);
extern String s$Line_type_set_to_Normal;
#include <h2d/Console.h>
void h2d_Console_log(h2d__Console,String,vdynamic*);
extern String s$Line_type_set_to_Accel;
extern String s$Line_type_set_to_Scenery;
extern venum* g$components_tool_ToolMode_ERASER;
extern String s$Tool_set_to_Eraser;
extern venum* g$components_tool_ToolMode_PENCIL;
extern String s$Tool_set_to_Pencil;
void components_managers_Simulation_startSim(components__managers__Simulation);
extern venum* g$components_tool_ToolMode_LINE;
extern String s$Tool_set_to_Line;
void components_managers_Simulation_endSim(components__managers__Simulation);
double Math_max(double,double);
extern String s$Ruler_width_set_to_;
String String___alloc__(vbyte*,int);
String String___add__(String,String);
extern String s$Max_left_bitshift_reached;
void components_managers_Simulation_updateSim(components__managers__Simulation);
void components_managers_Musicplayer_playMusic(components__managers__Musicplayer,int);
#include <h2d/Interactive.h>
extern venum* g$hxd_Cursor_Default;
venum* h2d_Interactive_set_cursor(h2d__Interactive,venum*);
void components_tool_ToolBehavior_updatePencilCursor(components__tool__ToolBehavior);
void components_tool_ToolBehavior_updateLineCursor(components__tool__ToolBehavior);
#include <hxd/res/Loader.h>
#include <hxd/res/Resource.h>
#include <hxd/res/Image.h>
#include <hxd/CustomCursor.h>
#include <hl/types/ArrayObj.h>
extern hl_type t$fun_112ee0a;
hxd__res__Loader hxd_Res_get_loader(void);
extern String s$tool_pencilBlue_png;
extern hxd__res__$Image g$_hxd_res_Image;
hxd__res__Resource hxd_res_Loader_loadCache(hxd__res__Loader,String,hl__Class);
hxd__BitmapData hxd_res_Image_toBitmap(hxd__res__Image);
extern hl_type t$hxd_CustomCursor;
extern hl_type t$hxd_BitmapData;
hl__types__ArrayObj hl_types_ArrayObj_alloc(varray*);
void hxd_CustomCursor_new(hxd__CustomCursor,hl__types__ArrayObj,double,int,int);
extern hl_type t$hxd_Cursor;
extern String s$tool_pencilRed_png;
extern String s$tool_pencilGreen_png;
extern String s$tool_lineBlue_png;
extern String s$tool_lineRed_png;
extern String s$tool_lineGreen_png;

void components_tool_ToolBehavior_mouseDown(components__tool__ToolBehavior r0,hxd__Event r1) {
	String r8;
	vvirtual *r7, *r9;
	venum *r18;
	bool r10;
	haxe__$Log r5;
	$Main r14;
	h2d__col__Point r11;
	components__stage__Canvas r13;
	components__managers__Simulation r25;
	double r12, r16, r19, r20, r22, r23, r24;
	vclosure *r4;
	double *r15, *r17;
	vdynamic *r6;
	int r3, r21;
	if( r1 == NULL ) hl_null_access();
	r3 = r1->button;
	switch(r3) {
		default:
		case 1:
			r5 = (haxe__$Log)g$_haxe_Log;
			r4 = r5->trace;
			if( r4 == NULL ) hl_null_access();
			r3 = r1->button;
			r6 = hl_alloc_dynamic(&t$_i32);
			r6->v.i = r3;
			r7 = hl_alloc_virtual(&t$vrt_329ffa8);
			r8 = (String)s$3b33a12;
			if( hl_vfields(r7)[1] ) *(String*)(hl_vfields(r7)[1]) = (String)r8; else hl_dyn_setp(r7->value,37969014/*fileName*/,&t$String,r8);
			r3 = 126;
			if( hl_vfields(r7)[2] ) *(int*)(hl_vfields(r7)[2]) = (int)r3; else hl_dyn_seti(r7->value,371360620/*lineNumber*/,&t$_i32,r3);
			r8 = (String)s$components_tool_ToolBehavior;
			if( hl_vfields(r7)[0] ) *(String*)(hl_vfields(r7)[0]) = (String)r8; else hl_dyn_setp(r7->value,-63073762/*className*/,&t$String,r8);
			r8 = (String)s$mouseDown;
			if( hl_vfields(r7)[3] ) *(String*)(hl_vfields(r7)[3]) = (String)r8; else hl_dyn_setp(r7->value,302979532/*methodName*/,&t$String,r8);
			r9 = hl_to_virtual(&t$vrt_eaa6a3b,(vdynamic*)r7);
			r4->hasValue ? ((void (*)(vdynamic*,vdynamic*,vvirtual*))r4->fun)((vdynamic*)r4->value,r6,r9) : ((void (*)(vdynamic*,vvirtual*))r4->fun)(r6,r9);
			goto label$80df762_1_125;
		case 0:
			r10 = true;
			r0->leftIsDown = r10;
			r11 = (h2d__col__Point)hl_alloc_obj(&t$h2d_col_Point);
			r14 = ($Main)g$_Main;
			r13 = r14->canvas;
			if( r13 == NULL ) hl_null_access();
			r12 = h2d_Scene_get_mouseX(((h2d__Scene)r13));
			r15 = &r12;
			r14 = ($Main)g$_Main;
			r13 = r14->canvas;
			if( r13 == NULL ) hl_null_access();
			r16 = h2d_Scene_get_mouseY(((h2d__Scene)r13));
			r17 = &r16;
			h2d_col_Point_new(r11,r15,r17);
			r0->mouseStart = r11;
			r18 = r0->tool;
			if( r18 == NULL ) hl_null_access();
			r3 = HL__ENUM_INDEX__(r18);
			switch(r3) {
				default:
				case 0:
					goto label$80df762_1_99;
				case 1:
				case 2:
					r19 = r0->gridSnapDistance;
					r20 = 0.;
					if( !(r20 < r19) ) goto label$80df762_1_94;
					r14 = ($Main)g$_Main;
					r13 = r14->canvas;
					if( r13 == NULL ) hl_null_access();
					r19 = h2d_Scene_get_mouseX(((h2d__Scene)r13));
					r14 = ($Main)g$_Main;
					r3 = r14->viewGridSize;
					r20 = (double)r3;
					r19 = r19 / r20;
					r3 = hl_math_round(r19);
					r14 = ($Main)g$_Main;
					r21 = r14->viewGridSize;
					r3 = r3 * r21;
					r19 = (double)r3;
					r14 = ($Main)g$_Main;
					r13 = r14->canvas;
					if( r13 == NULL ) hl_null_access();
					r20 = h2d_Scene_get_mouseY(((h2d__Scene)r13));
					r14 = ($Main)g$_Main;
					r3 = r14->viewGridSize;
					r22 = (double)r3;
					r20 = r20 / r22;
					r3 = hl_math_round(r20);
					r14 = ($Main)g$_Main;
					r21 = r14->viewGridSize;
					r3 = r3 * r21;
					r20 = (double)r3;
					r14 = ($Main)g$_Main;
					r13 = r14->canvas;
					if( r13 == NULL ) hl_null_access();
					r23 = h2d_Scene_get_mouseX(((h2d__Scene)r13));
					r22 = r19 - r23;
					r23 = 2.;
					r22 = hl_math_pow(r22,r23);
					r14 = ($Main)g$_Main;
					r13 = r14->canvas;
					if( r13 == NULL ) hl_null_access();
					r24 = h2d_Scene_get_mouseY(((h2d__Scene)r13));
					r23 = r20 - r24;
					r24 = 2.;
					r23 = hl_math_pow(r23,r24);
					r22 = r22 + r23;
					r22 = hl_math_sqrt(r22);
					r24 = r0->gridSnapDistance;
					if( !(r24 >= r22) ) goto label$80df762_1_94;
					r11 = (h2d__col__Point)hl_alloc_obj(&t$h2d_col_Point);
					r23 = r19;
					r15 = &r23;
					r24 = r20;
					r17 = &r24;
					h2d_col_Point_new(r11,r15,r17);
					r0->mouseStart = r11;
					label$80df762_1_94:
					goto label$80df762_1_99;
				case 3:
					r14 = ($Main)g$_Main;
					r13 = r14->canvas;
					if( r13 == NULL ) hl_null_access();
					components_stage_Canvas_erase(r13);
			}
			label$80df762_1_99:
			goto label$80df762_1_125;
		case 2:
			r10 = true;
			r0->middleIsDown = r10;
			r11 = (h2d__col__Point)hl_alloc_obj(&t$h2d_col_Point);
			r14 = ($Main)g$_Main;
			r13 = r14->canvas;
			if( r13 == NULL ) hl_null_access();
			r19 = h2d_Scene_get_mouseX(((h2d__Scene)r13));
			r15 = &r19;
			r14 = ($Main)g$_Main;
			r13 = r14->canvas;
			if( r13 == NULL ) hl_null_access();
			r20 = h2d_Scene_get_mouseY(((h2d__Scene)r13));
			r17 = &r20;
			h2d_col_Point_new(r11,r15,r17);
			r0->mouseStart = r11;
			goto label$80df762_1_125;
		case 3:
			r14 = ($Main)g$_Main;
			r25 = r14->simulation;
			if( r25 == NULL ) hl_null_access();
			components_managers_Simulation_backSim(r25);
			goto label$80df762_1_125;
		case 4:
			r14 = ($Main)g$_Main;
			r25 = r14->simulation;
			if( r25 == NULL ) hl_null_access();
			components_managers_Simulation_stepSim(r25);
	}
	label$80df762_1_125:
	return;
}

void components_tool_ToolBehavior_mouseWheel(components__tool__ToolBehavior r0,hxd__Event r1) {
	$Main r6;
	components__stage__Canvas r5;
	double r3, r4;
	int r7;
	if( r1 == NULL ) hl_null_access();
	r3 = r1->wheelDelta;
	r4 = 0.;
	if( !(r4 < r3) ) goto label$80df762_2_10;
	r6 = ($Main)g$_Main;
	r5 = r6->canvas;
	if( r5 == NULL ) hl_null_access();
	r7 = 1;
	components_stage_Canvas_zoomCanvas(r5,r7);
	goto label$80df762_2_18;
	label$80df762_2_10:
	r3 = r1->wheelDelta;
	r4 = 0.;
	if( !(r3 < r4) ) goto label$80df762_2_18;
	r6 = ($Main)g$_Main;
	r5 = r6->canvas;
	if( r5 == NULL ) hl_null_access();
	r7 = -1;
	components_stage_Canvas_zoomCanvas(r5,r7);
	label$80df762_2_18:
	return;
}

void components_tool_ToolBehavior_mouseMove(components__tool__ToolBehavior r0,hxd__Event r1) {
	venum *r5;
	bool r3;
	$Main r9;
	h2d__col__Point r6;
	components__stage__Canvas r8;
	double r7, r11, r13, r14, r15, r16, r17, r18, r19, r20, r22, r23, r24, r25, r26;
	double *r10, *r12;
	int r4, r21;
	r3 = r0->leftIsDown;
	if( !r3 ) goto label$80df762_3_151;
	r5 = r0->tool;
	if( r5 == NULL ) hl_null_access();
	r4 = HL__ENUM_INDEX__(r5);
	switch(r4) {
		default:
			goto label$80df762_3_151;
		case 0:
			goto label$80df762_3_151;
		case 1:
			r6 = (h2d__col__Point)hl_alloc_obj(&t$h2d_col_Point);
			r9 = ($Main)g$_Main;
			r8 = r9->canvas;
			if( r8 == NULL ) hl_null_access();
			r7 = h2d_Scene_get_mouseX(((h2d__Scene)r8));
			r10 = &r7;
			r9 = ($Main)g$_Main;
			r8 = r9->canvas;
			if( r8 == NULL ) hl_null_access();
			r11 = h2d_Scene_get_mouseY(((h2d__Scene)r8));
			r12 = &r11;
			h2d_col_Point_new(r6,r10,r12);
			r0->mouseEnd = r6;
			r6 = r0->mouseEnd;
			if( r6 == NULL ) hl_null_access();
			r13 = r6->x;
			r6 = r0->mouseStart;
			if( r6 == NULL ) hl_null_access();
			r14 = r6->x;
			r13 = r13 - r14;
			r14 = 2.;
			r13 = hl_math_pow(r13,r14);
			r6 = r0->mouseEnd;
			if( r6 == NULL ) hl_null_access();
			r14 = r6->y;
			r6 = r0->mouseStart;
			if( r6 == NULL ) hl_null_access();
			r15 = r6->y;
			r14 = r14 - r15;
			r15 = 2.;
			r14 = hl_math_pow(r14,r15);
			r13 = r13 + r14;
			r13 = hl_math_sqrt(r13);
			r14 = 10.;
			r15 = 1.;
			r9 = ($Main)g$_Main;
			r8 = r9->canvas;
			if( r8 == NULL ) hl_null_access();
			r16 = r8->scaleX;
			r15 = r15 / r16;
			r14 = r14 * r15;
			if( !(r14 < r13) ) goto label$80df762_3_77;
			components_tool_ToolBehavior_drawLine(r0);
			r6 = (h2d__col__Point)hl_alloc_obj(&t$h2d_col_Point);
			r9 = ($Main)g$_Main;
			r8 = r9->canvas;
			if( r8 == NULL ) hl_null_access();
			r13 = h2d_Scene_get_mouseX(((h2d__Scene)r8));
			r10 = &r13;
			r9 = ($Main)g$_Main;
			r8 = r9->canvas;
			if( r8 == NULL ) hl_null_access();
			r14 = h2d_Scene_get_mouseY(((h2d__Scene)r8));
			r12 = &r14;
			h2d_col_Point_new(r6,r10,r12);
			r0->mouseStart = r6;
			r6 = (h2d__col__Point)hl_alloc_obj(&t$h2d_col_Point);
			r9 = ($Main)g$_Main;
			r8 = r9->canvas;
			if( r8 == NULL ) hl_null_access();
			r15 = h2d_Scene_get_mouseX(((h2d__Scene)r8));
			r10 = &r15;
			r9 = ($Main)g$_Main;
			r8 = r9->canvas;
			if( r8 == NULL ) hl_null_access();
			r16 = h2d_Scene_get_mouseY(((h2d__Scene)r8));
			r12 = &r16;
			h2d_col_Point_new(r6,r10,r12);
			r0->mouseEnd = r6;
			label$80df762_3_77:
			goto label$80df762_3_151;
		case 2:
			r6 = (h2d__col__Point)hl_alloc_obj(&t$h2d_col_Point);
			r9 = ($Main)g$_Main;
			r8 = r9->canvas;
			if( r8 == NULL ) hl_null_access();
			r17 = h2d_Scene_get_mouseX(((h2d__Scene)r8));
			r10 = &r17;
			r9 = ($Main)g$_Main;
			r8 = r9->canvas;
			if( r8 == NULL ) hl_null_access();
			r18 = h2d_Scene_get_mouseY(((h2d__Scene)r8));
			r12 = &r18;
			h2d_col_Point_new(r6,r10,r12);
			r0->mouseEnd = r6;
			r19 = r0->gridSnapDistance;
			r20 = 0.;
			if( !(r20 < r19) ) goto label$80df762_3_145;
			r9 = ($Main)g$_Main;
			r8 = r9->canvas;
			if( r8 == NULL ) hl_null_access();
			r19 = h2d_Scene_get_mouseX(((h2d__Scene)r8));
			r9 = ($Main)g$_Main;
			r4 = r9->viewGridSize;
			r20 = (double)r4;
			r19 = r19 / r20;
			r4 = hl_math_round(r19);
			r9 = ($Main)g$_Main;
			r21 = r9->viewGridSize;
			r4 = r4 * r21;
			r19 = (double)r4;
			r9 = ($Main)g$_Main;
			r8 = r9->canvas;
			if( r8 == NULL ) hl_null_access();
			r20 = h2d_Scene_get_mouseY(((h2d__Scene)r8));
			r9 = ($Main)g$_Main;
			r4 = r9->viewGridSize;
			r22 = (double)r4;
			r20 = r20 / r22;
			r4 = hl_math_round(r20);
			r9 = ($Main)g$_Main;
			r21 = r9->viewGridSize;
			r4 = r4 * r21;
			r20 = (double)r4;
			r9 = ($Main)g$_Main;
			r8 = r9->canvas;
			if( r8 == NULL ) hl_null_access();
			r23 = h2d_Scene_get_mouseX(((h2d__Scene)r8));
			r22 = r19 - r23;
			r23 = 2.;
			r22 = hl_math_pow(r22,r23);
			r9 = ($Main)g$_Main;
			r8 = r9->canvas;
			if( r8 == NULL ) hl_null_access();
			r24 = h2d_Scene_get_mouseY(((h2d__Scene)r8));
			r23 = r20 - r24;
			r24 = 2.;
			r23 = hl_math_pow(r23,r24);
			r22 = r22 + r23;
			r22 = hl_math_sqrt(r22);
			r24 = r0->gridSnapDistance;
			if( !(r24 >= r22) ) goto label$80df762_3_145;
			r6 = (h2d__col__Point)hl_alloc_obj(&t$h2d_col_Point);
			r23 = r19;
			r10 = &r23;
			r24 = r20;
			r12 = &r24;
			h2d_col_Point_new(r6,r10,r12);
			r0->mouseEnd = r6;
			label$80df762_3_145:
			components_tool_ToolBehavior_updatePreview(r0);
			goto label$80df762_3_151;
		case 3:
			r9 = ($Main)g$_Main;
			r8 = r9->canvas;
			if( r8 == NULL ) hl_null_access();
			components_stage_Canvas_erase(r8);
	}
	label$80df762_3_151:
	r3 = r0->middleIsDown;
	if( !r3 ) goto label$80df762_3_186;
	r6 = (h2d__col__Point)hl_alloc_obj(&t$h2d_col_Point);
	r9 = ($Main)g$_Main;
	r8 = r9->canvas;
	if( r8 == NULL ) hl_null_access();
	r19 = h2d_Scene_get_mouseX(((h2d__Scene)r8));
	r10 = &r19;
	r9 = ($Main)g$_Main;
	r8 = r9->canvas;
	if( r8 == NULL ) hl_null_access();
	r20 = h2d_Scene_get_mouseY(((h2d__Scene)r8));
	r12 = &r20;
	h2d_col_Point_new(r6,r10,r12);
	r0->mouseEnd = r6;
	r6 = r0->mouseStart;
	if( r6 == NULL ) hl_null_access();
	r22 = r6->x;
	r6 = r0->mouseEnd;
	if( r6 == NULL ) hl_null_access();
	r25 = r6->x;
	r22 = r22 - r25;
	r22 = -r22;
	r6 = r0->mouseStart;
	if( r6 == NULL ) hl_null_access();
	r25 = r6->y;
	r6 = r0->mouseEnd;
	if( r6 == NULL ) hl_null_access();
	r26 = r6->y;
	r25 = r25 - r26;
	r25 = -r25;
	r9 = ($Main)g$_Main;
	r8 = r9->canvas;
	if( r8 == NULL ) hl_null_access();
	components_stage_Canvas_addCanvasPosition(r8,r22,r25);
	label$80df762_3_186:
	return;
}

void components_tool_ToolBehavior_updatePreview(components__tool__ToolBehavior r0) {
	return;
}

void components_tool_ToolBehavior_mouseUp(components__tool__ToolBehavior r0,hxd__Event r1) {
	components__managers__Grid r20;
	h2d__Graphics r22;
	venum *r5;
	bool r4;
	h2d__Object r21;
	$Main r9;
	components__lines__LineBase r19;
	h2d__col__Point r6;
	components__stage__Canvas r8;
	double r7, r11, r13, r14, r15, r17, r18;
	double *r10, *r12;
	int r3, r16;
	if( r1 == NULL ) hl_null_access();
	r3 = r1->button;
	switch(r3) {
		default:
		case 1:
			goto label$80df762_5_140;
		case 0:
			r4 = false;
			r0->leftIsDown = r4;
			r5 = r0->tool;
			if( r5 == NULL ) hl_null_access();
			r3 = HL__ENUM_INDEX__(r5);
			switch(r3) {
				default:
					goto label$80df762_5_137;
				case 0:
					goto label$80df762_5_137;
				case 1:
					goto label$80df762_5_137;
				case 2:
					r6 = (h2d__col__Point)hl_alloc_obj(&t$h2d_col_Point);
					r9 = ($Main)g$_Main;
					r8 = r9->canvas;
					if( r8 == NULL ) hl_null_access();
					r7 = h2d_Scene_get_mouseX(((h2d__Scene)r8));
					r10 = &r7;
					r9 = ($Main)g$_Main;
					r8 = r9->canvas;
					if( r8 == NULL ) hl_null_access();
					r11 = h2d_Scene_get_mouseY(((h2d__Scene)r8));
					r12 = &r11;
					h2d_col_Point_new(r6,r10,r12);
					r0->mouseEnd = r6;
					r6 = r0->mouseEnd;
					if( r6 == NULL ) hl_null_access();
					r13 = r6->x;
					r6 = r0->mouseStart;
					if( r6 == NULL ) hl_null_access();
					r14 = r6->x;
					r13 = r13 - r14;
					r14 = 2.;
					r13 = hl_math_pow(r13,r14);
					r6 = r0->mouseEnd;
					if( r6 == NULL ) hl_null_access();
					r14 = r6->y;
					r6 = r0->mouseStart;
					if( r6 == NULL ) hl_null_access();
					r15 = r6->y;
					r14 = r14 - r15;
					r15 = 2.;
					r14 = hl_math_pow(r14,r15);
					r13 = r13 + r14;
					r13 = hl_math_sqrt(r13);
					r14 = 10.;
					if( !(r13 < r14) ) goto label$80df762_5_108;
					r13 = r0->gridSnapDistance;
					r14 = 0.;
					if( !(r14 < r13) ) goto label$80df762_5_107;
					r9 = ($Main)g$_Main;
					r8 = r9->canvas;
					if( r8 == NULL ) hl_null_access();
					r13 = h2d_Scene_get_mouseX(((h2d__Scene)r8));
					r9 = ($Main)g$_Main;
					r3 = r9->viewGridSize;
					r14 = (double)r3;
					r13 = r13 / r14;
					r3 = hl_math_round(r13);
					r9 = ($Main)g$_Main;
					r16 = r9->viewGridSize;
					r3 = r3 * r16;
					r13 = (double)r3;
					r9 = ($Main)g$_Main;
					r8 = r9->canvas;
					if( r8 == NULL ) hl_null_access();
					r14 = h2d_Scene_get_mouseY(((h2d__Scene)r8));
					r9 = ($Main)g$_Main;
					r3 = r9->viewGridSize;
					r15 = (double)r3;
					r14 = r14 / r15;
					r3 = hl_math_round(r14);
					r9 = ($Main)g$_Main;
					r16 = r9->viewGridSize;
					r3 = r3 * r16;
					r14 = (double)r3;
					r9 = ($Main)g$_Main;
					r8 = r9->canvas;
					if( r8 == NULL ) hl_null_access();
					r17 = h2d_Scene_get_mouseX(((h2d__Scene)r8));
					r15 = r13 - r17;
					r17 = 2.;
					r15 = hl_math_pow(r15,r17);
					r9 = ($Main)g$_Main;
					r8 = r9->canvas;
					if( r8 == NULL ) hl_null_access();
					r18 = h2d_Scene_get_mouseY(((h2d__Scene)r8));
					r17 = r14 - r18;
					r18 = 2.;
					r17 = hl_math_pow(r17,r18);
					r15 = r15 + r17;
					r15 = hl_math_sqrt(r15);
					r18 = r0->gridSnapDistance;
					if( !(r18 >= r15) ) goto label$80df762_5_105;
					r18 = 0.;
					if( r15 == r18 ) goto label$80df762_5_105;
					r6 = (h2d__col__Point)hl_alloc_obj(&t$h2d_col_Point);
					r17 = r13;
					r10 = &r17;
					r18 = r14;
					r12 = &r18;
					h2d_col_Point_new(r6,r10,r12);
					r0->mouseEnd = r6;
					goto label$80df762_5_106;
					label$80df762_5_105:
					return;
					label$80df762_5_106:
					goto label$80df762_5_108;
					label$80df762_5_107:
					return;
					label$80df762_5_108:
					components_tool_ToolBehavior_drawLine(r0);
					r19 = r0->previewLine;
					if( !r19 ) goto label$80df762_5_136;
					r9 = ($Main)g$_Main;
					r20 = r9->grid;
					if( r20 == NULL ) hl_null_access();
					r19 = r0->previewLine;
					components_managers_Grid_unregister(r20,r19);
					r9 = ($Main)g$_Main;
					r8 = r9->canvas;
					if( r8 == NULL ) hl_null_access();
					r21 = r8->preview;
					if( r21 == NULL ) hl_null_access();
					r19 = r0->previewLine;
					if( r19 == NULL ) hl_null_access();
					r22 = r19->rideLayer;
					((void (*)(h2d__Object,h2d__Graphics))r21->$type->vobj_proto[6])(r21,r22);
					r9 = ($Main)g$_Main;
					r8 = r9->canvas;
					if( r8 == NULL ) hl_null_access();
					r21 = r8->preview;
					if( r21 == NULL ) hl_null_access();
					r19 = r0->previewLine;
					if( r19 == NULL ) hl_null_access();
					r22 = r19->colorLayer;
					((void (*)(h2d__Object,h2d__Graphics))r21->$type->vobj_proto[6])(r21,r22);
					r19 = NULL;
					r0->previewLine = r19;
					label$80df762_5_136:
					goto label$80df762_5_137;
				case 3:
					break;
			}
			label$80df762_5_137:
			goto label$80df762_5_140;
		case 2:
			r4 = false;
			r0->middleIsDown = r4;
	}
	label$80df762_5_140:
	return;
}

void components_tool_ToolBehavior_drawLine(components__tool__ToolBehavior r0) {
	bool r10;
	$Main r3;
	h2d__col__Point r6;
	components__stage__Canvas r2;
	double r5, r7, r8, r9;
	vdynamic *r11, *r12;
	int r4;
	r3 = ($Main)g$_Main;
	r2 = r3->canvas;
	if( r2 == NULL ) hl_null_access();
	r4 = r0->color;
	r6 = r0->mouseStart;
	if( r6 == NULL ) hl_null_access();
	r5 = r6->x;
	r6 = r0->mouseStart;
	if( r6 == NULL ) hl_null_access();
	r7 = r6->y;
	r6 = r0->mouseEnd;
	if( r6 == NULL ) hl_null_access();
	r8 = r6->x;
	r6 = r0->mouseEnd;
	if( r6 == NULL ) hl_null_access();
	r9 = r6->y;
	r10 = r0->shifted;
	r11 = hl_alloc_dynbool(r10);
	r12 = NULL;
	components_stage_Canvas_addLine(r2,r4,r5,r7,r8,r9,r11,r12);
	return;
}

void components_tool_ToolBehavior_keyInputDown(components__tool__ToolBehavior r0,hxd__Event r1) {
	String r13, r21;
	venum *r4, *r6, *r15;
	bool r10;
	components__managers__Musicplayer r11;
	$Main r8;
	components__stage__Canvas r7;
	double r17, r18;
	components__managers__Simulation r9;
	int *r19;
	vdynamic *r14;
	vbyte *r20;
	components__stage__LRConsole r12;
	int r3, r5, r16;
	if( r1 == NULL ) hl_null_access();
	r4 = r1->kind;
	if( r4 == NULL ) hl_null_access();
	r3 = HL__ENUM_INDEX__(r4);
	switch(r3) {
		default:
		case 0:
		case 1:
		case 2:
		case 3:
		case 4:
		case 5:
		case 6:
		case 7:
			goto label$80df762_7_330;
		case 8:
			r3 = r1->keyCode;
			r5 = 9;
			if( r5 == r3 ) goto label$80df762_7_42;
			r5 = 17;
			if( r5 == r3 ) goto label$80df762_7_86;
			r5 = 32;
			if( r5 == r3 ) goto label$80df762_7_96;
			r5 = 49;
			if( r5 == r3 ) goto label$80df762_7_116;
			r5 = 50;
			if( r5 == r3 ) goto label$80df762_7_127;
			r5 = 51;
			if( r5 == r3 ) goto label$80df762_7_138;
			r5 = 65;
			if( r5 == r3 ) goto label$80df762_7_149;
			r5 = 68;
			if( r5 == r3 ) goto label$80df762_7_154;
			r5 = 69;
			if( r5 == r3 ) goto label$80df762_7_159;
			r5 = 81;
			if( r5 == r3 ) goto label$80df762_7_170;
			r5 = 83;
			if( r5 == r3 ) goto label$80df762_7_181;
			r5 = 87;
			if( r5 == r3 ) goto label$80df762_7_186;
			r5 = 88;
			if( r5 == r3 ) goto label$80df762_7_197;
			r5 = 219;
			if( r5 == r3 ) goto label$80df762_7_202;
			r5 = 221;
			if( r5 == r3 ) goto label$80df762_7_253;
			r5 = 272;
			if( r5 == r3 ) goto label$80df762_7_300;
			r5 = 528;
			if( r5 == r3 ) goto label$80df762_7_303;
			goto label$80df762_7_307;
			label$80df762_7_42:
			r8 = ($Main)g$_Main;
			r7 = r8->canvas;
			if( r7 == NULL ) hl_null_access();
			r6 = components_stage_Canvas_get_drawMode(r7);
			if( r6 == NULL ) hl_null_access();
			r3 = HL__ENUM_INDEX__(r6);
			switch(r3) {
				default:
					goto label$80df762_7_85;
				case 0:
					r8 = ($Main)g$_Main;
					r7 = r8->canvas;
					if( r7 == NULL ) hl_null_access();
					r6 = (venum*)g$994fdec;
					r6 = components_stage_Canvas_set_drawMode(r7,r6);
					goto label$80df762_7_85;
				case 1:
					r8 = ($Main)g$_Main;
					r7 = r8->canvas;
					if( r7 == NULL ) hl_null_access();
					r6 = (venum*)g$92fe76c;
					r6 = components_stage_Canvas_set_drawMode(r7,r6);
					goto label$80df762_7_85;
				case 2:
					r8 = ($Main)g$_Main;
					r7 = r8->canvas;
					if( r7 == NULL ) hl_null_access();
					r6 = (venum*)g$ab5747c;
					r6 = components_stage_Canvas_set_drawMode(r7,r6);
					goto label$80df762_7_85;
				case 3:
					r8 = ($Main)g$_Main;
					r7 = r8->canvas;
					if( r7 == NULL ) hl_null_access();
					r6 = (venum*)g$ba7542c;
					r6 = components_stage_Canvas_set_drawMode(r7,r6);
					goto label$80df762_7_85;
				case 4:
					r8 = ($Main)g$_Main;
					r7 = r8->canvas;
					if( r7 == NULL ) hl_null_access();
					r6 = (venum*)g$2a65ad1;
					r6 = components_stage_Canvas_set_drawMode(r7,r6);
					goto label$80df762_7_85;
				case 5:
					r8 = ($Main)g$_Main;
					r7 = r8->canvas;
					if( r7 == NULL ) hl_null_access();
					r6 = (venum*)g$6537d82;
					r6 = components_stage_Canvas_set_drawMode(r7,r6);
			}
			label$80df762_7_85:
			goto label$80df762_7_307;
			label$80df762_7_86:
			r8 = ($Main)g$_Main;
			r9 = r8->simulation;
			if( r9 == NULL ) hl_null_access();
			r10 = true;
			r9->rewinding = r10;
			r8 = ($Main)g$_Main;
			r11 = r8->audio;
			if( r11 == NULL ) hl_null_access();
			components_managers_Musicplayer_stopMusic(r11);
			goto label$80df762_7_307;
			label$80df762_7_96:
			r8 = ($Main)g$_Main;
			r9 = r8->simulation;
			if( r9 == NULL ) hl_null_access();
			r10 = r9->paused;
			if( r10 ) goto label$80df762_7_106;
			r8 = ($Main)g$_Main;
			r9 = r8->simulation;
			if( r9 == NULL ) hl_null_access();
			components_managers_Simulation_pauseSim(r9);
			goto label$80df762_7_115;
			label$80df762_7_106:
			r8 = ($Main)g$_Main;
			r9 = r8->simulation;
			if( r9 == NULL ) hl_null_access();
			r10 = r9->paused;
			if( !r10 ) goto label$80df762_7_115;
			r8 = ($Main)g$_Main;
			r9 = r8->simulation;
			if( r9 == NULL ) hl_null_access();
			components_managers_Simulation_resumeSim(r9);
			label$80df762_7_115:
			goto label$80df762_7_307;
			label$80df762_7_116:
			r3 = 0;
			r0->color = r3;
			components_tool_ToolBehavior_updateCursor(r0);
			r8 = ($Main)g$_Main;
			r12 = r8->console;
			if( r12 == NULL ) hl_null_access();
			r13 = (String)s$Line_type_set_to_Normal;
			r3 = 26367;
			r14 = hl_alloc_dynamic(&t$_i32);
			r14->v.i = r3;
			h2d_Console_log(((h2d__Console)r12),r13,r14);
			goto label$80df762_7_307;
			label$80df762_7_127:
			r3 = 1;
			r0->color = r3;
			components_tool_ToolBehavior_updateCursor(r0);
			r8 = ($Main)g$_Main;
			r12 = r8->console;
			if( r12 == NULL ) hl_null_access();
			r13 = (String)s$Line_type_set_to_Accel;
			r3 = 13369344;
			r14 = hl_alloc_dynamic(&t$_i32);
			r14->v.i = r3;
			h2d_Console_log(((h2d__Console)r12),r13,r14);
			goto label$80df762_7_307;
			label$80df762_7_138:
			r3 = 2;
			r0->color = r3;
			components_tool_ToolBehavior_updateCursor(r0);
			r8 = ($Main)g$_Main;
			r12 = r8->console;
			if( r12 == NULL ) hl_null_access();
			r13 = (String)s$Line_type_set_to_Scenery;
			r3 = 52224;
			r14 = hl_alloc_dynamic(&t$_i32);
			r14->v.i = r3;
			h2d_Console_log(((h2d__Console)r12),r13,r14);
			goto label$80df762_7_307;
			label$80df762_7_149:
			r8 = ($Main)g$_Main;
			r9 = r8->simulation;
			if( r9 == NULL ) hl_null_access();
			components_managers_Simulation_backSim(r9);
			goto label$80df762_7_307;
			label$80df762_7_154:
			r8 = ($Main)g$_Main;
			r9 = r8->simulation;
			if( r9 == NULL ) hl_null_access();
			components_managers_Simulation_stepSim(r9);
			goto label$80df762_7_307;
			label$80df762_7_159:
			r15 = (venum*)g$components_tool_ToolMode_ERASER;
			r0->tool = r15;
			components_tool_ToolBehavior_updateCursor(r0);
			r8 = ($Main)g$_Main;
			r12 = r8->console;
			if( r12 == NULL ) hl_null_access();
			r13 = (String)s$Tool_set_to_Eraser;
			r3 = 187;
			r14 = hl_alloc_dynamic(&t$_i32);
			r14->v.i = r3;
			h2d_Console_log(((h2d__Console)r12),r13,r14);
			goto label$80df762_7_307;
			label$80df762_7_170:
			r15 = (venum*)g$components_tool_ToolMode_PENCIL;
			r0->tool = r15;
			components_tool_ToolBehavior_updateCursor(r0);
			r8 = ($Main)g$_Main;
			r12 = r8->console;
			if( r12 == NULL ) hl_null_access();
			r13 = (String)s$Tool_set_to_Pencil;
			r3 = 187;
			r14 = hl_alloc_dynamic(&t$_i32);
			r14->v.i = r3;
			h2d_Console_log(((h2d__Console)r12),r13,r14);
			goto label$80df762_7_307;
			label$80df762_7_181:
			r8 = ($Main)g$_Main;
			r9 = r8->simulation;
			if( r9 == NULL ) hl_null_access();
			components_managers_Simulation_startSim(r9);
			goto label$80df762_7_307;
			label$80df762_7_186:
			r15 = (venum*)g$components_tool_ToolMode_LINE;
			r0->tool = r15;
			components_tool_ToolBehavior_updateCursor(r0);
			r8 = ($Main)g$_Main;
			r12 = r8->console;
			if( r12 == NULL ) hl_null_access();
			r13 = (String)s$Tool_set_to_Line;
			r3 = 187;
			r14 = hl_alloc_dynamic(&t$_i32);
			r14->v.i = r3;
			h2d_Console_log(((h2d__Console)r12),r13,r14);
			goto label$80df762_7_307;
			label$80df762_7_197:
			r8 = ($Main)g$_Main;
			r9 = r8->simulation;
			if( r9 == NULL ) hl_null_access();
			components_managers_Simulation_endSim(r9);
			goto label$80df762_7_307;
			label$80df762_7_202:
			r8 = ($Main)g$_Main;
			r3 = r8->viewGridSize;
			r5 = 1;
			if( r3 != r5 ) goto label$80df762_7_207;
			return;
			label$80df762_7_207:
			r10 = r0->shifted;
			if( !r10 ) goto label$80df762_7_226;
			r3 = 2;
			label$80df762_7_210:
			r10 = true;
			if( !r10 ) goto label$80df762_7_225;
			r8 = ($Main)g$_Main;
			r16 = r8->viewGridSize;
			if( r3 < r16 ) goto label$80df762_7_221;
			r16 = 1;
			r5 = r3 >> r16;
			r8 = ($Main)g$_Main;
			r8->viewGridSize = r5;
			goto label$80df762_7_225;
			label$80df762_7_221:
			r16 = 1;
			r5 = r3 << r16;
			r3 = r5;
			goto label$80df762_7_210;
			label$80df762_7_225:
			goto label$80df762_7_239;
			label$80df762_7_226:
			r8 = ($Main)g$_Main;
			r3 = r8->viewGridSize;
			r5 = 1;
			r3 = r3 - r5;
			r8->viewGridSize = r3;
			r8 = ($Main)g$_Main;
			r3 = r8->viewGridSize;
			r17 = (double)r3;
			r18 = 1.;
			r17 = Math_max(r17,r18);
			r3 = (int)r17;
			r8 = ($Main)g$_Main;
			r8->viewGridSize = r3;
			label$80df762_7_239:
			r8 = ($Main)g$_Main;
			r12 = r8->console;
			if( r12 == NULL ) hl_null_access();
			r13 = (String)s$Ruler_width_set_to_;
			r8 = ($Main)g$_Main;
			r3 = r8->viewGridSize;
			r19 = &r3;
			r20 = hl_itos(r3,r19);
			r21 = String___alloc__(r20,r3);
			r13 = String___add__(r13,r21);
			r3 = 26367;
			r14 = hl_alloc_dynamic(&t$_i32);
			r14->v.i = r3;
			h2d_Console_log(((h2d__Console)r12),r13,r14);
			goto label$80df762_7_307;
			label$80df762_7_253:
			r10 = r0->shifted;
			if( !r10 ) goto label$80df762_7_281;
			r3 = 2;
			label$80df762_7_256:
			r10 = true;
			if( !r10 ) goto label$80df762_7_280;
			r8 = ($Main)g$_Main;
			r16 = r8->viewGridSize;
			if( r16 < r3 ) goto label$80df762_7_276;
			r16 = 1;
			r5 = r3 << r16;
			r3 = r5;
			r16 = 0;
			if( r5 != r16 ) goto label$80df762_7_275;
			r8 = ($Main)g$_Main;
			r12 = r8->console;
			if( r12 == NULL ) hl_null_access();
			r13 = (String)s$Max_left_bitshift_reached;
			r5 = 16711680;
			r14 = hl_alloc_dynamic(&t$_i32);
			r14->v.i = r5;
			h2d_Console_log(((h2d__Console)r12),r13,r14);
			goto label$80df762_7_280;
			label$80df762_7_275:
			goto label$80df762_7_279;
			label$80df762_7_276:
			r8 = ($Main)g$_Main;
			r8->viewGridSize = r3;
			goto label$80df762_7_280;
			label$80df762_7_279:
			goto label$80df762_7_256;
			label$80df762_7_280:
			goto label$80df762_7_286;
			label$80df762_7_281:
			r8 = ($Main)g$_Main;
			r3 = r8->viewGridSize;
			r5 = 1;
			r3 = r3 + r5;
			r8->viewGridSize = r3;
			label$80df762_7_286:
			r8 = ($Main)g$_Main;
			r12 = r8->console;
			if( r12 == NULL ) hl_null_access();
			r13 = (String)s$Ruler_width_set_to_;
			r8 = ($Main)g$_Main;
			r3 = r8->viewGridSize;
			r19 = &r3;
			r20 = hl_itos(r3,r19);
			r21 = String___alloc__(r20,r3);
			r13 = String___add__(r13,r21);
			r3 = 26367;
			r14 = hl_alloc_dynamic(&t$_i32);
			r14->v.i = r3;
			h2d_Console_log(((h2d__Console)r12),r13,r14);
			goto label$80df762_7_307;
			label$80df762_7_300:
			r10 = true;
			r0->shifted = r10;
			goto label$80df762_7_307;
			label$80df762_7_303:
			r8 = ($Main)g$_Main;
			r9 = r8->simulation;
			if( r9 == NULL ) hl_null_access();
			components_managers_Simulation_updateSim(r9);
			label$80df762_7_307:
			goto label$80df762_7_330;
		case 9:
			r3 = r1->keyCode;
			r5 = 17;
			if( r5 == r3 ) goto label$80df762_7_314;
			r5 = 272;
			if( r5 == r3 ) goto label$80df762_7_328;
			goto label$80df762_7_330;
			label$80df762_7_314:
			r8 = ($Main)g$_Main;
			r9 = r8->simulation;
			if( r9 == NULL ) hl_null_access();
			r10 = false;
			r9->rewinding = r10;
			r8 = ($Main)g$_Main;
			r11 = r8->audio;
			if( r11 == NULL ) hl_null_access();
			r8 = ($Main)g$_Main;
			r9 = r8->simulation;
			if( r9 == NULL ) hl_null_access();
			r3 = r9->frames;
			components_managers_Musicplayer_playMusic(r11,r3);
			goto label$80df762_7_330;
			label$80df762_7_328:
			r10 = false;
			r0->shifted = r10;
	}
	label$80df762_7_330:
	return;
}

void components_tool_ToolBehavior_updateCursor(components__tool__ToolBehavior r0) {
	venum *r3, *r4;
	$Main r6;
	h2d__Interactive r5;
	int r2;
	r3 = r0->tool;
	if( r3 == NULL ) hl_null_access();
	r2 = HL__ENUM_INDEX__(r3);
	switch(r2) {
		default:
		case 0:
			r6 = ($Main)g$_Main;
			r5 = r6->canvas_interaction;
			if( r5 == NULL ) hl_null_access();
			r4 = (venum*)g$hxd_Cursor_Default;
			r4 = h2d_Interactive_set_cursor(r5,r4);
			goto label$80df762_8_13;
		case 1:
			components_tool_ToolBehavior_updatePencilCursor(r0);
			goto label$80df762_8_13;
		case 2:
			components_tool_ToolBehavior_updateLineCursor(r0);
	}
	label$80df762_8_13:
	return;
}

void components_tool_ToolBehavior_updateLineCursor(components__tool__ToolBehavior r0) {
	venum *r3;
	$Main r5;
	h2d__Interactive r4;
	int r2;
	r2 = r0->color;
	switch(r2) {
		default:
			r5 = ($Main)g$_Main;
			r4 = r5->canvas_interaction;
			if( r4 == NULL ) hl_null_access();
			r3 = (venum*)g$hxd_Cursor_Default;
			r3 = h2d_Interactive_set_cursor(r4,r3);
			goto label$80df762_9_25;
		case 0:
			r5 = ($Main)g$_Main;
			r4 = r5->canvas_interaction;
			if( r4 == NULL ) hl_null_access();
			r3 = r0->cursorLineBlue;
			r3 = h2d_Interactive_set_cursor(r4,r3);
			goto label$80df762_9_25;
		case 1:
			r5 = ($Main)g$_Main;
			r4 = r5->canvas_interaction;
			if( r4 == NULL ) hl_null_access();
			r3 = r0->cursorLineRed;
			r3 = h2d_Interactive_set_cursor(r4,r3);
			goto label$80df762_9_25;
		case 2:
			r5 = ($Main)g$_Main;
			r4 = r5->canvas_interaction;
			if( r4 == NULL ) hl_null_access();
			r3 = r0->cursorLineGreen;
			r3 = h2d_Interactive_set_cursor(r4,r3);
	}
	label$80df762_9_25:
	return;
}

void components_tool_ToolBehavior_updatePencilCursor(components__tool__ToolBehavior r0) {
	venum *r3;
	$Main r5;
	h2d__Interactive r4;
	int r2;
	r2 = r0->color;
	switch(r2) {
		default:
			r5 = ($Main)g$_Main;
			r4 = r5->canvas_interaction;
			if( r4 == NULL ) hl_null_access();
			r3 = (venum*)g$hxd_Cursor_Default;
			r3 = h2d_Interactive_set_cursor(r4,r3);
			goto label$80df762_10_25;
		case 0:
			r5 = ($Main)g$_Main;
			r4 = r5->canvas_interaction;
			if( r4 == NULL ) hl_null_access();
			r3 = r0->cursorPencilBlue;
			r3 = h2d_Interactive_set_cursor(r4,r3);
			goto label$80df762_10_25;
		case 1:
			r5 = ($Main)g$_Main;
			r4 = r5->canvas_interaction;
			if( r4 == NULL ) hl_null_access();
			r3 = r0->cursorPencilRed;
			r3 = h2d_Interactive_set_cursor(r4,r3);
			goto label$80df762_10_25;
		case 2:
			r5 = ($Main)g$_Main;
			r4 = r5->canvas_interaction;
			if( r4 == NULL ) hl_null_access();
			r3 = r0->cursorPencilGreen;
			r3 = h2d_Interactive_set_cursor(r4,r3);
	}
	label$80df762_10_25:
	return;
}

void components_tool_ToolBehavior_new(components__tool__ToolBehavior r0) {
	String r13;
	hl__types__ArrayObj r18;
	hl_type *r20;
	hxd__CustomCursor r17;
	hxd__res__Resource r11;
	venum *r3, *r16;
	bool r1;
	hxd__BitmapData r10;
	$Main r6;
	hxd__res__Loader r8, r12, r22, r23, r24, r25;
	hxd__res__$Image r14;
	vclosure *r7;
	double r2;
	hxd__res__Image r15;
	h2d__Interactive r5;
	varray *r19;
	int r4, r21;
	r1 = false;
	r0->shifted = r1;
	r1 = false;
	r0->middleIsDown = r1;
	r1 = false;
	r0->leftIsDown = r1;
	r2 = 0.;
	r0->gridSnapDistance = r2;
	r3 = (venum*)g$components_tool_ToolMode_PENCIL;
	r0->tool = r3;
	r4 = 0;
	r0->color = r4;
	r6 = ($Main)g$_Main;
	r5 = r6->canvas_interaction;
	if( r5 == NULL ) hl_null_access();
	r1 = true;
	r5->enableRightButton = r1;
	r6 = ($Main)g$_Main;
	r5 = r6->canvas_interaction;
	if( r5 == NULL ) hl_null_access();
	r7 = hl_alloc_closure_ptr(&t$fun_112ee0a,components_tool_ToolBehavior_keyInputDown,r0);
	r5->onKeyDown = r7;
	r6 = ($Main)g$_Main;
	r5 = r6->canvas_interaction;
	if( r5 == NULL ) hl_null_access();
	r7 = hl_alloc_closure_ptr(&t$fun_112ee0a,components_tool_ToolBehavior_keyInputDown,r0);
	r5->onKeyUp = r7;
	r6 = ($Main)g$_Main;
	r5 = r6->canvas_interaction;
	if( r5 == NULL ) hl_null_access();
	r7 = hl_alloc_closure_ptr(&t$fun_112ee0a,components_tool_ToolBehavior_mouseDown,r0);
	r5->onPush = r7;
	r6 = ($Main)g$_Main;
	r5 = r6->canvas_interaction;
	if( r5 == NULL ) hl_null_access();
	r7 = hl_alloc_closure_ptr(&t$fun_112ee0a,components_tool_ToolBehavior_mouseUp,r0);
	r5->onRelease = r7;
	r6 = ($Main)g$_Main;
	r5 = r6->canvas_interaction;
	if( r5 == NULL ) hl_null_access();
	r7 = hl_alloc_closure_ptr(&t$fun_112ee0a,components_tool_ToolBehavior_mouseMove,r0);
	r5->onMove = r7;
	r6 = ($Main)g$_Main;
	r5 = r6->canvas_interaction;
	if( r5 == NULL ) hl_null_access();
	r7 = hl_alloc_closure_ptr(&t$fun_112ee0a,components_tool_ToolBehavior_mouseWheel,r0);
	r5->onWheel = r7;
	r8 = hxd_Res_get_loader();
	if( r8 == NULL ) hl_null_access();
	r13 = (String)s$tool_pencilBlue_png;
	r14 = (hxd__res__$Image)g$_hxd_res_Image;
	r11 = hxd_res_Loader_loadCache(r8,r13,((hl__Class)r14));
	r15 = (hxd__res__Image)r11;
	if( r15 == NULL ) hl_null_access();
	r10 = hxd_res_Image_toBitmap(r15);
	r0->bitmapPencilBlue = r10;
	r17 = (hxd__CustomCursor)hl_alloc_obj(&t$hxd_CustomCursor);
	r20 = &t$hxd_BitmapData;
	r4 = 1;
	r19 = hl_alloc_array(r20,r4);
	r10 = r0->bitmapPencilBlue;
	r4 = 0;
	((hxd__BitmapData*)(r19 + 1))[r4] = r10;
	r18 = hl_types_ArrayObj_alloc(r19);
	r2 = 0.;
	r4 = 1;
	r21 = 25;
	hxd_CustomCursor_new(r17,r18,r2,r4,r21);
	r16 = hl_alloc_enum(&t$hxd_Cursor,5);
	((hxd_Cursor_Custom*)r16)->p0 = r17;
	r0->cursorPencilBlue = r16;
	r12 = hxd_Res_get_loader();
	if( r12 == NULL ) hl_null_access();
	r13 = (String)s$tool_pencilRed_png;
	r14 = (hxd__res__$Image)g$_hxd_res_Image;
	r11 = hxd_res_Loader_loadCache(r12,r13,((hl__Class)r14));
	r15 = (hxd__res__Image)r11;
	if( r15 == NULL ) hl_null_access();
	r10 = hxd_res_Image_toBitmap(r15);
	r0->bitmapPencilRed = r10;
	r17 = (hxd__CustomCursor)hl_alloc_obj(&t$hxd_CustomCursor);
	r20 = &t$hxd_BitmapData;
	r4 = 1;
	r19 = hl_alloc_array(r20,r4);
	r10 = r0->bitmapPencilRed;
	r4 = 0;
	((hxd__BitmapData*)(r19 + 1))[r4] = r10;
	r18 = hl_types_ArrayObj_alloc(r19);
	r2 = 0.;
	r4 = 1;
	r21 = 25;
	hxd_CustomCursor_new(r17,r18,r2,r4,r21);
	r16 = hl_alloc_enum(&t$hxd_Cursor,5);
	((hxd_Cursor_Custom*)r16)->p0 = r17;
	r0->cursorPencilRed = r16;
	r22 = hxd_Res_get_loader();
	if( r22 == NULL ) hl_null_access();
	r13 = (String)s$tool_pencilGreen_png;
	r14 = (hxd__res__$Image)g$_hxd_res_Image;
	r11 = hxd_res_Loader_loadCache(r22,r13,((hl__Class)r14));
	r15 = (hxd__res__Image)r11;
	if( r15 == NULL ) hl_null_access();
	r10 = hxd_res_Image_toBitmap(r15);
	r0->bitmapPencilGreen = r10;
	r17 = (hxd__CustomCursor)hl_alloc_obj(&t$hxd_CustomCursor);
	r20 = &t$hxd_BitmapData;
	r4 = 1;
	r19 = hl_alloc_array(r20,r4);
	r10 = r0->bitmapPencilGreen;
	r4 = 0;
	((hxd__BitmapData*)(r19 + 1))[r4] = r10;
	r18 = hl_types_ArrayObj_alloc(r19);
	r2 = 0.;
	r4 = 1;
	r21 = 25;
	hxd_CustomCursor_new(r17,r18,r2,r4,r21);
	r16 = hl_alloc_enum(&t$hxd_Cursor,5);
	((hxd_Cursor_Custom*)r16)->p0 = r17;
	r0->cursorPencilGreen = r16;
	r23 = hxd_Res_get_loader();
	if( r23 == NULL ) hl_null_access();
	r13 = (String)s$tool_lineBlue_png;
	r14 = (hxd__res__$Image)g$_hxd_res_Image;
	r11 = hxd_res_Loader_loadCache(r23,r13,((hl__Class)r14));
	r15 = (hxd__res__Image)r11;
	if( r15 == NULL ) hl_null_access();
	r10 = hxd_res_Image_toBitmap(r15);
	r0->bitmapLineBlue = r10;
	r17 = (hxd__CustomCursor)hl_alloc_obj(&t$hxd_CustomCursor);
	r20 = &t$hxd_BitmapData;
	r4 = 1;
	r19 = hl_alloc_array(r20,r4);
	r10 = r0->bitmapLineBlue;
	r4 = 0;
	((hxd__BitmapData*)(r19 + 1))[r4] = r10;
	r18 = hl_types_ArrayObj_alloc(r19);
	r2 = 0.;
	r4 = 12;
	r21 = 12;
	hxd_CustomCursor_new(r17,r18,r2,r4,r21);
	r16 = hl_alloc_enum(&t$hxd_Cursor,5);
	((hxd_Cursor_Custom*)r16)->p0 = r17;
	r0->cursorLineBlue = r16;
	r24 = hxd_Res_get_loader();
	if( r24 == NULL ) hl_null_access();
	r13 = (String)s$tool_lineRed_png;
	r14 = (hxd__res__$Image)g$_hxd_res_Image;
	r11 = hxd_res_Loader_loadCache(r24,r13,((hl__Class)r14));
	r15 = (hxd__res__Image)r11;
	if( r15 == NULL ) hl_null_access();
	r10 = hxd_res_Image_toBitmap(r15);
	r0->bitmapLineRed = r10;
	r17 = (hxd__CustomCursor)hl_alloc_obj(&t$hxd_CustomCursor);
	r20 = &t$hxd_BitmapData;
	r4 = 1;
	r19 = hl_alloc_array(r20,r4);
	r10 = r0->bitmapLineRed;
	r4 = 0;
	((hxd__BitmapData*)(r19 + 1))[r4] = r10;
	r18 = hl_types_ArrayObj_alloc(r19);
	r2 = 0.;
	r4 = 12;
	r21 = 12;
	hxd_CustomCursor_new(r17,r18,r2,r4,r21);
	r16 = hl_alloc_enum(&t$hxd_Cursor,5);
	((hxd_Cursor_Custom*)r16)->p0 = r17;
	r0->cursorLineRed = r16;
	r25 = hxd_Res_get_loader();
	if( r25 == NULL ) hl_null_access();
	r13 = (String)s$tool_lineGreen_png;
	r14 = (hxd__res__$Image)g$_hxd_res_Image;
	r11 = hxd_res_Loader_loadCache(r25,r13,((hl__Class)r14));
	r15 = (hxd__res__Image)r11;
	if( r15 == NULL ) hl_null_access();
	r10 = hxd_res_Image_toBitmap(r15);
	r0->bitmapLineGreen = r10;
	r17 = (hxd__CustomCursor)hl_alloc_obj(&t$hxd_CustomCursor);
	r20 = &t$hxd_BitmapData;
	r4 = 1;
	r19 = hl_alloc_array(r20,r4);
	r10 = r0->bitmapLineGreen;
	r4 = 0;
	((hxd__BitmapData*)(r19 + 1))[r4] = r10;
	r18 = hl_types_ArrayObj_alloc(r19);
	r2 = 0.;
	r4 = 12;
	r21 = 12;
	hxd_CustomCursor_new(r17,r18,r2,r4,r21);
	r16 = hl_alloc_enum(&t$hxd_Cursor,5);
	((hxd_Cursor_Custom*)r16)->p0 = r17;
	r0->cursorLineGreen = r16;
	r6 = ($Main)g$_Main;
	r5 = r6->canvas_interaction;
	if( r5 == NULL ) hl_null_access();
	r16 = r0->cursorPencilBlue;
	r16 = h2d_Interactive_set_cursor(r5,r16);
	return;
}

