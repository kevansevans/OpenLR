// Generated by HLC 4.1.5 (HL v5)
#define HLC_BOOT
#include <hlc.h>
#include <components/tool/ToolFunction.h>
#include <components/stage/Canvas.h>
#include <_std/Main.h>
#include <haxe/ds/StringMap.h>
#include <components/managers/Grid.h>
#include <hl/types/ArrayObj.h>
#include <h2d/col/Point.h>
#include <components/tool/ToolBehavior.h>
vvirtual* components_managers_Grid_registryPosition(double,double);
extern String s$;
extern $Main g$_Main;
extern String s$x;
extern hl_type t$_i32;
#include <hl/natives.h>
String String___alloc__(vbyte*,int);
String String___add__(String,String);
extern String s$y;
vdynamic* haxe_ds_StringMap_get(haxe__ds__StringMap,String);
extern hl_type t$vrt_3d3bf19;
extern hl_type t$hl_types_ArrayObj;
extern components__tool__$ToolFunction g$_components_tool_ToolFunction;
void components_tool_ToolFunction_tryDispose(components__lines__LineBase);
#include <components/stage/DrawMode.h>
venum* components_stage_Canvas_get_drawMode(components__stage__Canvas);
void components_managers_Grid_unregister(components__managers__Grid,components__lines__LineBase);

void components_tool_ToolFunction_eraseDefault(double r0,double r1) {
	components__managers__Grid r21;
	String r6, r14, r18;
	hl__types__ArrayObj r23;
	haxe__ds__StringMap r20;
	vvirtual *r2, *r22;
	bool r37;
	components__tool__$ToolFunction r36;
	$Main r8;
	components__tool__ToolBehavior r38;
	h2d__col__Point r29;
	components__lines__LineBase r25;
	components__stage__Canvas r7;
	double r3, r4, r27, r28, r30, r31, r32, r33, r34, r35;
	vdynamic *r19;
	int *r16;
	varray *r26;
	vbyte *r17;
	int r9, r10, r11, r12, r13, r15, r24;
	r2 = components_managers_Grid_registryPosition(r0,r1);
	r6 = (String)s$;
	r3 = 1.;
	r8 = ($Main)g$_Main;
	r7 = r8->canvas;
	if( r7 == NULL ) hl_null_access();
	r4 = r7->scaleX;
	r3 = r3 / r4;
	r9 = -1;
	label$24f39e4_1_9:
	r11 = 2;
	if( r9 >= r11 ) goto label$24f39e4_1_143;
	r10 = r9;
	++r9;
	r11 = -1;
	label$24f39e4_1_15:
	r13 = 2;
	if( r11 >= r13 ) goto label$24f39e4_1_142;
	r12 = r11;
	++r11;
	r14 = (String)s$x;
	if( r2 == NULL ) hl_null_access();
	r15 = hl_vfields(r2)[2] ? (*(int*)(hl_vfields(r2)[2])) : (int)hl_dyn_geti(r2->value,120/*x*/,&t$_i32);
	r13 = r10 + r15;
	r16 = &r13;
	r17 = hl_itos(r13,r16);
	r18 = String___alloc__(r17,r13);
	r14 = String___add__(r14,r18);
	r18 = (String)s$y;
	r14 = String___add__(r14,r18);
	r15 = hl_vfields(r2)[3] ? (*(int*)(hl_vfields(r2)[3])) : (int)hl_dyn_geti(r2->value,121/*y*/,&t$_i32);
	r13 = r12 + r15;
	r16 = &r13;
	r17 = hl_itos(r13,r16);
	r18 = String___alloc__(r17,r13);
	r14 = String___add__(r14,r18);
	r8 = ($Main)g$_Main;
	r21 = r8->grid;
	if( r21 == NULL ) hl_null_access();
	r20 = r21->registry;
	if( r20 == NULL ) hl_null_access();
	r19 = haxe_ds_StringMap_get(r20,r14);
	r22 = hl_to_virtual(&t$vrt_3d3bf19,(vdynamic*)r19);
	if( r22 ) goto label$24f39e4_1_45;
	goto label$24f39e4_1_15;
	label$24f39e4_1_45:
	r8 = ($Main)g$_Main;
	r21 = r8->grid;
	if( r21 == NULL ) hl_null_access();
	r20 = r21->registry;
	if( r20 == NULL ) hl_null_access();
	r19 = haxe_ds_StringMap_get(r20,r14);
	r22 = hl_to_virtual(&t$vrt_3d3bf19,(vdynamic*)r19);
	r13 = 0;
	if( r22 == NULL ) hl_null_access();
	r23 = hl_vfields(r22)[0] ? (*(hl__types__ArrayObj*)(hl_vfields(r22)[0])) : (hl__types__ArrayObj)hl_dyn_getp(r22->value,233152173/*allLines*/,&t$hl_types_ArrayObj);
	label$24f39e4_1_55:
	if( r23 == NULL ) hl_null_access();
	r24 = r23->length;
	if( r13 >= r24 ) goto label$24f39e4_1_141;
	r24 = r23->length;
	if( ((unsigned)r13) < ((unsigned)r24) ) goto label$24f39e4_1_63;
	r25 = NULL;
	goto label$24f39e4_1_66;
	label$24f39e4_1_63:
	r26 = r23->array;
	r19 = ((vdynamic**)(r26 + 1))[r13];
	r25 = (components__lines__LineBase)r19;
	label$24f39e4_1_66:
	++r13;
	if( r25 == NULL ) hl_null_access();
	r29 = r25->start;
	if( r29 == NULL ) hl_null_access();
	r28 = r29->x;
	r27 = r0 - r28;
	r29 = r25->start;
	if( r29 == NULL ) hl_null_access();
	r30 = r29->y;
	r28 = r1 - r30;
	r31 = 2.;
	r30 = hl_math_pow(r27,r31);
	r32 = 2.;
	r31 = hl_math_pow(r28,r32);
	r30 = r30 + r31;
	r30 = hl_math_sqrt(r30);
	r29 = r25->end;
	if( r29 == NULL ) hl_null_access();
	r32 = r29->x;
	r31 = r0 - r32;
	r32 = 2.;
	r31 = hl_math_pow(r31,r32);
	r29 = r25->end;
	if( r29 == NULL ) hl_null_access();
	r33 = r29->y;
	r32 = r1 - r33;
	r33 = 2.;
	r32 = hl_math_pow(r32,r33);
	r31 = r31 + r32;
	r31 = hl_math_sqrt(r31);
	r32 = r25->nx;
	r32 = r32 * r27;
	r33 = r25->ny;
	r33 = r33 * r28;
	r32 = r32 + r33;
	r32 = hl_math_abs(r32);
	r34 = r25->dx;
	r33 = r27 * r34;
	r35 = r25->dy;
	r34 = r28 * r35;
	r33 = r33 + r34;
	r34 = r25->invSqrDistance;
	r33 = r33 * r34;
	r36 = (components__tool__$ToolFunction)g$_components_tool_ToolFunction;
	r35 = r36->eraserSize;
	r35 = r35 * r3;
	if( r30 < r35 ) goto label$24f39e4_1_125;
	r36 = (components__tool__$ToolFunction)g$_components_tool_ToolFunction;
	r35 = r36->eraserSize;
	r35 = r35 * r3;
	if( r31 < r35 ) goto label$24f39e4_1_125;
	r36 = (components__tool__$ToolFunction)g$_components_tool_ToolFunction;
	r35 = r36->eraserSize;
	r35 = r35 * r3;
	if( !(r32 < r35) ) goto label$24f39e4_1_140;
	r35 = 0.;
	if( !(r33 >= r35) ) goto label$24f39e4_1_140;
	r35 = 1.;
	if( !(r35 >= r33) ) goto label$24f39e4_1_140;
	label$24f39e4_1_125:
	r8 = ($Main)g$_Main;
	r38 = r8->toolControl;
	if( r38 == NULL ) hl_null_access();
	r37 = r38->colorEraser;
	if( !r37 ) goto label$24f39e4_1_138;
	r15 = r25->type;
	r8 = ($Main)g$_Main;
	r38 = r8->toolControl;
	if( r38 == NULL ) hl_null_access();
	r24 = r38->color;
	if( r15 != r24 ) goto label$24f39e4_1_137;
	components_tool_ToolFunction_tryDispose(r25);
	label$24f39e4_1_137:
	goto label$24f39e4_1_139;
	label$24f39e4_1_138:
	components_tool_ToolFunction_tryDispose(r25);
	label$24f39e4_1_139:
	goto label$24f39e4_1_55;
	label$24f39e4_1_140:
	goto label$24f39e4_1_55;
	label$24f39e4_1_141:
	goto label$24f39e4_1_15;
	label$24f39e4_1_142:
	goto label$24f39e4_1_9;
	label$24f39e4_1_143:
	return;
}

void components_tool_ToolFunction_tryDispose(components__lines__LineBase r0) {
	components__managers__Grid r6;
	venum *r3;
	$Main r5;
	components__stage__Canvas r4;
	int r2, r7;
	r5 = ($Main)g$_Main;
	r4 = r5->canvas;
	if( r4 == NULL ) hl_null_access();
	r3 = components_stage_Canvas_get_drawMode(r4);
	if( r3 == NULL ) hl_null_access();
	r2 = HL__ENUM_INDEX__(r3);
	switch(r2) {
		default:
			goto label$24f39e4_2_30;
		case 0:
		case 1:
			r5 = ($Main)g$_Main;
			r6 = r5->grid;
			if( r6 == NULL ) hl_null_access();
			components_managers_Grid_unregister(r6,r0);
			goto label$24f39e4_2_30;
		case 2:
		case 3:
			if( r0 == NULL ) hl_null_access();
			r2 = r0->type;
			r7 = 2;
			if( r2 == r7 ) goto label$24f39e4_2_21;
			r5 = ($Main)g$_Main;
			r6 = r5->grid;
			if( r6 == NULL ) hl_null_access();
			components_managers_Grid_unregister(r6,r0);
			label$24f39e4_2_21:
			goto label$24f39e4_2_30;
		case 4:
		case 5:
			if( r0 == NULL ) hl_null_access();
			r2 = r0->type;
			r7 = 2;
			if( r2 != r7 ) goto label$24f39e4_2_30;
			r5 = ($Main)g$_Main;
			r6 = r5->grid;
			if( r6 == NULL ) hl_null_access();
			components_managers_Grid_unregister(r6,r0);
	}
	label$24f39e4_2_30:
	return;
}

