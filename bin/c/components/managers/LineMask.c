// Generated by HLC 4.1.4 (HL v5)
#define HLC_BOOT
#include <hlc.h>
#include <components/managers/LineMask.h>
#include <components/lines/LineBase.h>
#include <h2d/Graphics.h>
int hl_types_ArrayObj_push(hl__types__ArrayObj,vdynamic*);
void h2d_Object_addChild(h2d__Object,h2d__Object);
#include <components/stage/Canvas.h>
#include <_std/Main.h>
h2d__col__Point Main_get_br(void);
h2d__col__Point Main_get_tl(void);
extern $Main g$_Main;
#include <h2d/Layers.h>
void h2d_Layers_removeChild(h2d__Layers,h2d__Object);
extern components__managers__$LineMask g$_components_managers_LineMask;
bool hl_types_ArrayObj_remove(hl__types__ArrayObj,vdynamic*);
void h2d_Layers_addChild(h2d__Layers,h2d__Object);
void h2d_Mask_new(h2d__Mask,int,int,h2d__Object);
extern hl_type t$h2d_col_Point;
#include <hl/natives.h>
void h2d_col_Point_new(h2d__col__Point,double*,double*);
extern hl_type t$hl_types_ArrayObj;
void hl_types_ArrayObj_new(hl__types__ArrayObj);

void components_managers_LineMask_addLine(components__managers__LineMask r0,components__lines__LineBase r1) {
	hl__types__ArrayObj r3;
	h2d__Graphics r5;
	int r2;
	r3 = r0->lines;
	if( r3 == NULL ) hl_null_access();
	r2 = hl_types_ArrayObj_push(r3,((vdynamic*)r1));
	if( r1 == NULL ) hl_null_access();
	r5 = r1->rideLayer;
	h2d_Object_addChild(((h2d__Object)r0),((h2d__Object)r5));
	((void (*)(components__lines__LineBase))r1->$type->vobj_proto[1])(r1);
	return;
}

void components_managers_LineMask_update(components__managers__LineMask r0) {
	hl__types__ArrayObj r9;
	bool r8;
	$Main r7;
	components__managers__$LineMask r10;
	h2d__col__Point r4;
	components__stage__Canvas r6;
	double r2, r3, r5;
	int r11;
	r2 = r0->x;
	r4 = Main_get_br();
	if( r4 == NULL ) hl_null_access();
	r3 = r4->x;
	if( r3 < r2 ) goto label$8d682c7_2_24;
	r2 = r0->x;
	r4 = Main_get_tl();
	if( r4 == NULL ) hl_null_access();
	r3 = r4->x;
	r5 = 256.;
	r3 = r3 + r5;
	if( r2 < r3 ) goto label$8d682c7_2_24;
	r2 = r0->y;
	r4 = Main_get_br();
	if( r4 == NULL ) hl_null_access();
	r3 = r4->y;
	if( r3 < r2 ) goto label$8d682c7_2_24;
	r2 = r0->y;
	r4 = Main_get_tl();
	if( r4 == NULL ) hl_null_access();
	r3 = r4->y;
	r5 = 256.;
	r3 = r3 + r5;
	if( !(r2 < r3) ) goto label$8d682c7_2_35;
	label$8d682c7_2_24:
	r7 = ($Main)g$_Main;
	r6 = r7->canvas;
	if( r6 == NULL ) hl_null_access();
	h2d_Layers_removeChild(((h2d__Layers)r6),((h2d__Object)r0));
	r10 = (components__managers__$LineMask)g$_components_managers_LineMask;
	r9 = r10->visChunks;
	if( r9 == NULL ) hl_null_access();
	r8 = hl_types_ArrayObj_remove(r9,((vdynamic*)r0));
	r8 = false;
	r0->onStage = r8;
	return;
	label$8d682c7_2_35:
	r8 = r0->onStage;
	if( r8 ) goto label$8d682c7_2_47;
	r7 = ($Main)g$_Main;
	r6 = r7->canvas;
	if( r6 == NULL ) hl_null_access();
	h2d_Layers_addChild(((h2d__Layers)r6),((h2d__Object)r0));
	r10 = (components__managers__$LineMask)g$_components_managers_LineMask;
	r9 = r10->visChunks;
	if( r9 == NULL ) hl_null_access();
	r11 = hl_types_ArrayObj_push(r9,((vdynamic*)r0));
	r8 = true;
	r0->onStage = r8;
	label$8d682c7_2_47:
	return;
}

void components_managers_LineMask_new(components__managers__LineMask r0,double r1,double r2) {
	hl__types__ArrayObj r15;
	bool r3;
	h2d__Object r7;
	h2d__col__Point r8;
	double r9, r10, r12, r14;
	double *r11, *r13;
	int r5, r6;
	r3 = false;
	r0->onStage = r3;
	r5 = 256;
	r6 = 256;
	r7 = NULL;
	h2d_Mask_new(((h2d__Mask)r0),r5,r6,r7);
	r8 = (h2d__col__Point)hl_alloc_obj(&t$h2d_col_Point);
	r10 = 256.;
	r9 = r1 / r10;
	r5 = hl_math_floor(r9);
	r9 = (double)r5;
	r11 = &r9;
	r12 = 256.;
	r10 = r2 / r12;
	r5 = hl_math_floor(r10);
	r10 = (double)r5;
	r13 = &r10;
	h2d_col_Point_new(r8,r11,r13);
	r0->chunkPos = r8;
	r3 = true;
	r0->posChanged = r3;
	r8 = r0->chunkPos;
	if( r8 == NULL ) hl_null_access();
	r12 = r8->x;
	r14 = 256.;
	r12 = r12 * r14;
	r0->x = r12;
	r3 = true;
	r0->posChanged = r3;
	r8 = r0->chunkPos;
	if( r8 == NULL ) hl_null_access();
	r12 = r8->y;
	r14 = 256.;
	r12 = r12 * r14;
	r0->y = r12;
	r15 = (hl__types__ArrayObj)hl_alloc_obj(&t$hl_types_ArrayObj);
	hl_types_ArrayObj_new(r15);
	r0->lines = r15;
	return;
}

