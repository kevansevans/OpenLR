// Generated by HLC 4.1.5 (HL v5)
#define HLC_BOOT
#include <hlc.h>
#include <components/managers/Riders.h>
#include <components/sledder/RiderBase.h>
vvirtual* haxe_ds_StringMap_iterator(haxe__ds__StringMap);
extern hl_type t$vrt_91f9e97;
extern hl_type t$fun_bf7849e;
extern hl_type t$fun_6c7a217;
#include <h2d/col/Point.h>
#include <components/stage/LRConsole.h>
#include <_std/Main.h>
#include <components/sledder/Bosh.h>
#include <components/managers/Simulation.h>
vdynamic* haxe_ds_StringMap_get(haxe__ds__StringMap,String);
#include <hl/natives.h>
String String___alloc__(vbyte*,int);
String String___add__(String,String);
extern $Main g$_Main;
extern String s$Rider_name_;
extern String s$_already_occupied_renaming_to_;
#include <h2d/Console.h>
void h2d_Console_log(h2d__Console,String,vdynamic*);
extern String s$;
extern hl_type t$vrt_b840ca7;
extern hl_type t$components_sledder_Bosh;
extern hl_type t$_f64;
void components_sledder_Bosh_new(components__sledder__Bosh,vdynamic*,vdynamic*,String,vdynamic*,vdynamic*);
extern hl_type t$haxe_ds_StringMap;
void haxe_ds_StringMap_set(haxe__ds__StringMap,String,vdynamic*);
void components_managers_Simulation_recordGlobalSimState(components__managers__Simulation);
extern String s$Rider_;
extern String s$_does_not_exist;
extern hl_type t$_i32;
bool haxe_ds_StringMap_remove(haxe__ds__StringMap,String);
String components_sledder_RiderBase_set_name(components__sledder__RiderBase,String);
void components_sledder_RiderBase_stepRider(components__sledder__RiderBase);
#include <components/physics/BindStick.h>
extern components__physics__$BindStick g$_components_physics_BindStick;
void haxe_ds_StringMap_new(haxe__ds__StringMap);
String components_sledder_RiderBase_get_name(components__sledder__RiderBase);

void components_managers_Riders_deleteAllRiders(components__managers__Riders r0) {
	haxe__ds__StringMap r2;
	vvirtual *r1, *r3;
	bool r5;
	components__sledder__RiderBase r6;
	r2 = r0->riders;
	if( r2 == NULL ) hl_null_access();
	r1 = haxe_ds_StringMap_iterator(r2);
	r3 = hl_to_virtual(&t$vrt_91f9e97,(vdynamic*)r1);
	label$fbc84c5_1_4:
	if( r3 == NULL ) hl_null_access();
	if( hl_vfields(r3)[0] ) r5 = ((bool (*)(vdynamic*))hl_vfields(r3)[0])(r3->value); else {
		vdynamic ret;
		hl_dyn_call_obj(r3->value,&t$fun_bf7849e,407283053/*hasNext*/,NULL,&ret);
		r5 = (bool)ret.v.i;
	}
	if( !r5 ) goto label$fbc84c5_1_12;
	if( hl_vfields(r3)[1] ) r6 = ((components__sledder__RiderBase (*)(vdynamic*))hl_vfields(r3)[1])(r3->value); else {
		r6 = (components__sledder__RiderBase)hl_dyn_call_obj(r3->value,&t$fun_6c7a217,151160317/*next*/,NULL,NULL);
	}
	if( r6 == NULL ) hl_null_access();
	((void (*)(components__sledder__RiderBase))r6->$type->vobj_proto[2])(r6);
	goto label$fbc84c5_1_4;
	label$fbc84c5_1_12:
	return;
}

void components_managers_Riders_addNewRider(components__managers__Riders r0,String r1,h2d__col__Point r2,vdynamic* r3,vdynamic* r4) {
	String r5, r9, r15, r18;
	vvirtual *r20;
	haxe__ds__StringMap r8;
	components__sledder__Bosh r21;
	$Main r17;
	components__sledder__RiderBase r10;
	components__managers__Simulation r25;
	double r22;
	int *r13;
	vdynamic *r7, *r19, *r23, *r24;
	components__stage__LRConsole r16;
	vbyte *r14;
	int r11, r12;
	r5 = r1;
	r8 = r0->riders;
	if( r8 == NULL ) hl_null_access();
	r7 = haxe_ds_StringMap_get(r8,r1);
	r10 = (components__sledder__RiderBase)r7;
	if( !r10 ) goto label$fbc84c5_2_43;
	r11 = 0;
	label$fbc84c5_2_7:
	r8 = r0->riders;
	if( r8 == NULL ) hl_null_access();
	r12 = r11;
	r13 = &r12;
	r14 = hl_itos(r12,r13);
	r15 = String___alloc__(r14,r12);
	r9 = String___add__(r5,r15);
	r7 = haxe_ds_StringMap_get(r8,r9);
	r10 = (components__sledder__RiderBase)r7;
	if( !r10 ) goto label$fbc84c5_2_20;
	++r11;
	goto label$fbc84c5_2_7;
	label$fbc84c5_2_20:
	r17 = ($Main)g$_Main;
	r16 = r17->console;
	if( r16 == NULL ) hl_null_access();
	r9 = (String)s$Rider_name_;
	r9 = String___add__(r9,r5);
	r15 = (String)s$_already_occupied_renaming_to_;
	r9 = String___add__(r9,r15);
	r12 = r11;
	r13 = &r12;
	r14 = hl_itos(r12,r13);
	r18 = String___alloc__(r14,r12);
	r15 = String___add__(r5,r18);
	r9 = String___add__(r9,r15);
	r19 = NULL;
	h2d_Console_log(((h2d__Console)r16),r9,r19);
	r15 = (String)s$;
	r12 = r11;
	r13 = &r12;
	r14 = hl_itos(r12,r13);
	r18 = String___alloc__(r14,r12);
	r15 = String___add__(r15,r18);
	r9 = String___add__(r5,r15);
	r5 = r9;
	label$fbc84c5_2_43:
	r8 = r0->riders;
	if( r8 ) goto label$fbc84c5_2_47;
	r20 = NULL;
	goto label$fbc84c5_2_51;
	label$fbc84c5_2_47:
	r20 = r8->f$1;
	if( r20 ) goto label$fbc84c5_2_51;
	r20 = hl_to_virtual(&t$vrt_b840ca7,(vdynamic*)r8);
	r8->f$1 = r20;
	label$fbc84c5_2_51:
	r21 = (components__sledder__Bosh)hl_alloc_obj(&t$components_sledder_Bosh);
	if( r2 == NULL ) hl_null_access();
	r22 = r2->x;
	r23 = hl_alloc_dynamic(&t$_f64);
	r23->v.d = r22;
	r22 = r2->y;
	r24 = hl_alloc_dynamic(&t$_f64);
	r24->v.d = r22;
	components_sledder_Bosh_new(r21,r23,r24,r5,r3,r4);
	r8 = (haxe__ds__StringMap)hl_dyn_castp(&r20,&t$vrt_b840ca7,&t$haxe_ds_StringMap);
	if( r8 == NULL ) hl_null_access();
	haxe_ds_StringMap_set(r8,r5,((vdynamic*)r21));
	r11 = r0->riderCount;
	++r11;
	r0->riderCount = r11;
	r17 = ($Main)g$_Main;
	r25 = r17->simulation;
	if( r25 == NULL ) hl_null_access();
	components_managers_Simulation_recordGlobalSimState(r25);
	return;
}

void components_managers_Riders_renameRider(components__managers__Riders r0,String r1,String r2) {
	String r6, r10, r16, r17;
	haxe__ds__StringMap r5;
	bool r18;
	$Main r9;
	components__sledder__RiderBase r7;
	int *r14;
	vdynamic *r4, *r12;
	vbyte *r15;
	int r11, r13;
	components__stage__LRConsole r8;
	r5 = r0->riders;
	if( r5 == NULL ) hl_null_access();
	r4 = haxe_ds_StringMap_get(r5,r1);
	r7 = (components__sledder__RiderBase)r4;
	if( r7 ) goto label$fbc84c5_3_16;
	r9 = ($Main)g$_Main;
	r8 = r9->console;
	if( r8 == NULL ) hl_null_access();
	r6 = (String)s$Rider_;
	r6 = String___add__(r6,r1);
	r10 = (String)s$_does_not_exist;
	r6 = String___add__(r6,r10);
	r11 = 16711680;
	r12 = hl_alloc_dynamic(&t$_i32);
	r12->v.i = r11;
	h2d_Console_log(((h2d__Console)r8),r6,r12);
	return;
	label$fbc84c5_3_16:
	r6 = r2;
	r5 = r0->riders;
	if( r5 == NULL ) hl_null_access();
	r4 = haxe_ds_StringMap_get(r5,r2);
	r7 = (components__sledder__RiderBase)r4;
	if( !r7 ) goto label$fbc84c5_3_59;
	r11 = 0;
	label$fbc84c5_3_23:
	r5 = r0->riders;
	if( r5 == NULL ) hl_null_access();
	r13 = r11;
	r14 = &r13;
	r15 = hl_itos(r13,r14);
	r16 = String___alloc__(r15,r13);
	r10 = String___add__(r6,r16);
	r4 = haxe_ds_StringMap_get(r5,r10);
	r7 = (components__sledder__RiderBase)r4;
	if( !r7 ) goto label$fbc84c5_3_36;
	++r11;
	goto label$fbc84c5_3_23;
	label$fbc84c5_3_36:
	r9 = ($Main)g$_Main;
	r8 = r9->console;
	if( r8 == NULL ) hl_null_access();
	r10 = (String)s$Rider_name_;
	r10 = String___add__(r10,r6);
	r16 = (String)s$_already_occupied_renaming_to_;
	r10 = String___add__(r10,r16);
	r13 = r11;
	r14 = &r13;
	r15 = hl_itos(r13,r14);
	r17 = String___alloc__(r15,r13);
	r16 = String___add__(r6,r17);
	r10 = String___add__(r10,r16);
	r12 = NULL;
	h2d_Console_log(((h2d__Console)r8),r10,r12);
	r16 = (String)s$;
	r13 = r11;
	r14 = &r13;
	r15 = hl_itos(r13,r14);
	r17 = String___alloc__(r15,r13);
	r16 = String___add__(r16,r17);
	r10 = String___add__(r6,r16);
	r6 = r10;
	label$fbc84c5_3_59:
	r5 = r0->riders;
	if( r5 == NULL ) hl_null_access();
	r4 = haxe_ds_StringMap_get(r5,r1);
	r7 = (components__sledder__RiderBase)r4;
	r5 = r0->riders;
	if( r5 == NULL ) hl_null_access();
	r18 = haxe_ds_StringMap_remove(r5,r1);
	if( r7 == NULL ) hl_null_access();
	r10 = components_sledder_RiderBase_set_name(r7,r6);
	r5 = r0->riders;
	if( r5 == NULL ) hl_null_access();
	haxe_ds_StringMap_set(r5,r6,((vdynamic*)r7));
	return;
}

void components_managers_Riders_stepRiders(components__managers__Riders r0) {
	haxe__ds__StringMap r2;
	vvirtual *r1, *r3;
	bool r5;
	components__sledder__RiderBase r6;
	r2 = r0->riders;
	if( r2 == NULL ) hl_null_access();
	r1 = haxe_ds_StringMap_iterator(r2);
	r3 = hl_to_virtual(&t$vrt_91f9e97,(vdynamic*)r1);
	label$fbc84c5_4_4:
	if( r3 == NULL ) hl_null_access();
	if( hl_vfields(r3)[0] ) r5 = ((bool (*)(vdynamic*))hl_vfields(r3)[0])(r3->value); else {
		vdynamic ret;
		hl_dyn_call_obj(r3->value,&t$fun_bf7849e,407283053/*hasNext*/,NULL,&ret);
		r5 = (bool)ret.v.i;
	}
	if( !r5 ) goto label$fbc84c5_4_12;
	if( hl_vfields(r3)[1] ) r6 = ((components__sledder__RiderBase (*)(vdynamic*))hl_vfields(r3)[1])(r3->value); else {
		r6 = (components__sledder__RiderBase)hl_dyn_call_obj(r3->value,&t$fun_6c7a217,151160317/*next*/,NULL,NULL);
	}
	if( r6 == NULL ) hl_null_access();
	components_sledder_RiderBase_stepRider(r6);
	goto label$fbc84c5_4_4;
	label$fbc84c5_4_12:
	return;
}

void components_managers_Riders_resetPositions(components__managers__Riders r0) {
	haxe__ds__StringMap r4;
	vvirtual *r3, *r5;
	bool r1;
	components__physics__$BindStick r2;
	components__sledder__RiderBase r7;
	r1 = false;
	r2 = (components__physics__$BindStick)g$_components_physics_BindStick;
	r2->crash = r1;
	r4 = r0->riders;
	if( r4 == NULL ) hl_null_access();
	r3 = haxe_ds_StringMap_iterator(r4);
	r5 = hl_to_virtual(&t$vrt_91f9e97,(vdynamic*)r3);
	label$fbc84c5_5_7:
	if( r5 == NULL ) hl_null_access();
	if( hl_vfields(r5)[0] ) r1 = ((bool (*)(vdynamic*))hl_vfields(r5)[0])(r5->value); else {
		vdynamic ret;
		hl_dyn_call_obj(r5->value,&t$fun_bf7849e,407283053/*hasNext*/,NULL,&ret);
		r1 = (bool)ret.v.i;
	}
	if( !r1 ) goto label$fbc84c5_5_15;
	if( hl_vfields(r5)[1] ) r7 = ((components__sledder__RiderBase (*)(vdynamic*))hl_vfields(r5)[1])(r5->value); else {
		r7 = (components__sledder__RiderBase)hl_dyn_call_obj(r5->value,&t$fun_6c7a217,151160317/*next*/,NULL,NULL);
	}
	if( r7 == NULL ) hl_null_access();
	((void (*)(components__sledder__RiderBase))r7->$type->vobj_proto[1])(r7);
	goto label$fbc84c5_5_7;
	label$fbc84c5_5_15:
	return;
}

void components_managers_Riders_removeRider(components__managers__Riders r0,String r1) {
	haxe__ds__StringMap r4;
	components__sledder__RiderBase r5;
	vdynamic *r3;
	r4 = r0->riders;
	if( r4 == NULL ) hl_null_access();
	r3 = haxe_ds_StringMap_get(r4,r1);
	r5 = (components__sledder__RiderBase)r3;
	if( r5 == NULL ) hl_null_access();
	((void (*)(components__sledder__RiderBase))r5->$type->vobj_proto[2])(r5);
	return;
}

void components_managers_Riders_new(components__managers__Riders r0) {
	String r7;
	haxe__ds__StringMap r2;
	components__sledder__Bosh r4;
	vdynamic *r5, *r6, *r8, *r9;
	int r1;
	r1 = 0;
	r0->riderCount = r1;
	r2 = (haxe__ds__StringMap)hl_alloc_obj(&t$haxe_ds_StringMap);
	haxe_ds_StringMap_new(r2);
	r0->riders = r2;
	r4 = (components__sledder__Bosh)hl_alloc_obj(&t$components_sledder_Bosh);
	r5 = NULL;
	r6 = NULL;
	r7 = NULL;
	r8 = NULL;
	r9 = NULL;
	components_sledder_Bosh_new(r4,r5,r6,r7,r8,r9);
	r2 = r0->riders;
	if( r2 == NULL ) hl_null_access();
	r7 = components_sledder_RiderBase_get_name(((components__sledder__RiderBase)r4));
	haxe_ds_StringMap_set(r2,r7,((vdynamic*)r4));
	r1 = r0->riderCount;
	++r1;
	r0->riderCount = r1;
	return;
}

