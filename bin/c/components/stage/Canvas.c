// Generated by HLC 4.1.5 (HL v5)
#define HLC_BOOT
#include <hlc.h>
#include <components/stage/Canvas.h>
#include <haxe/ds/StringMap.h>
#include <components/managers/Riders.h>
#include <_std/Main.h>
#include <components/sledder/RiderBase.h>
extern $Main g$_Main;
vvirtual* haxe_ds_StringMap_iterator(haxe__ds__StringMap);
extern hl_type t$vrt_91f9e97;
extern hl_type t$fun_bf7849e;
extern hl_type t$fun_6c7a217;
#include <components/stage/LRConsole.h>
extern String s$Set_canvas_position_to_;
#include <hl/natives.h>
String String___alloc__(vbyte*,int);
String String___add__(String,String);
extern String s$7215ee9;
extern hl_type t$_i32;
#include <h2d/Console.h>
void h2d_Console_log(h2d__Console,String,vdynamic*);
double h2d_Scene_get_mouseX(h2d__Scene);
double h2d_Scene_get_mouseY(h2d__Scene);
double Math_max(double,double);
double Math_min(double,double);
#include <components/lines/LineBase.h>
#include <components/lines/Floor.h>
#include <h2d/Graphics.h>
#include <components/lines/Accel.h>
#include <components/lines/Scenery.h>
#include <components/managers/Grid.h>
extern hl_type t$components_lines_Floor;
extern hl_type t$h2d_col_Point;
void h2d_col_Point_new(h2d__col__Point,double*,double*);
void components_lines_Floor_new(components__lines__Floor,h2d__col__Point,h2d__col__Point,bool);
void components_lines_LineBase_setLim(components__lines__LineBase,int);
extern hl_type t$components_lines_Accel;
void components_lines_Accel_new(components__lines__Accel,h2d__col__Point,h2d__col__Point,bool);
extern hl_type t$components_lines_Scenery;
void components_lines_Scenery_new(components__lines__Scenery,h2d__col__Point,h2d__col__Point,bool);
void components_managers_Grid_register(components__managers__Grid,components__lines__LineBase);
bool h2d_Object_set_visible(h2d__Object,bool);
extern String s$Draw_mode_set_to_Edit;
extern String s$Draw_mode_set_to_Playback;
extern String s$Draw_mode_set_to_No_Scenery_Edit;
extern String s$cb653d7;
extern String s$2504e23;
extern String s$83a17f8;
extern venum* g$6537d82;
void h2d_Scene_new(h2d__Scene);
extern hl_type t$h2d_Object;
void h2d_Object_new(h2d__Object,h2d__Object);

void components_stage_Canvas_drawRiders(components__stage__Canvas r0) {
	components__managers__Riders r3;
	haxe__ds__StringMap r2;
	vvirtual *r1, *r5;
	bool r7;
	components__sledder__RiderBase r8;
	$Main r4;
	r4 = ($Main)g$_Main;
	r3 = r4->riders;
	if( r3 == NULL ) hl_null_access();
	r2 = r3->riders;
	if( r2 == NULL ) hl_null_access();
	r1 = haxe_ds_StringMap_iterator(r2);
	r5 = hl_to_virtual(&t$vrt_91f9e97,(vdynamic*)r1);
	label$ae2bdbd_1_7:
	if( r5 == NULL ) hl_null_access();
	if( hl_vfields(r5)[0] ) r7 = ((bool (*)(vdynamic*))hl_vfields(r5)[0])(r5->value); else {
		vdynamic ret;
		hl_dyn_call_obj(r5->value,&t$fun_bf7849e,407283053/*hasNext*/,NULL,&ret);
		r7 = (bool)ret.v.i;
	}
	if( !r7 ) goto label$ae2bdbd_1_15;
	if( hl_vfields(r5)[1] ) r8 = ((components__sledder__RiderBase (*)(vdynamic*))hl_vfields(r5)[1])(r5->value); else {
		r8 = (components__sledder__RiderBase)hl_dyn_call_obj(r5->value,&t$fun_6c7a217,151160317/*next*/,NULL,NULL);
	}
	if( r8 == NULL ) hl_null_access();
	((void (*)(components__sledder__RiderBase))r8->$type->vobj_proto[3])(r8);
	goto label$ae2bdbd_1_7;
	label$ae2bdbd_1_15:
	return;
}

void components_stage_Canvas_setCanvasPosition(components__stage__Canvas r0,double r1,double r2,vdynamic* r3) {
	String r8, r12;
	bool r4;
	$Main r7;
	vdynamic *r13;
	int *r10;
	vbyte *r11;
	int r9;
	components__stage__LRConsole r6;
	if( r3 ) goto label$ae2bdbd_2_3;
	r4 = true;
	r3 = hl_alloc_dynbool(r4);
	label$ae2bdbd_2_3:
	r4 = true;
	r0->posChanged = r4;
	r0->x = r1;
	r4 = true;
	r0->posChanged = r4;
	r0->y = r2;
	r4 = r3 ? r3->v.b : 0;
	if( !r4 ) goto label$ae2bdbd_2_28;
	r7 = ($Main)g$_Main;
	r6 = r7->console;
	if( r6 == NULL ) hl_null_access();
	r8 = (String)s$Set_canvas_position_to_;
	r10 = &r9;
	r11 = hl_ftos(r1,r10);
	r12 = String___alloc__(r11,r9);
	r8 = String___add__(r8,r12);
	r12 = (String)s$7215ee9;
	r8 = String___add__(r8,r12);
	r10 = &r9;
	r11 = hl_ftos(r2,r10);
	r12 = String___alloc__(r11,r9);
	r8 = String___add__(r8,r12);
	r9 = 187;
	r13 = hl_alloc_dynamic(&t$_i32);
	r13->v.i = r9;
	h2d_Console_log(((h2d__Console)r6),r8,r13);
	label$ae2bdbd_2_28:
	return;
}

void components_stage_Canvas_addCanvasPosition(components__stage__Canvas r0,double r1,double r2) {
	bool r4;
	double r5;
	if( r0 == NULL ) hl_null_access();
	r4 = true;
	r0->posChanged = r4;
	r5 = r0->x;
	r5 = r5 + r1;
	r0->x = r5;
	r4 = true;
	r0->posChanged = r4;
	r5 = r0->y;
	r5 = r5 + r2;
	r0->y = r5;
	return;
}

void components_stage_Canvas_zoomCanvas(components__stage__Canvas r0,int r1) {
	bool r9;
	double r2, r4, r5, r6, r7, r10, r11, r12;
	int r8;
	r2 = r0->scaleX;
	r4 = h2d_Scene_get_mouseX(((h2d__Scene)r0));
	r5 = h2d_Scene_get_mouseY(((h2d__Scene)r0));
	r6 = r0->scaleX;
	r8 = 0;
	if( r8 >= r1 ) goto label$ae2bdbd_4_8;
	r7 = 0.82499999999999996;
	goto label$ae2bdbd_4_9;
	label$ae2bdbd_4_8:
	r7 = 1.125;
	label$ae2bdbd_4_9:
	r6 = r6 * r7;
	r7 = 0.01;
	r6 = Math_max(r6,r7);
	r7 = 100.;
	r6 = Math_min(r6,r7);
	r9 = true;
	r0->posChanged = r9;
	r0->scaleX = r6;
	r9 = true;
	r0->posChanged = r9;
	r0->scaleY = r6;
	r7 = r0->scaleX;
	if( r0 == NULL ) hl_null_access();
	r9 = true;
	r0->posChanged = r9;
	r10 = r0->x;
	r12 = r7 - r2;
	r11 = r4 * r12;
	r11 = -r11;
	r10 = r10 + r11;
	r0->x = r10;
	r9 = true;
	r0->posChanged = r9;
	r10 = r0->y;
	r12 = r7 - r2;
	r11 = r5 * r12;
	r11 = -r11;
	r10 = r10 + r11;
	r0->y = r10;
	return;
}

void components_stage_Canvas_addLine(components__stage__Canvas r0,int r1,double r2,double r3,double r4,double r5,vdynamic* r6,vdynamic* r7) {
	components__managers__Grid r34;
	h2d__Graphics r23;
	bool r8;
	h2d__Object r22;
	components__lines__Floor r12;
	$Main r35;
	h2d__col__Point r13, r18;
	components__lines__LineBase r10;
	double r14, r16, r19, r20, r25, r26, r27, r28, r30, r31, r32, r33;
	components__lines__Scenery r29;
	vdynamic *r21;
	double *r15, *r17;
	components__lines__Accel r24;
	int r9;
	if( r6 ) goto label$ae2bdbd_5_3;
	r8 = false;
	r6 = hl_alloc_dynbool(r8);
	label$ae2bdbd_5_3:
	if( r7 ) goto label$ae2bdbd_5_6;
	r9 = -1;
	r7 = hl_alloc_dynamic(&t$_i32);
	r7->v.i = r9;
	label$ae2bdbd_5_6:
	r10 = NULL;
	switch(r1) {
		default:
			goto label$ae2bdbd_5_93;
		case 0:
			r12 = (components__lines__Floor)hl_alloc_obj(&t$components_lines_Floor);
			r13 = (h2d__col__Point)hl_alloc_obj(&t$h2d_col_Point);
			r14 = r2;
			r15 = &r14;
			r16 = r3;
			r17 = &r16;
			h2d_col_Point_new(r13,r15,r17);
			r18 = (h2d__col__Point)hl_alloc_obj(&t$h2d_col_Point);
			r19 = r4;
			r15 = &r19;
			r20 = r5;
			r17 = &r20;
			h2d_col_Point_new(r18,r15,r17);
			r8 = r6 ? r6->v.b : 0;
			components_lines_Floor_new(r12,r13,r18,r8);
			r10 = ((components__lines__LineBase)r12);
			r9 = -1;
			r21 = hl_alloc_dynamic(&t$_i32);
			r21->v.i = r9;
			if( r7 == r21 || (r7 && r21 && (r7->v.i == r21->v.i)) ) goto label$ae2bdbd_5_30;
			r9 = r7 ? r7->v.i : 0;
			components_lines_LineBase_setLim(((components__lines__LineBase)r12),r9);
			label$ae2bdbd_5_30:
			r22 = r0->colorLayer;
			if( r22 == NULL ) hl_null_access();
			r23 = r12->colorLayer;
			((void (*)(h2d__Object,h2d__Graphics))r22->$type->vobj_proto[1])(r22,r23);
			r22 = r0->rideLayer;
			if( r22 == NULL ) hl_null_access();
			r23 = r12->rideLayer;
			((void (*)(h2d__Object,h2d__Graphics))r22->$type->vobj_proto[1])(r22,r23);
			goto label$ae2bdbd_5_93;
		case 1:
			r24 = (components__lines__Accel)hl_alloc_obj(&t$components_lines_Accel);
			r13 = (h2d__col__Point)hl_alloc_obj(&t$h2d_col_Point);
			r25 = r2;
			r15 = &r25;
			r26 = r3;
			r17 = &r26;
			h2d_col_Point_new(r13,r15,r17);
			r18 = (h2d__col__Point)hl_alloc_obj(&t$h2d_col_Point);
			r27 = r4;
			r15 = &r27;
			r28 = r5;
			r17 = &r28;
			h2d_col_Point_new(r18,r15,r17);
			r8 = r6 ? r6->v.b : 0;
			components_lines_Accel_new(r24,r13,r18,r8);
			r10 = ((components__lines__LineBase)r24);
			r9 = -1;
			r21 = hl_alloc_dynamic(&t$_i32);
			r21->v.i = r9;
			if( r7 == r21 || (r7 && r21 && (r7->v.i == r21->v.i)) ) goto label$ae2bdbd_5_60;
			r9 = r7 ? r7->v.i : 0;
			components_lines_LineBase_setLim(((components__lines__LineBase)r24),r9);
			label$ae2bdbd_5_60:
			r22 = r0->colorLayer;
			if( r22 == NULL ) hl_null_access();
			r23 = r24->colorLayer;
			((void (*)(h2d__Object,h2d__Graphics))r22->$type->vobj_proto[1])(r22,r23);
			r22 = r0->rideLayer;
			if( r22 == NULL ) hl_null_access();
			r23 = r24->rideLayer;
			((void (*)(h2d__Object,h2d__Graphics))r22->$type->vobj_proto[1])(r22,r23);
			goto label$ae2bdbd_5_93;
		case 2:
			r29 = (components__lines__Scenery)hl_alloc_obj(&t$components_lines_Scenery);
			r13 = (h2d__col__Point)hl_alloc_obj(&t$h2d_col_Point);
			r30 = r2;
			r15 = &r30;
			r31 = r3;
			r17 = &r31;
			h2d_col_Point_new(r13,r15,r17);
			r18 = (h2d__col__Point)hl_alloc_obj(&t$h2d_col_Point);
			r32 = r4;
			r15 = &r32;
			r33 = r5;
			r17 = &r33;
			h2d_col_Point_new(r18,r15,r17);
			r8 = r6 ? r6->v.b : 0;
			components_lines_Scenery_new(r29,r13,r18,r8);
			r10 = ((components__lines__LineBase)r29);
			r22 = r0->sceneColorLayer;
			if( r22 == NULL ) hl_null_access();
			r23 = r29->colorLayer;
			((void (*)(h2d__Object,h2d__Graphics))r22->$type->vobj_proto[1])(r22,r23);
			r22 = r0->scenePlaybackLayer;
			if( r22 == NULL ) hl_null_access();
			r23 = r29->rideLayer;
			((void (*)(h2d__Object,h2d__Graphics))r22->$type->vobj_proto[1])(r22,r23);
	}
	label$ae2bdbd_5_93:
	if( r10 == NULL ) hl_null_access();
	((void (*)(components__lines__LineBase))r10->$type->vobj_proto[1])(r10);
	r35 = ($Main)g$_Main;
	r34 = r35->grid;
	if( r34 == NULL ) hl_null_access();
	components_managers_Grid_register(r34,r10);
	return;
}

venum* components_stage_Canvas_get_drawMode(components__stage__Canvas r0) {
	venum *r1;
	r1 = r0->drawMode;
	return r1;
}

venum* components_stage_Canvas_set_drawMode(components__stage__Canvas r0,venum* r1) {
	String r8;
	bool r4;
	h2d__Object r5;
	$Main r7;
	vdynamic *r9;
	components__stage__LRConsole r6;
	int r3;
	if( r1 == NULL ) hl_null_access();
	r3 = HL__ENUM_INDEX__(r1);
	switch(r3) {
		default:
			goto label$ae2bdbd_7_141;
		case 0:
			r5 = r0->colorLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = true;
			r4 = h2d_Object_set_visible(r5,r4);
			r5 = r0->sceneColorLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = true;
			r4 = h2d_Object_set_visible(r5,r4);
			r5 = r0->scenePlaybackLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = false;
			r4 = h2d_Object_set_visible(r5,r4);
			r5 = r0->rideLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = true;
			r4 = h2d_Object_set_visible(r5,r4);
			r7 = ($Main)g$_Main;
			r6 = r7->console;
			if( r6 == NULL ) hl_null_access();
			r8 = (String)s$Draw_mode_set_to_Edit;
			r9 = NULL;
			h2d_Console_log(((h2d__Console)r6),r8,r9);
			goto label$ae2bdbd_7_141;
		case 1:
			r5 = r0->colorLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = false;
			r4 = h2d_Object_set_visible(r5,r4);
			r5 = r0->sceneColorLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = false;
			r4 = h2d_Object_set_visible(r5,r4);
			r5 = r0->scenePlaybackLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = true;
			r4 = h2d_Object_set_visible(r5,r4);
			r5 = r0->rideLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = true;
			r4 = h2d_Object_set_visible(r5,r4);
			r7 = ($Main)g$_Main;
			r6 = r7->console;
			if( r6 == NULL ) hl_null_access();
			r8 = (String)s$Draw_mode_set_to_Playback;
			r9 = NULL;
			h2d_Console_log(((h2d__Console)r6),r8,r9);
			goto label$ae2bdbd_7_141;
		case 2:
			r5 = r0->colorLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = true;
			r4 = h2d_Object_set_visible(r5,r4);
			r5 = r0->sceneColorLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = false;
			r4 = h2d_Object_set_visible(r5,r4);
			r5 = r0->scenePlaybackLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = false;
			r4 = h2d_Object_set_visible(r5,r4);
			r5 = r0->rideLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = true;
			r4 = h2d_Object_set_visible(r5,r4);
			r7 = ($Main)g$_Main;
			r6 = r7->console;
			if( r6 == NULL ) hl_null_access();
			r8 = (String)s$Draw_mode_set_to_No_Scenery_Edit;
			r9 = NULL;
			h2d_Console_log(((h2d__Console)r6),r8,r9);
			goto label$ae2bdbd_7_141;
		case 3:
			r5 = r0->colorLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = false;
			r4 = h2d_Object_set_visible(r5,r4);
			r5 = r0->sceneColorLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = false;
			r4 = h2d_Object_set_visible(r5,r4);
			r5 = r0->scenePlaybackLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = false;
			r4 = h2d_Object_set_visible(r5,r4);
			r5 = r0->rideLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = true;
			r4 = h2d_Object_set_visible(r5,r4);
			r7 = ($Main)g$_Main;
			r6 = r7->console;
			if( r6 == NULL ) hl_null_access();
			r8 = (String)s$cb653d7;
			r9 = NULL;
			h2d_Console_log(((h2d__Console)r6),r8,r9);
			goto label$ae2bdbd_7_141;
		case 4:
			r5 = r0->colorLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = false;
			r4 = h2d_Object_set_visible(r5,r4);
			r5 = r0->sceneColorLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = true;
			r4 = h2d_Object_set_visible(r5,r4);
			r5 = r0->scenePlaybackLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = false;
			r4 = h2d_Object_set_visible(r5,r4);
			r5 = r0->rideLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = false;
			r4 = h2d_Object_set_visible(r5,r4);
			r7 = ($Main)g$_Main;
			r6 = r7->console;
			if( r6 == NULL ) hl_null_access();
			r8 = (String)s$2504e23;
			r9 = NULL;
			h2d_Console_log(((h2d__Console)r6),r8,r9);
			goto label$ae2bdbd_7_141;
		case 5:
			r5 = r0->colorLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = false;
			r4 = h2d_Object_set_visible(r5,r4);
			r5 = r0->sceneColorLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = false;
			r4 = h2d_Object_set_visible(r5,r4);
			r5 = r0->scenePlaybackLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = true;
			r4 = h2d_Object_set_visible(r5,r4);
			r5 = r0->rideLayer;
			if( r5 == NULL ) hl_null_access();
			r4 = false;
			r4 = h2d_Object_set_visible(r5,r4);
			r7 = ($Main)g$_Main;
			r6 = r7->console;
			if( r6 == NULL ) hl_null_access();
			r8 = (String)s$83a17f8;
			r9 = NULL;
			h2d_Console_log(((h2d__Console)r6),r8,r9);
	}
	label$ae2bdbd_7_141:
	r0->drawMode = r1;
	return r1;
}

void components_stage_Canvas_new(components__stage__Canvas r0,h2d__Object r1) {
	venum *r2;
	bool r5;
	h2d__Object r4;
	r2 = (venum*)g$6537d82;
	r0->drawMode = r2;
	h2d_Scene_new(((h2d__Scene)r0));
	if( r1 == NULL ) hl_null_access();
	((void (*)(h2d__Object,components__stage__Canvas))r1->$type->vobj_proto[1])(r1,r0);
	r4 = (h2d__Object)hl_alloc_obj(&t$h2d_Object);
	h2d_Object_new(r4,((h2d__Object)r0));
	r0->sceneColorLayer = r4;
	r4 = (h2d__Object)hl_alloc_obj(&t$h2d_Object);
	h2d_Object_new(r4,((h2d__Object)r0));
	r0->scenePlaybackLayer = r4;
	r4 = r0->scenePlaybackLayer;
	if( r4 == NULL ) hl_null_access();
	r5 = false;
	r5 = h2d_Object_set_visible(r4,r5);
	r4 = (h2d__Object)hl_alloc_obj(&t$h2d_Object);
	h2d_Object_new(r4,((h2d__Object)r0));
	r0->colorLayer = r4;
	r4 = (h2d__Object)hl_alloc_obj(&t$h2d_Object);
	h2d_Object_new(r4,((h2d__Object)r0));
	r0->rideLayer = r4;
	r4 = (h2d__Object)hl_alloc_obj(&t$h2d_Object);
	h2d_Object_new(r4,((h2d__Object)r0));
	r0->sledderLayer = r4;
	r4 = (h2d__Object)hl_alloc_obj(&t$h2d_Object);
	h2d_Object_new(r4,((h2d__Object)r0));
	r0->preview = r4;
	return;
}

