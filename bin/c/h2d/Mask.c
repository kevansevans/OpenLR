// Generated by HLC 4.1.4 (HL v5)
#define HLC_BOOT
#include <hlc.h>
#include <h2d/Mask.h>
void h2d_RenderContext_pushRenderZone(h2d__RenderContext,double,double,double,double);
void h2d_RenderContext_popRenderZone(h2d__RenderContext);
void h2d_Object_onHierarchyMoved(h2d__Object,bool);
void h2d_Mask_updateMask(h2d__Mask);
void h2d_Object_onAdd(h2d__Object);
extern h2d__$Mask g$_h2d_Mask;
bool hl_BaseType_check(hl__BaseType,vdynamic*);
void h2d_Object_calcAbsPos(h2d__Object);
#include <h2d/col/Bounds.h>
void h2d_Object_addBounds(h2d__Object,h2d__Object,h2d__col__Bounds,double,double,double,double);
void h2d_Object_getBoundsRec(h2d__Object,h2d__Object,h2d__col__Bounds,bool);
void h2d_Object_drawRec(h2d__Object,h2d__RenderContext);
void h2d_Object_new(h2d__Object,h2d__Object);

void h2d_Mask_maskWith(h2d__RenderContext r0,h2d__Object r1,int r2,int r3,double* r4,double* r5) {
	double r6, r7, r8, r9, r11, r12, r13, r14, r15, r16;
	if( r4 ) goto label$3dbbe5f_1_3;
	r6 = 0.;
	goto label$3dbbe5f_1_4;
	label$3dbbe5f_1_3:
	r6 = *r4;
	label$3dbbe5f_1_4:
	if( r5 ) goto label$3dbbe5f_1_7;
	r7 = 0.;
	goto label$3dbbe5f_1_8;
	label$3dbbe5f_1_7:
	r7 = *r5;
	label$3dbbe5f_1_8:
	if( r1 == NULL ) hl_null_access();
	r8 = r1->absX;
	r8 = r8 + r6;
	r9 = r1->absY;
	r9 = r9 + r7;
	r11 = (double)r2;
	r12 = r1->matA;
	r11 = r11 * r12;
	r12 = (double)r3;
	r13 = r1->matC;
	r12 = r12 * r13;
	r11 = r11 + r12;
	r11 = r11 + r8;
	r12 = (double)r2;
	r13 = r1->matB;
	r12 = r12 * r13;
	r13 = (double)r3;
	r14 = r1->matD;
	r13 = r13 * r14;
	r12 = r12 + r13;
	r12 = r12 + r9;
	if( !(r11 < r8) ) goto label$3dbbe5f_1_33;
	r13 = r8;
	r8 = r11;
	r11 = r13;
	label$3dbbe5f_1_33:
	if( !(r12 < r9) ) goto label$3dbbe5f_1_37;
	r13 = r9;
	r9 = r12;
	r12 = r13;
	label$3dbbe5f_1_37:
	if( r0 == NULL ) hl_null_access();
	r15 = r11 - r8;
	r16 = r12 - r9;
	h2d_RenderContext_pushRenderZone(r0,r8,r9,r15,r16);
	return;
}

void h2d_Mask_unmask(h2d__RenderContext r0) {
	if( r0 == NULL ) hl_null_access();
	h2d_RenderContext_popRenderZone(r0);
	return;
}

void h2d_Mask_onHierarchyMoved(h2d__Mask r0,bool r1) {
	h2d_Object_onHierarchyMoved(((h2d__Object)r0),r1);
	if( !r1 ) goto label$3dbbe5f_3_3;
	h2d_Mask_updateMask(r0);
	label$3dbbe5f_3_3:
	return;
}

void h2d_Mask_onAdd(h2d__Mask r0) {
	h2d_Object_onAdd(((h2d__Object)r0));
	h2d_Mask_updateMask(r0);
	return;
}

void h2d_Mask_updateMask(h2d__Mask r0) {
	bool r6;
	h2d__Object r2, r4;
	h2d__$Mask r5;
	h2d__Mask r1;
	r1 = NULL;
	r0->parentMask = r1;
	r2 = r0->parent;
	label$3dbbe5f_5_3:
	if( !r2 ) goto label$3dbbe5f_5_18;
	r5 = (h2d__$Mask)g$_h2d_Mask;
	r6 = hl_BaseType_check(((hl__BaseType)r5),((vdynamic*)r2));
	if( !r6 ) goto label$3dbbe5f_5_10;
	r1 = (h2d__Mask)r2;
	goto label$3dbbe5f_5_11;
	label$3dbbe5f_5_10:
	r1 = NULL;
	label$3dbbe5f_5_11:
	if( !r1 ) goto label$3dbbe5f_5_14;
	r0->parentMask = r1;
	goto label$3dbbe5f_5_18;
	label$3dbbe5f_5_14:
	if( r2 == NULL ) hl_null_access();
	r4 = r2->parent;
	r2 = r4;
	goto label$3dbbe5f_5_3;
	label$3dbbe5f_5_18:
	return;
}

void h2d_Mask_calcAbsPos(h2d__Mask r0) {
	double r2, r3;
	h2d_Object_calcAbsPos(((h2d__Object)r0));
	r2 = r0->absX;
	r3 = r0->scrollX;
	r2 = r2 - r3;
	r0->absX = r2;
	r2 = r0->absY;
	r3 = r0->scrollY;
	r2 = r2 - r3;
	r0->absY = r2;
	return;
}

void h2d_Mask_getBoundsRec(h2d__Mask r0,h2d__Object r1,h2d__col__Bounds r2,bool r3) {
	hl__types__ArrayObj r12;
	bool r10;
	h2d__Object r14;
	double r4, r6, r7, r8, r9, r17, r18, r19, r20;
	vdynamic *r15;
	varray *r16;
	int r11, r13;
	if( r2 == NULL ) hl_null_access();
	r4 = r2->xMin;
	r6 = r2->yMin;
	r7 = r2->xMax;
	r8 = r2->yMax;
	r9 = 1e+020;
	r2->xMin = r9;
	r9 = 1e+020;
	r2->yMin = r9;
	r9 = -1e+020;
	r2->xMax = r9;
	r9 = -1e+020;
	r2->yMax = r9;
	r10 = r0->posChanged;
	if( !r10 ) goto label$3dbbe5f_7_36;
	h2d_Mask_calcAbsPos(r0);
	r11 = 0;
	r12 = r0->children;
	label$3dbbe5f_7_18:
	if( r12 == NULL ) hl_null_access();
	r13 = r12->length;
	if( r11 >= r13 ) goto label$3dbbe5f_7_34;
	r13 = r12->length;
	if( ((unsigned)r11) < ((unsigned)r13) ) goto label$3dbbe5f_7_26;
	r14 = NULL;
	goto label$3dbbe5f_7_29;
	label$3dbbe5f_7_26:
	r16 = r12->array;
	r15 = ((vdynamic**)(r16 + 1))[r11];
	r14 = (h2d__Object)r15;
	label$3dbbe5f_7_29:
	++r11;
	if( r14 == NULL ) hl_null_access();
	r10 = true;
	r14->posChanged = r10;
	goto label$3dbbe5f_7_18;
	label$3dbbe5f_7_34:
	r10 = false;
	r0->posChanged = r10;
	label$3dbbe5f_7_36:
	r9 = r0->scrollX;
	r17 = r0->scrollY;
	r11 = r0->width;
	r18 = (double)r11;
	r11 = r0->height;
	r19 = (double)r11;
	h2d_Object_addBounds(((h2d__Object)r0),r1,r2,r9,r17,r18,r19);
	if( r2 == NULL ) hl_null_access();
	r9 = r2->xMin;
	r17 = r2->yMin;
	r18 = r2->xMax;
	r19 = r2->yMax;
	r2->xMin = r4;
	r2->xMax = r7;
	r2->yMin = r6;
	r2->yMax = r8;
	h2d_Object_getBoundsRec(((h2d__Object)r0),r1,r2,r3);
	r20 = r2->xMin;
	if( !(r20 < r9) ) goto label$3dbbe5f_7_60;
	if( !(r9 < r4) ) goto label$3dbbe5f_7_58;
	r20 = r9;
	goto label$3dbbe5f_7_59;
	label$3dbbe5f_7_58:
	r20 = r4;
	label$3dbbe5f_7_59:
	r2->xMin = r20;
	label$3dbbe5f_7_60:
	r20 = r2->yMin;
	if( !(r20 < r17) ) goto label$3dbbe5f_7_67;
	if( !(r17 < r6) ) goto label$3dbbe5f_7_65;
	r20 = r17;
	goto label$3dbbe5f_7_66;
	label$3dbbe5f_7_65:
	r20 = r6;
	label$3dbbe5f_7_66:
	r2->yMin = r20;
	label$3dbbe5f_7_67:
	r20 = r2->xMax;
	if( !(r18 < r20) ) goto label$3dbbe5f_7_74;
	if( !(r7 < r18) ) goto label$3dbbe5f_7_72;
	r20 = r18;
	goto label$3dbbe5f_7_73;
	label$3dbbe5f_7_72:
	r20 = r7;
	label$3dbbe5f_7_73:
	r2->xMax = r20;
	label$3dbbe5f_7_74:
	r20 = r2->yMax;
	if( !(r19 < r20) ) goto label$3dbbe5f_7_81;
	if( !(r8 < r19) ) goto label$3dbbe5f_7_79;
	r20 = r19;
	goto label$3dbbe5f_7_80;
	label$3dbbe5f_7_79:
	r20 = r8;
	label$3dbbe5f_7_80:
	r2->yMax = r20;
	label$3dbbe5f_7_81:
	return;
}

void h2d_Mask_drawRec(h2d__Mask r0,h2d__RenderContext r1) {
	double r5, r7;
	double *r6, *r8;
	int r3, r4;
	r3 = r0->width;
	r4 = r0->height;
	r5 = r0->scrollX;
	r6 = &r5;
	r7 = r0->scrollY;
	r8 = &r7;
	h2d_Mask_maskWith(r1,((h2d__Object)r0),r3,r4,r6,r8);
	h2d_Object_drawRec(((h2d__Object)r0),r1);
	h2d_Mask_unmask(r1);
	return;
}

void h2d_Mask_new(h2d__Mask r0,int r1,int r2,h2d__Object r3) {
	double r4;
	r4 = 0.;
	r0->scrollY = r4;
	r4 = 0.;
	r0->scrollX = r4;
	h2d_Object_new(((h2d__Object)r0),r3);
	r0->width = r1;
	r0->height = r2;
	return;
}

