// Generated by HLC 4.1.4 (HL v5)
#define HLC_BOOT
#include <hlc.h>
#include <h2d/Scene.h>
extern String s$a7cc641;
vdynamic* haxe_Exception_thrown(vdynamic*);
void h2d_Scene_addCamera(h2d__Scene,h2d__Camera,vdynamic*);
void h2d_Scene_removeCamera(h2d__Scene,h2d__Camera);
void hl_types_ArrayObj_insert(hl__types__ArrayObj,int,vdynamic*);
int hl_types_ArrayObj_push(hl__types__ArrayObj,vdynamic*);
extern String s$d97a1d0;
bool hl_types_ArrayObj_remove(hl__types__ArrayObj,vdynamic*);
#include <h3d/Engine.h>
#include <h2d/ScaleModeAlign.h>
extern h3d__$Engine g$_h3d_Engine;
extern venum* g$h2d_ScaleModeAlign_Center;
#include <hl/natives.h>
void h2d_Object_syncPos(h2d__Object);
int hxd_Window_get_mouseX(hxd__Window);
int hxd_Window_get_mouseY(hxd__Window);
void h2d_Scene_screenToViewport(h2d__Scene,hxd__Event);
extern hl_type t$h2d_Object;
extern hl_type t$vrt_c8e313e;
void h2d_Camera_eventToCamera(h2d__Camera,hxd__Event);
#include <h2d/Interactive.h>
extern hl_type t$h2d_Interactive;
void h2d_Interactive_handleEvent(h2d__Interactive,hxd__Event);
int hl_types_ArrayObj_indexOf(hl__types__ArrayObj,vdynamic*,vdynamic*);
extern hl_type t$fun_439d9a7;
extern hl_type t$ctx_c40a634;
extern hl_type t$fun_af3d9dd;
void hxd_SceneEvents_startDrag(hxd__SceneEvents,vclosure*,vclosure*,hxd__Event);
void hxd_SceneEvents_stopDrag(hxd__SceneEvents);
void hxd_SceneEvents_onRemove(hxd__SceneEvents,vvirtual*);
void h2d_Scene_sync(h2d__Scene,h2d__RenderContext);
void h2d_RenderContext_begin(h2d__RenderContext);
void h2d_RenderContext_drawScene(h2d__RenderContext);
void h2d_RenderContext_end(h2d__RenderContext);
void h2d_Scene_onAdd(h2d__Scene);
void h2d_Object_sync(h2d__Object,h2d__RenderContext);
void h2d_Camera_sync(h2d__Camera,h2d__RenderContext,bool*);
#include <h2d/col/Bounds.h>
int hxd_Window_get_width(hxd__Window);
int hxd_Window_get_height(hxd__Window);
void h2d_Object_clipBounds(h2d__Object,h2d__RenderContext,h2d__col__Bounds);
void h2d_Camera_enter(h2d__Camera,h2d__RenderContext);
void h2d_Camera_exit(h2d__Camera,h2d__RenderContext);
void h2d_Object_draw(h2d__Object,h2d__RenderContext);
void h2d_Object_onAdd(h2d__Object);
extern hl_type t$fun_5fa1654;
void hxd_Window_addResizeEvent(hxd__Window,vclosure*);
void h2d_Object_onRemove(h2d__Object);
void hxd_Window_removeResizeEvent(hxd__Window,vclosure*);
extern venum* g$h2d_ScaleMode_Resize;
void h2d_Layers_new(h2d__Layers,h2d__Object);
extern hl_type t$h2d_RenderContext;
void h2d_RenderContext_new(h2d__RenderContext,h2d__Scene);
extern hl_type t$h2d_Camera;
hl__types__ArrayObj hl_types_ArrayObj_alloc(varray*);
void h2d_Camera_new(h2d__Camera,h2d__Scene);
extern hl_type t$hl_types_ArrayObj;
void hl_types_ArrayObj_new(hl__types__ArrayObj);
extern hl_type t$h2d_col_Point;
void h2d_col_Point_new(h2d__col__Point,double*,double*);
hxd__Window hxd_Window_getInstance(void);

void h2d_Scene_setEvents(h2d__Scene r0,hxd__SceneEvents r1) {
	r0->events = r1;
	return;
}

h2d__Camera h2d_Scene_set_interactiveCamera(h2d__Scene r0,h2d__Camera r1) {
	String r4;
	h2d__Scene r5;
	vdynamic *r3, *r6;
	if( r1 ) goto label$d33faab_2_4;
	r4 = (String)s$a7cc641;
	r3 = haxe_Exception_thrown(((vdynamic*)r4));
	hl_throw((vdynamic*)r3);
	label$d33faab_2_4:
	if( r1 == NULL ) hl_null_access();
	r5 = r1->scene;
	if( r5 == r0 ) goto label$d33faab_2_9;
	r6 = NULL;
	h2d_Scene_addCamera(r0,r1,r6);
	label$d33faab_2_9:
	r0->interactiveCamera = r1;
	return r1;
}

void h2d_Scene_addCamera(h2d__Scene r0,h2d__Camera r1,vdynamic* r2) {
	hl__types__ArrayObj r6;
	bool r5;
	h2d__Scene r4;
	int r7;
	if( r1 == NULL ) hl_null_access();
	r4 = r1->scene;
	if( !r4 ) goto label$d33faab_3_6;
	r4 = r1->scene;
	if( r4 == NULL ) hl_null_access();
	h2d_Scene_removeCamera(r4,r1);
	label$d33faab_3_6:
	r1->scene = r0;
	r5 = true;
	r1->posChanged = r5;
	if( !r2 ) goto label$d33faab_3_15;
	r6 = r0->_cameras;
	if( r6 == NULL ) hl_null_access();
	r7 = r2 ? r2->v.i : 0;
	hl_types_ArrayObj_insert(r6,r7,((vdynamic*)r1));
	goto label$d33faab_3_18;
	label$d33faab_3_15:
	r6 = r0->_cameras;
	if( r6 == NULL ) hl_null_access();
	r7 = hl_types_ArrayObj_push(r6,((vdynamic*)r1));
	label$d33faab_3_18:
	return;
}

void h2d_Scene_removeCamera(h2d__Scene r0,h2d__Camera r1) {
	String r5;
	hl__types__ArrayObj r8;
	bool r7;
	h2d__Camera r3;
	h2d__Scene r6;
	vdynamic *r4;
	r3 = r0->interactiveCamera;
	if( r1 != r3 ) goto label$d33faab_4_5;
	r5 = (String)s$d97a1d0;
	r4 = haxe_Exception_thrown(((vdynamic*)r5));
	hl_throw((vdynamic*)r4);
	label$d33faab_4_5:
	if( r1 == NULL ) hl_null_access();
	r6 = NULL;
	r1->scene = r6;
	r8 = r0->_cameras;
	if( r8 == NULL ) hl_null_access();
	r7 = hl_types_ArrayObj_remove(r8,((vdynamic*)r1));
	return;
}

void h2d_Scene_checkResize(h2d__Scene r0) {
	venum *r4, *r12, *r13, *r18, *r19, *r20;
	bool r9;
	h3d__Engine r2;
	h3d__$Engine r3;
	double r10, r11, r15, r16, r17, r21;
	vdynamic *r14;
	int r5, r6, r7, r8, r22;
	r3 = (h3d__$Engine)g$_h3d_Engine;
	r2 = r3->CURRENT;
	r4 = r0->scaleMode;
	if( r4 == NULL ) hl_null_access();
	r5 = HL__ENUM_INDEX__(r4);
	switch(r5) {
		default:
			goto label$d33faab_5_466;
		case 0:
			if( r2 == NULL ) hl_null_access();
			r5 = r2->width;
			r6 = r2->height;
			if( r0 == NULL ) hl_null_access();
			r8 = r0->width;
			if( r5 != r8 ) goto label$d33faab_5_15;
			r8 = r0->height;
			if( r6 == r8 ) goto label$d33faab_5_19;
			label$d33faab_5_15:
			r0->width = r5;
			r0->height = r6;
			r9 = true;
			r0->posChanged = r9;
			label$d33faab_5_19:
			r10 = 1.;
			r0->viewportScaleX = r10;
			r10 = 1.;
			r0->viewportScaleY = r10;
			r10 = 2.;
			r5 = r0->width;
			r11 = (double)r5;
			r10 = r10 / r11;
			r0->viewportA = r10;
			r10 = 2.;
			r5 = r0->height;
			r11 = (double)r5;
			r10 = r10 / r11;
			r0->viewportD = r10;
			r10 = -1.;
			r0->viewportX = r10;
			r10 = -1.;
			r0->viewportY = r10;
			goto label$d33faab_5_466;
		case 1:
			r5 = ((h2d_ScaleMode_Stretch*)r4)->p1;
			r6 = ((h2d_ScaleMode_Stretch*)r4)->p0;
			if( r0 == NULL ) hl_null_access();
			r8 = r0->width;
			if( r6 != r8 ) goto label$d33faab_5_45;
			r8 = r0->height;
			if( r5 == r8 ) goto label$d33faab_5_49;
			label$d33faab_5_45:
			r0->width = r6;
			r0->height = r5;
			r9 = true;
			r0->posChanged = r9;
			label$d33faab_5_49:
			if( r2 == NULL ) hl_null_access();
			r7 = r2->width;
			r10 = (double)r7;
			r11 = (double)r6;
			r10 = r10 / r11;
			r0->viewportScaleX = r10;
			r7 = r2->height;
			r10 = (double)r7;
			r11 = (double)r5;
			r10 = r10 / r11;
			r0->viewportScaleY = r10;
			r10 = 2.;
			r7 = r0->width;
			r11 = (double)r7;
			r10 = r10 / r11;
			r0->viewportA = r10;
			r10 = 2.;
			r7 = r0->height;
			r11 = (double)r7;
			r10 = r10 / r11;
			r0->viewportD = r10;
			r10 = -1.;
			r0->viewportX = r10;
			r10 = -1.;
			r0->viewportY = r10;
			goto label$d33faab_5_466;
		case 2:
			r12 = ((h2d_ScaleMode_LetterBox*)r4)->p4;
			r13 = ((h2d_ScaleMode_LetterBox*)r4)->p3;
			r14 = ((h2d_ScaleMode_LetterBox*)r4)->p2;
			r5 = ((h2d_ScaleMode_LetterBox*)r4)->p1;
			r6 = ((h2d_ScaleMode_LetterBox*)r4)->p0;
			if( r0 == NULL ) hl_null_access();
			r8 = r0->width;
			if( r6 != r8 ) goto label$d33faab_5_85;
			r8 = r0->height;
			if( r5 == r8 ) goto label$d33faab_5_89;
			label$d33faab_5_85:
			r0->width = r6;
			r0->height = r5;
			r9 = true;
			r0->posChanged = r9;
			label$d33faab_5_89:
			if( r2 == NULL ) hl_null_access();
			r7 = r2->width;
			r10 = (double)r7;
			r11 = (double)r6;
			r10 = r10 / r11;
			r7 = r2->height;
			r11 = (double)r7;
			r15 = (double)r5;
			r11 = r11 / r15;
			if( !(r11 < r10) ) goto label$d33faab_5_101;
			r15 = r11;
			goto label$d33faab_5_102;
			label$d33faab_5_101:
			r15 = r10;
			label$d33faab_5_102:
			r9 = r14 ? r14->v.b : 0;
			if( !r9 ) goto label$d33faab_5_111;
			r7 = (int)r15;
			r16 = (double)r7;
			r15 = r16;
			r17 = 0.;
			if( r16 != r17 ) goto label$d33faab_5_111;
			r16 = 1.;
			r15 = r16;
			label$d33faab_5_111:
			r18 = r13;
			r19 = r12;
			r17 = 2.;
			r16 = r15 * r17;
			r7 = r2->width;
			r17 = (double)r7;
			r16 = r16 / r17;
			r0->viewportA = r16;
			r17 = 2.;
			r16 = r15 * r17;
			r7 = r2->height;
			r17 = (double)r7;
			r16 = r16 / r17;
			r0->viewportD = r16;
			r0->viewportScaleX = r15;
			r0->viewportScaleY = r15;
			if( r13 ) goto label$d33faab_5_130;
			r20 = (venum*)g$h2d_ScaleModeAlign_Center;
			r18 = r20;
			label$d33faab_5_130:
			if( r18 == NULL ) hl_null_access();
			r7 = HL__ENUM_INDEX__(r18);
			switch(r7) {
				default:
					r7 = r2->width;
					r16 = (double)r7;
					r7 = r0->width;
					r17 = (double)r7;
					r17 = r17 * r15;
					r16 = r16 - r17;
					r21 = 2.;
					r17 = r15 * r21;
					r16 = r16 / r17;
					r7 = hl_math_floor(r16);
					r16 = (double)r7;
					r17 = r0->viewportA;
					r16 = r16 * r17;
					r17 = 1.;
					r16 = r16 - r17;
					r0->viewportX = r16;
					r7 = r2->width;
					r16 = (double)r7;
					r7 = r0->width;
					r17 = (double)r7;
					r17 = r17 * r15;
					r16 = r16 - r17;
					r17 = 2.;
					r16 = r16 / r17;
					r7 = hl_math_floor(r16);
					r16 = (double)r7;
					r0->offsetX = r16;
					goto label$d33faab_5_180;
				case 0:
					r16 = -1.;
					r0->viewportX = r16;
					r16 = 0.;
					r0->offsetX = r16;
					goto label$d33faab_5_180;
				case 1:
					r16 = 1.;
					r7 = r0->width;
					r17 = (double)r7;
					r21 = r0->viewportA;
					r17 = r17 * r21;
					r16 = r16 - r17;
					r0->viewportX = r16;
					r7 = r2->width;
					r16 = (double)r7;
					r7 = r0->width;
					r17 = (double)r7;
					r17 = r17 * r15;
					r16 = r16 - r17;
					r0->offsetX = r16;
			}
			label$d33faab_5_180:
			if( r12 ) goto label$d33faab_5_183;
			r20 = (venum*)g$h2d_ScaleModeAlign_Center;
			r19 = r20;
			label$d33faab_5_183:
			if( r19 == NULL ) hl_null_access();
			r7 = HL__ENUM_INDEX__(r19);
			switch(r7) {
				default:
				case 0:
				case 1:
				case 2:
					r7 = r2->height;
					r16 = (double)r7;
					r7 = r0->height;
					r17 = (double)r7;
					r17 = r17 * r15;
					r16 = r16 - r17;
					r21 = 2.;
					r17 = r15 * r21;
					r16 = r16 / r17;
					r7 = hl_math_floor(r16);
					r16 = (double)r7;
					r17 = r0->viewportD;
					r16 = r16 * r17;
					r17 = 1.;
					r16 = r16 - r17;
					r0->viewportY = r16;
					r7 = r2->height;
					r16 = (double)r7;
					r7 = r0->height;
					r17 = (double)r7;
					r17 = r17 * r15;
					r16 = r16 - r17;
					r17 = 2.;
					r16 = r16 / r17;
					r7 = hl_math_floor(r16);
					r16 = (double)r7;
					r0->offsetY = r16;
					goto label$d33faab_5_233;
				case 3:
					r16 = -1.;
					r0->viewportY = r16;
					r16 = 0.;
					r0->offsetY = r16;
					goto label$d33faab_5_233;
				case 4:
					r16 = 1.;
					r7 = r0->height;
					r17 = (double)r7;
					r21 = r0->viewportD;
					r17 = r17 * r21;
					r16 = r16 - r17;
					r0->viewportY = r16;
					r7 = r2->height;
					r16 = (double)r7;
					r7 = r0->height;
					r17 = (double)r7;
					r17 = r17 * r15;
					r16 = r16 - r17;
					r0->offsetY = r16;
			}
			label$d33faab_5_233:
			goto label$d33faab_5_466;
		case 3:
			r12 = ((h2d_ScaleMode_Fixed*)r4)->p4;
			r13 = ((h2d_ScaleMode_Fixed*)r4)->p3;
			r10 = ((h2d_ScaleMode_Fixed*)r4)->p2;
			r5 = ((h2d_ScaleMode_Fixed*)r4)->p1;
			r6 = ((h2d_ScaleMode_Fixed*)r4)->p0;
			if( r0 == NULL ) hl_null_access();
			r8 = r0->width;
			if( r6 != r8 ) goto label$d33faab_5_244;
			r8 = r0->height;
			if( r5 == r8 ) goto label$d33faab_5_248;
			label$d33faab_5_244:
			r0->width = r6;
			r0->height = r5;
			r9 = true;
			r0->posChanged = r9;
			label$d33faab_5_248:
			r18 = r13;
			r19 = r12;
			r15 = 2.;
			r11 = r10 * r15;
			if( r2 == NULL ) hl_null_access();
			r7 = r2->width;
			r15 = (double)r7;
			r11 = r11 / r15;
			r0->viewportA = r11;
			r15 = 2.;
			r11 = r10 * r15;
			r7 = r2->height;
			r15 = (double)r7;
			r11 = r11 / r15;
			r0->viewportD = r11;
			r0->viewportScaleX = r10;
			r0->viewportScaleY = r10;
			if( r13 ) goto label$d33faab_5_268;
			r20 = (venum*)g$h2d_ScaleModeAlign_Center;
			r18 = r20;
			label$d33faab_5_268:
			if( r18 == NULL ) hl_null_access();
			r7 = HL__ENUM_INDEX__(r18);
			switch(r7) {
				default:
					r7 = r2->width;
					r11 = (double)r7;
					r7 = r0->width;
					r15 = (double)r7;
					r15 = r15 * r10;
					r11 = r11 - r15;
					r16 = 2.;
					r15 = r10 * r16;
					r11 = r11 / r15;
					r7 = hl_math_floor(r11);
					r11 = (double)r7;
					r15 = r0->viewportA;
					r11 = r11 * r15;
					r15 = 1.;
					r11 = r11 - r15;
					r0->viewportX = r11;
					r7 = r2->width;
					r11 = (double)r7;
					r7 = r0->width;
					r15 = (double)r7;
					r15 = r15 * r10;
					r11 = r11 - r15;
					r15 = 2.;
					r11 = r11 / r15;
					r7 = hl_math_floor(r11);
					r11 = (double)r7;
					r0->offsetX = r11;
					goto label$d33faab_5_318;
				case 0:
					r11 = -1.;
					r0->viewportX = r11;
					r11 = 0.;
					r0->offsetX = r11;
					goto label$d33faab_5_318;
				case 1:
					r11 = 1.;
					r7 = r0->width;
					r15 = (double)r7;
					r16 = r0->viewportA;
					r15 = r15 * r16;
					r11 = r11 - r15;
					r0->viewportX = r11;
					r7 = r2->width;
					r11 = (double)r7;
					r7 = r0->width;
					r15 = (double)r7;
					r15 = r15 * r10;
					r11 = r11 - r15;
					r0->offsetX = r11;
			}
			label$d33faab_5_318:
			if( r12 ) goto label$d33faab_5_321;
			r20 = (venum*)g$h2d_ScaleModeAlign_Center;
			r19 = r20;
			label$d33faab_5_321:
			if( r19 == NULL ) hl_null_access();
			r7 = HL__ENUM_INDEX__(r19);
			switch(r7) {
				default:
				case 0:
				case 1:
				case 2:
					r7 = r2->height;
					r11 = (double)r7;
					r7 = r0->height;
					r15 = (double)r7;
					r15 = r15 * r10;
					r11 = r11 - r15;
					r16 = 2.;
					r15 = r10 * r16;
					r11 = r11 / r15;
					r7 = hl_math_floor(r11);
					r11 = (double)r7;
					r15 = r0->viewportD;
					r11 = r11 * r15;
					r15 = 1.;
					r11 = r11 - r15;
					r0->viewportY = r11;
					r7 = r2->height;
					r11 = (double)r7;
					r7 = r0->height;
					r15 = (double)r7;
					r15 = r15 * r10;
					r11 = r11 - r15;
					r15 = 2.;
					r11 = r11 / r15;
					r7 = hl_math_floor(r11);
					r11 = (double)r7;
					r0->offsetY = r11;
					goto label$d33faab_5_371;
				case 3:
					r11 = -1.;
					r0->viewportY = r11;
					r11 = 0.;
					r0->offsetY = r11;
					goto label$d33faab_5_371;
				case 4:
					r11 = 1.;
					r7 = r0->height;
					r15 = (double)r7;
					r16 = r0->viewportD;
					r15 = r15 * r16;
					r11 = r11 - r15;
					r0->viewportY = r11;
					r7 = r2->height;
					r11 = (double)r7;
					r7 = r0->height;
					r15 = (double)r7;
					r15 = r15 * r10;
					r11 = r11 - r15;
					r0->offsetY = r11;
			}
			label$d33faab_5_371:
			goto label$d33faab_5_466;
		case 4:
			r10 = ((h2d_ScaleMode_Zoom*)r4)->p0;
			if( r2 == NULL ) hl_null_access();
			r5 = r2->width;
			r11 = (double)r5;
			r11 = r11 / r10;
			r5 = hl_math_ceil(r11);
			r6 = r2->height;
			r11 = (double)r6;
			r11 = r11 / r10;
			r6 = hl_math_ceil(r11);
			if( r0 == NULL ) hl_null_access();
			r8 = r0->width;
			if( r5 != r8 ) goto label$d33faab_5_387;
			r8 = r0->height;
			if( r6 == r8 ) goto label$d33faab_5_391;
			label$d33faab_5_387:
			r0->width = r5;
			r0->height = r6;
			r9 = true;
			r0->posChanged = r9;
			label$d33faab_5_391:
			r0->viewportScaleX = r10;
			r0->viewportScaleY = r10;
			r11 = 2.;
			r5 = r0->width;
			r15 = (double)r5;
			r11 = r11 / r15;
			r0->viewportA = r11;
			r11 = 2.;
			r5 = r0->height;
			r15 = (double)r5;
			r11 = r11 / r15;
			r0->viewportD = r11;
			r11 = -1.;
			r0->viewportX = r11;
			r11 = -1.;
			r0->viewportY = r11;
			goto label$d33faab_5_466;
		case 5:
			r14 = ((h2d_ScaleMode_AutoZoom*)r4)->p2;
			r5 = ((h2d_ScaleMode_AutoZoom*)r4)->p1;
			r6 = ((h2d_ScaleMode_AutoZoom*)r4)->p0;
			if( r2 == NULL ) hl_null_access();
			r7 = r2->width;
			r10 = (double)r7;
			r11 = (double)r6;
			r10 = r10 / r11;
			r7 = r2->height;
			r11 = (double)r7;
			r15 = (double)r5;
			r11 = r11 / r15;
			if( !(r11 < r10) ) goto label$d33faab_5_423;
			r15 = r11;
			goto label$d33faab_5_424;
			label$d33faab_5_423:
			r15 = r10;
			label$d33faab_5_424:
			r9 = r14 ? r14->v.b : 0;
			if( !r9 ) goto label$d33faab_5_433;
			r7 = (int)r15;
			r16 = (double)r7;
			r15 = r16;
			r17 = 0.;
			if( r16 != r17 ) goto label$d33faab_5_433;
			r16 = 1.;
			r15 = r16;
			label$d33faab_5_433:
			r7 = r2->width;
			r16 = (double)r7;
			r16 = r16 / r15;
			r7 = hl_math_ceil(r16);
			r8 = r2->height;
			r16 = (double)r8;
			r16 = r16 / r15;
			r8 = hl_math_ceil(r16);
			if( r0 == NULL ) hl_null_access();
			r22 = r0->width;
			if( r7 != r22 ) goto label$d33faab_5_446;
			r22 = r0->height;
			if( r8 == r22 ) goto label$d33faab_5_450;
			label$d33faab_5_446:
			r0->width = r7;
			r0->height = r8;
			r9 = true;
			r0->posChanged = r9;
			label$d33faab_5_450:
			r0->viewportScaleX = r15;
			r0->viewportScaleY = r15;
			r16 = 2.;
			r7 = r0->width;
			r17 = (double)r7;
			r16 = r16 / r17;
			r0->viewportA = r16;
			r16 = 2.;
			r7 = r0->height;
			r17 = (double)r7;
			r16 = r16 / r17;
			r0->viewportD = r16;
			r16 = -1.;
			r0->viewportX = r16;
			r16 = -1.;
			r0->viewportY = r16;
	}
	label$d33faab_5_466:
	return;
}

double h2d_Scene_get_mouseX(h2d__Scene r0) {
	h2d__Camera r5, r11;
	hxd__Window r3;
	double r4, r6, r7, r8, r9, r12, r13, r14, r15, r16, r17, r18;
	h2d__Scene r10;
	int r2;
	h2d_Object_syncPos(((h2d__Object)r0));
	r3 = r0->window;
	if( r3 == NULL ) hl_null_access();
	r2 = hxd_Window_get_mouseX(r3);
	r4 = (double)r2;
	r5 = r0->interactiveCamera;
	r3 = r0->window;
	if( r3 == NULL ) hl_null_access();
	r2 = hxd_Window_get_mouseX(r3);
	r6 = (double)r2;
	r3 = r0->window;
	if( r3 == NULL ) hl_null_access();
	r2 = hxd_Window_get_mouseY(r3);
	r7 = (double)r2;
	if( r5 == NULL ) hl_null_access();
	r10 = r5->scene;
	if( r10 == NULL ) hl_null_access();
	r9 = r10->offsetX;
	r8 = r6 - r9;
	r10 = r5->scene;
	if( r10 == NULL ) hl_null_access();
	r9 = r10->viewportScaleX;
	r8 = r8 / r9;
	r9 = r5->absX;
	r8 = r8 - r9;
	r9 = r5->matD;
	r8 = r8 * r9;
	r10 = r5->scene;
	if( r10 == NULL ) hl_null_access();
	r12 = r10->offsetY;
	r9 = r7 - r12;
	r10 = r5->scene;
	if( r10 == NULL ) hl_null_access();
	r12 = r10->viewportScaleY;
	r9 = r9 / r12;
	r12 = r5->absY;
	r9 = r9 - r12;
	r12 = r5->matC;
	r9 = r9 * r12;
	r8 = r8 - r9;
	r9 = r5->invDet;
	r8 = r8 * r9;
	r9 = r0->absX;
	r8 = r8 - r9;
	r9 = r0->matC;
	r12 = 0.;
	if( r9 != r12 ) goto label$d33faab_6_50;
	r12 = r0->matA;
	r9 = r8 / r12;
	return r9;
	label$d33faab_6_50:
	r3 = r0->window;
	if( r3 == NULL ) hl_null_access();
	r2 = hxd_Window_get_mouseY(r3);
	r9 = (double)r2;
	r11 = r0->interactiveCamera;
	r3 = r0->window;
	if( r3 == NULL ) hl_null_access();
	r2 = hxd_Window_get_mouseX(r3);
	r12 = (double)r2;
	r3 = r0->window;
	if( r3 == NULL ) hl_null_access();
	r2 = hxd_Window_get_mouseY(r3);
	r13 = (double)r2;
	if( r11 == NULL ) hl_null_access();
	r10 = r11->scene;
	if( r10 == NULL ) hl_null_access();
	r15 = r10->offsetX;
	r14 = r12 - r15;
	r10 = r11->scene;
	if( r10 == NULL ) hl_null_access();
	r15 = r10->viewportScaleX;
	r14 = r14 / r15;
	r15 = r11->absX;
	r14 = r14 - r15;
	r14 = -r14;
	r15 = r11->matB;
	r14 = r14 * r15;
	r10 = r11->scene;
	if( r10 == NULL ) hl_null_access();
	r16 = r10->offsetY;
	r15 = r13 - r16;
	r10 = r11->scene;
	if( r10 == NULL ) hl_null_access();
	r16 = r10->viewportScaleY;
	r15 = r15 / r16;
	r16 = r11->absY;
	r15 = r15 - r16;
	r16 = r11->matA;
	r15 = r15 * r16;
	r14 = r14 + r15;
	r15 = r11->invDet;
	r14 = r14 * r15;
	r15 = r0->absY;
	r14 = r14 - r15;
	r16 = r0->matD;
	r15 = r8 * r16;
	r17 = r0->matC;
	r16 = r14 * r17;
	r15 = r15 - r16;
	r16 = r0->matA;
	r17 = r0->matD;
	r16 = r16 * r17;
	r17 = r0->matB;
	r18 = r0->matC;
	r17 = r17 * r18;
	r16 = r16 - r17;
	r15 = r15 / r16;
	return r15;
}

double h2d_Scene_get_mouseY(h2d__Scene r0) {
	h2d__Camera r5, r11;
	hxd__Window r3;
	double r4, r6, r7, r8, r9, r12, r13, r14, r15, r16, r17, r18;
	h2d__Scene r10;
	int r2;
	h2d_Object_syncPos(((h2d__Object)r0));
	r3 = r0->window;
	if( r3 == NULL ) hl_null_access();
	r2 = hxd_Window_get_mouseY(r3);
	r4 = (double)r2;
	r5 = r0->interactiveCamera;
	r3 = r0->window;
	if( r3 == NULL ) hl_null_access();
	r2 = hxd_Window_get_mouseX(r3);
	r6 = (double)r2;
	r3 = r0->window;
	if( r3 == NULL ) hl_null_access();
	r2 = hxd_Window_get_mouseY(r3);
	r7 = (double)r2;
	if( r5 == NULL ) hl_null_access();
	r10 = r5->scene;
	if( r10 == NULL ) hl_null_access();
	r9 = r10->offsetX;
	r8 = r6 - r9;
	r10 = r5->scene;
	if( r10 == NULL ) hl_null_access();
	r9 = r10->viewportScaleX;
	r8 = r8 / r9;
	r9 = r5->absX;
	r8 = r8 - r9;
	r8 = -r8;
	r9 = r5->matB;
	r8 = r8 * r9;
	r10 = r5->scene;
	if( r10 == NULL ) hl_null_access();
	r12 = r10->offsetY;
	r9 = r7 - r12;
	r10 = r5->scene;
	if( r10 == NULL ) hl_null_access();
	r12 = r10->viewportScaleY;
	r9 = r9 / r12;
	r12 = r5->absY;
	r9 = r9 - r12;
	r12 = r5->matA;
	r9 = r9 * r12;
	r8 = r8 + r9;
	r9 = r5->invDet;
	r8 = r8 * r9;
	r9 = r0->absY;
	r8 = r8 - r9;
	r9 = r0->matB;
	r12 = 0.;
	if( r9 != r12 ) goto label$d33faab_7_51;
	r12 = r0->matD;
	r9 = r8 / r12;
	return r9;
	label$d33faab_7_51:
	r3 = r0->window;
	if( r3 == NULL ) hl_null_access();
	r2 = hxd_Window_get_mouseX(r3);
	r9 = (double)r2;
	r11 = r0->interactiveCamera;
	r3 = r0->window;
	if( r3 == NULL ) hl_null_access();
	r2 = hxd_Window_get_mouseX(r3);
	r12 = (double)r2;
	r3 = r0->window;
	if( r3 == NULL ) hl_null_access();
	r2 = hxd_Window_get_mouseY(r3);
	r13 = (double)r2;
	if( r11 == NULL ) hl_null_access();
	r10 = r11->scene;
	if( r10 == NULL ) hl_null_access();
	r15 = r10->offsetX;
	r14 = r12 - r15;
	r10 = r11->scene;
	if( r10 == NULL ) hl_null_access();
	r15 = r10->viewportScaleX;
	r14 = r14 / r15;
	r15 = r11->absX;
	r14 = r14 - r15;
	r15 = r11->matD;
	r14 = r14 * r15;
	r10 = r11->scene;
	if( r10 == NULL ) hl_null_access();
	r16 = r10->offsetY;
	r15 = r13 - r16;
	r10 = r11->scene;
	if( r10 == NULL ) hl_null_access();
	r16 = r10->viewportScaleY;
	r15 = r15 / r16;
	r16 = r11->absY;
	r15 = r15 - r16;
	r16 = r11->matC;
	r15 = r15 * r16;
	r14 = r14 - r15;
	r15 = r11->invDet;
	r14 = r14 * r15;
	r15 = r0->absX;
	r14 = r14 - r15;
	r16 = r0->matA;
	r15 = r8 * r16;
	r17 = r0->matB;
	r16 = r14 * r17;
	r15 = r15 - r16;
	r16 = r0->matA;
	r17 = r0->matD;
	r16 = r16 * r17;
	r17 = r0->matB;
	r18 = r0->matC;
	r17 = r17 * r18;
	r16 = r16 - r17;
	r15 = r15 / r16;
	return r15;
}

void h2d_Scene_dispatchListeners(h2d__Scene r0,hxd__Event r1) {
	hl__types__ArrayObj r4;
	bool r9;
	vclosure *r6;
	vdynamic *r7;
	varray *r8;
	int r3, r5;
	h2d_Scene_screenToViewport(r0,r1);
	r3 = 0;
	r4 = r0->eventListeners;
	label$d33faab_8_3:
	if( r4 == NULL ) hl_null_access();
	r5 = r4->length;
	if( r3 >= r5 ) goto label$d33faab_8_22;
	r5 = r4->length;
	if( ((unsigned)r3) < ((unsigned)r5) ) goto label$d33faab_8_11;
	r6 = NULL;
	goto label$d33faab_8_14;
	label$d33faab_8_11:
	r8 = r4->array;
	r7 = ((vdynamic**)(r8 + 1))[r3];
	r6 = (vclosure*)r7;
	label$d33faab_8_14:
	++r3;
	if( r6 == NULL ) hl_null_access();
	r6->hasValue ? ((void (*)(vdynamic*,hxd__Event))r6->fun)((vdynamic*)r6->value,r1) : ((void (*)(hxd__Event))r6->fun)(r1);
	if( r1 == NULL ) hl_null_access();
	r9 = r1->propagate;
	if( r9 ) goto label$d33faab_8_21;
	goto label$d33faab_8_22;
	label$d33faab_8_21:
	goto label$d33faab_8_3;
	label$d33faab_8_22:
	return;
}

bool h2d_Scene_isInteractiveVisible(h2d__Scene r0,vvirtual* r1) {
	bool r4;
	h2d__Object r2, r3;
	r2 = (h2d__Object)hl_dyn_castp(&r1,&t$vrt_c8e313e,&t$h2d_Object);
	label$d33faab_9_1:
	if( r2 == ((h2d__Object)r0) ) goto label$d33faab_9_12;
	if( !r2 ) goto label$d33faab_9_7;
	if( r2 == NULL ) hl_null_access();
	r4 = r2->visible;
	if( r4 ) goto label$d33faab_9_9;
	label$d33faab_9_7:
	r4 = false;
	return r4;
	label$d33faab_9_9:
	r3 = r2->parent;
	r2 = r3;
	goto label$d33faab_9_1;
	label$d33faab_9_12:
	r4 = true;
	return r4;
}

void h2d_Scene_screenToViewport(h2d__Scene r0,hxd__Event r1) {
	h2d__Camera r3;
	r3 = r0->interactiveCamera;
	if( r3 == NULL ) hl_null_access();
	h2d_Camera_eventToCamera(r3,r1);
	return;
}

void h2d_Scene_dispatchEvent(h2d__Scene r0,hxd__Event r1,vvirtual* r2) {
	double r5, r6, r7, r8, r9, r10;
	h2d__Interactive r3;
	r3 = (h2d__Interactive)hl_dyn_castp(&r2,&t$vrt_c8e313e,&t$h2d_Interactive);
	h2d_Scene_screenToViewport(r0,r1);
	if( r1 == NULL ) hl_null_access();
	r5 = r1->relX;
	if( r3 == NULL ) hl_null_access();
	r6 = r3->absX;
	r5 = r5 - r6;
	r6 = r1->relY;
	r7 = r3->absY;
	r6 = r6 - r7;
	r8 = r3->matD;
	r7 = r5 * r8;
	r9 = r3->matC;
	r8 = r6 * r9;
	r7 = r7 - r8;
	r8 = r3->invDet;
	r7 = r7 * r8;
	r9 = r3->matA;
	r8 = r6 * r9;
	r10 = r3->matB;
	r9 = r5 * r10;
	r8 = r8 - r9;
	r9 = r3->invDet;
	r8 = r8 * r9;
	r1->relX = r7;
	r1->relY = r8;
	h2d_Interactive_handleEvent(r3,r1);
	return;
}

vvirtual* h2d_Scene_handleEvent(h2d__Scene r0,hxd__Event r1,vvirtual* r2) {
	hl__types__ArrayObj r8;
	vvirtual *r7, *r24;
	bool r25, r28;
	h2d__Object r26, r27;
	h2d__col__Point r12;
	double r4, r5, r18, r19, r20, r21, r22, r23;
	vdynamic *r10, *r16;
	h2d__Interactive r9;
	varray *r17;
	int r6, r11, r13, r14, r15;
	h2d_Scene_screenToViewport(r0,r1);
	if( r1 == NULL ) hl_null_access();
	r4 = r1->relX;
	r5 = r1->relY;
	if( r2 ) goto label$d33faab_12_7;
	r6 = 0;
	goto label$d33faab_12_14;
	label$d33faab_12_7:
	r8 = r0->interactive;
	if( r8 == NULL ) hl_null_access();
	r9 = (h2d__Interactive)hl_dyn_castp(&r2,&t$vrt_c8e313e,&t$h2d_Interactive);
	r10 = NULL;
	r6 = hl_types_ArrayObj_indexOf(r8,((vdynamic*)r9),r10);
	r11 = 1;
	r6 = r6 + r11;
	label$d33faab_12_14:
	r12 = r0->shapePoint;
	r11 = r6;
	r8 = r0->interactive;
	if( r8 == NULL ) hl_null_access();
	r13 = r8->length;
	label$d33faab_12_19:
	if( r11 >= r13 ) goto label$d33faab_12_116;
	r14 = r11;
	++r11;
	r8 = r0->interactive;
	if( r8 == NULL ) hl_null_access();
	r15 = r8->length;
	if( ((unsigned)r14) < ((unsigned)r15) ) goto label$d33faab_12_29;
	r9 = NULL;
	goto label$d33faab_12_32;
	label$d33faab_12_29:
	r17 = r8->array;
	r16 = ((vdynamic**)(r17 + 1))[r14];
	r9 = (h2d__Interactive)r16;
	label$d33faab_12_32:
	if( r9 ) goto label$d33faab_12_34;
	goto label$d33faab_12_116;
	label$d33faab_12_34:
	if( r9 == NULL ) hl_null_access();
	r18 = r9->invDet;
	r19 = 0.;
	if( r18 != r19 ) goto label$d33faab_12_39;
	goto label$d33faab_12_19;
	label$d33faab_12_39:
	r19 = r9->absX;
	r18 = r4 - r19;
	r20 = r9->absY;
	r19 = r5 - r20;
	r21 = r9->matD;
	r20 = r18 * r21;
	r22 = r9->matC;
	r21 = r19 * r22;
	r20 = r20 - r21;
	r21 = r9->invDet;
	r20 = r20 * r21;
	r22 = r9->matA;
	r21 = r19 * r22;
	r23 = r9->matB;
	r22 = r18 * r23;
	r21 = r21 - r22;
	r22 = r9->invDet;
	r21 = r21 * r22;
	r24 = r9->shape;
	if( !r24 ) goto label$d33faab_12_72;
	if( r12 == NULL ) hl_null_access();
	r23 = r9->shapeX;
	r22 = r20 + r23;
	r12->x = r22;
	r23 = r9->shapeY;
	r22 = r21 + r23;
	r12->y = r22;
	r24 = r9->shape;
	if( r24 == NULL ) hl_null_access();
	if( hl_vfields(r24)[0] ) r25 = ((bool (*)(vdynamic*,h2d__col__Point))hl_vfields(r24)[0])(r24->value,r12); else {
		void *args[] = {r12};
		vdynamic ret;
		hl_dyn_call_obj(r24->value,&t$fun_439d9a7,209410724/*contains*/,args,&ret);
		r25 = (bool)ret.v.i;
	}
	if( r25 ) goto label$d33faab_12_71;
	goto label$d33faab_12_19;
	label$d33faab_12_71:
	goto label$d33faab_12_81;
	label$d33faab_12_72:
	r23 = 0.;
	if( r21 < r23 ) goto label$d33faab_12_80;
	r23 = 0.;
	if( r20 < r23 ) goto label$d33faab_12_80;
	r23 = r9->width;
	if( r20 >= r23 ) goto label$d33faab_12_80;
	r23 = r9->height;
	if( !(r21 >= r23) ) goto label$d33faab_12_81;
	label$d33faab_12_80:
	goto label$d33faab_12_19;
	label$d33faab_12_81:
	r25 = true;
	r26 = ((h2d__Object)r9);
	label$d33faab_12_83:
	if( !r26 ) goto label$d33faab_12_94;
	if( r26 == NULL ) hl_null_access();
	r28 = r26->visible;
	if( r28 ) goto label$d33faab_12_91;
	r28 = false;
	r25 = r28;
	goto label$d33faab_12_94;
	label$d33faab_12_91:
	r27 = r26->parent;
	r26 = r27;
	goto label$d33faab_12_83;
	label$d33faab_12_94:
	if( r25 ) goto label$d33faab_12_96;
	goto label$d33faab_12_19;
	label$d33faab_12_96:
	if( r1 == NULL ) hl_null_access();
	r1->relX = r20;
	r1->relY = r21;
	if( r9 == NULL ) hl_null_access();
	h2d_Interactive_handleEvent(r9,r1);
	r28 = r1->cancel;
	if( !r28 ) goto label$d33faab_12_108;
	r28 = false;
	r1->cancel = r28;
	r28 = false;
	r1->propagate = r28;
	goto label$d33faab_12_19;
	label$d33faab_12_108:
	if( r9 ) goto label$d33faab_12_111;
	r7 = NULL;
	goto label$d33faab_12_115;
	label$d33faab_12_111:
	r7 = r9->f$54;
	if( r7 ) goto label$d33faab_12_115;
	r7 = hl_to_virtual(&t$vrt_c8e313e,(vdynamic*)r9);
	r9->f$54 = r7;
	label$d33faab_12_115:
	return r7;
	label$d33faab_12_116:
	r7 = NULL;
	return r7;
}

void h2d_Scene_startDrag__$1(venum* r0,hxd__Event r1) {
	vclosure *r4;
	h2d__Scene r3;
	r3 = ((Enumt$ctx_c40a634*)r0)->p1;
	if( r3 == NULL ) hl_null_access();
	h2d_Scene_screenToViewport(r3,r1);
	r4 = ((Enumt$ctx_c40a634*)r0)->p0;
	if( r4 == NULL ) hl_null_access();
	r4->hasValue ? ((void (*)(vdynamic*,hxd__Event))r4->fun)((vdynamic*)r4->value,r1) : ((void (*)(hxd__Event))r4->fun)(r1);
	return;
}

void h2d_Scene_startDrag(h2d__Scene r0,vclosure* r1,vclosure* r2,hxd__Event r3) {
	venum *r7;
	vclosure *r6;
	hxd__SceneEvents r5;
	r5 = r0->events;
	if( r5 == NULL ) hl_null_access();
	r7 = hl_alloc_enum(&t$ctx_c40a634,0);
	((Enumt$ctx_c40a634*)r7)->p0 = (vclosure*)r1;
	((Enumt$ctx_c40a634*)r7)->p1 = (h2d__Scene)r0;
	r6 = hl_alloc_closure_ptr(&t$fun_af3d9dd,h2d_Scene_startDrag__$1,r7);
	hxd_SceneEvents_startDrag(r5,r6,r2,r3);
	return;
}

void h2d_Scene_stopDrag(h2d__Scene r0) {
	hxd__SceneEvents r2;
	r2 = r0->events;
	if( r2 == NULL ) hl_null_access();
	hxd_SceneEvents_stopDrag(r2);
	return;
}

void h2d_Scene_addEventTarget(h2d__Scene r0,h2d__Interactive r1) {
	hl__types__ArrayObj r10;
	h2d__Object r3, r6, r16, r17, r18, r20, r23;
	vdynamic *r14;
	h2d__Interactive r2;
	varray *r15;
	int r5, r7, r8, r9, r11, r12, r13, r19, r21, r22, r24, r25, r26, r27, r28;
	r3 = ((h2d__Object)r1);
	r5 = 0;
	label$d33faab_16_2:
	if( !r3 ) goto label$d33faab_16_9;
	if( r3 == NULL ) hl_null_access();
	r6 = r3->parent;
	r3 = r6;
	++r5;
	goto label$d33faab_16_2;
	label$d33faab_16_9:
	r7 = r5;
	r8 = 0;
	r10 = r0->interactive;
	if( r10 == NULL ) hl_null_access();
	r9 = r10->length;
	label$d33faab_16_14:
	if( r8 >= r9 ) goto label$d33faab_16_124;
	r11 = r8;
	++r8;
	r6 = ((h2d__Object)r1);
	r10 = r0->interactive;
	if( r10 == NULL ) hl_null_access();
	r13 = r10->length;
	if( ((unsigned)r11) < ((unsigned)r13) ) goto label$d33faab_16_25;
	r2 = NULL;
	goto label$d33faab_16_28;
	label$d33faab_16_25:
	r15 = r10->array;
	r14 = ((vdynamic**)(r15 + 1))[r11];
	r2 = (h2d__Interactive)r14;
	label$d33faab_16_28:
	r16 = ((h2d__Object)r2);
	r12 = r7;
	r17 = ((h2d__Object)r2);
	r13 = 0;
	label$d33faab_16_32:
	if( !r17 ) goto label$d33faab_16_39;
	if( r17 == NULL ) hl_null_access();
	r18 = r17->parent;
	r17 = r18;
	++r13;
	goto label$d33faab_16_32;
	label$d33faab_16_39:
	r19 = r13;
	r18 = r6;
	r20 = r16;
	label$d33faab_16_42:
	if( r19 >= r12 ) goto label$d33faab_16_50;
	r6 = r18;
	if( r18 == NULL ) hl_null_access();
	r23 = r18->parent;
	r18 = r23;
	--r12;
	goto label$d33faab_16_42;
	label$d33faab_16_50:
	if( r12 >= r19 ) goto label$d33faab_16_58;
	r16 = r20;
	if( r20 == NULL ) hl_null_access();
	r23 = r20->parent;
	r20 = r23;
	--r19;
	goto label$d33faab_16_50;
	label$d33faab_16_58:
	if( r18 == r20 ) goto label$d33faab_16_69;
	r6 = r18;
	if( r18 == NULL ) hl_null_access();
	r23 = r18->parent;
	r18 = r23;
	r16 = r20;
	if( r20 == NULL ) hl_null_access();
	r23 = r20->parent;
	r20 = r23;
	goto label$d33faab_16_58;
	label$d33faab_16_69:
	r21 = -1;
	r22 = 0;
	if( r18 == NULL ) hl_null_access();
	r10 = r18->children;
	if( r10 == NULL ) hl_null_access();
	r24 = r10->length;
	label$d33faab_16_75:
	if( r22 >= r24 ) goto label$d33faab_16_93;
	r25 = r22;
	++r22;
	if( r18 == NULL ) hl_null_access();
	r10 = r18->children;
	if( r10 == NULL ) hl_null_access();
	r27 = r10->length;
	if( ((unsigned)r25) < ((unsigned)r27) ) goto label$d33faab_16_86;
	r23 = NULL;
	goto label$d33faab_16_89;
	label$d33faab_16_86:
	r15 = r10->array;
	r14 = ((vdynamic**)(r15 + 1))[r25];
	r23 = (h2d__Object)r14;
	label$d33faab_16_89:
	if( r23 != r6 ) goto label$d33faab_16_92;
	r21 = r25;
	goto label$d33faab_16_93;
	label$d33faab_16_92:
	goto label$d33faab_16_75;
	label$d33faab_16_93:
	r22 = r21;
	r24 = -1;
	r25 = 0;
	if( r20 == NULL ) hl_null_access();
	r10 = r20->children;
	if( r10 == NULL ) hl_null_access();
	r26 = r10->length;
	label$d33faab_16_100:
	if( r25 >= r26 ) goto label$d33faab_16_118;
	r27 = r25;
	++r25;
	if( r20 == NULL ) hl_null_access();
	r10 = r20->children;
	if( r10 == NULL ) hl_null_access();
	r28 = r10->length;
	if( ((unsigned)r27) < ((unsigned)r28) ) goto label$d33faab_16_111;
	r23 = NULL;
	goto label$d33faab_16_114;
	label$d33faab_16_111:
	r15 = r10->array;
	r14 = ((vdynamic**)(r15 + 1))[r27];
	r23 = (h2d__Object)r14;
	label$d33faab_16_114:
	if( r23 != r16 ) goto label$d33faab_16_117;
	r24 = r27;
	goto label$d33faab_16_118;
	label$d33faab_16_117:
	goto label$d33faab_16_100;
	label$d33faab_16_118:
	if( r24 >= r22 ) goto label$d33faab_16_123;
	r10 = r0->interactive;
	if( r10 == NULL ) hl_null_access();
	hl_types_ArrayObj_insert(r10,r11,((vdynamic*)r1));
	return;
	label$d33faab_16_123:
	goto label$d33faab_16_14;
	label$d33faab_16_124:
	r10 = r0->interactive;
	if( r10 == NULL ) hl_null_access();
	r8 = hl_types_ArrayObj_push(r10,((vdynamic*)r1));
	return;
}

void h2d_Scene_removeEventTarget(h2d__Scene r0,h2d__Interactive r1,bool* r2) {
	vvirtual *r8;
	hl__types__ArrayObj r5;
	bool r3, r4;
	hxd__SceneEvents r7;
	if( r2 ) goto label$d33faab_17_3;
	r3 = false;
	goto label$d33faab_17_4;
	label$d33faab_17_3:
	r3 = *r2;
	label$d33faab_17_4:
	r5 = r0->interactive;
	if( r5 == NULL ) hl_null_access();
	r4 = hl_types_ArrayObj_remove(r5,((vdynamic*)r1));
	if( !r3 ) goto label$d33faab_17_20;
	r7 = r0->events;
	if( !r7 ) goto label$d33faab_17_20;
	r7 = r0->events;
	if( r7 == NULL ) hl_null_access();
	if( r1 ) goto label$d33faab_17_15;
	r8 = NULL;
	goto label$d33faab_17_19;
	label$d33faab_17_15:
	r8 = r1->f$54;
	if( r8 ) goto label$d33faab_17_19;
	r8 = hl_to_virtual(&t$vrt_c8e313e,(vdynamic*)r1);
	r1->f$54 = r8;
	label$d33faab_17_19:
	hxd_SceneEvents_onRemove(r7,r8);
	label$d33faab_17_20:
	return;
}

void h2d_Scene_setElapsedTime(h2d__Scene r0,double r1) {
	h2d__RenderContext r2;
	r2 = r0->ctx;
	if( r2 == NULL ) hl_null_access();
	r2->elapsedTime = r1;
	return;
}

void h2d_Scene_render(h2d__Scene r0,h3d__Engine r1) {
	hl__types__ArrayObj r9;
	h2d__RenderContext r2, r7;
	double r5, r6;
	int r3, r4;
	r2 = r0->ctx;
	if( r2 == NULL ) hl_null_access();
	r2->engine = r1;
	r2 = r0->ctx;
	if( r2 == NULL ) hl_null_access();
	r3 = r2->frame;
	++r3;
	r2->frame = r3;
	r2 = r0->ctx;
	if( r2 == NULL ) hl_null_access();
	r5 = r2->time;
	r7 = r0->ctx;
	if( r7 == NULL ) hl_null_access();
	r6 = r7->elapsedTime;
	r5 = r5 + r6;
	r2->time = r5;
	r2 = r0->ctx;
	if( r2 == NULL ) hl_null_access();
	r5 = r0->alpha;
	r2->globalAlpha = r5;
	r2 = r0->ctx;
	h2d_Scene_sync(r0,r2);
	r9 = r0->children;
	if( r9 == NULL ) hl_null_access();
	r3 = r9->length;
	r4 = 0;
	if( r3 != r4 ) goto label$d33faab_19_28;
	return;
	label$d33faab_19_28:
	r2 = r0->ctx;
	if( r2 == NULL ) hl_null_access();
	h2d_RenderContext_begin(r2);
	r2 = r0->ctx;
	if( r2 == NULL ) hl_null_access();
	h2d_RenderContext_drawScene(r2);
	r2 = r0->ctx;
	if( r2 == NULL ) hl_null_access();
	h2d_RenderContext_end(r2);
	return;
}

void h2d_Scene_sync(h2d__Scene r0,h2d__RenderContext r1) {
	bool *r11;
	hl__types__ArrayObj r6;
	bool r2, r4;
	h2d__Camera r8;
	vdynamic *r9;
	varray *r10;
	int r5, r7;
	r2 = r0->posChanged;
	r4 = r0->allocated;
	if( r4 ) goto label$d33faab_20_4;
	h2d_Scene_onAdd(r0);
	label$d33faab_20_4:
	h2d_Object_sync(((h2d__Object)r0),r1);
	r5 = 0;
	r6 = r0->_cameras;
	label$d33faab_20_7:
	if( r6 == NULL ) hl_null_access();
	r7 = r6->length;
	if( r5 >= r7 ) goto label$d33faab_20_24;
	r7 = r6->length;
	if( ((unsigned)r5) < ((unsigned)r7) ) goto label$d33faab_20_15;
	r8 = NULL;
	goto label$d33faab_20_18;
	label$d33faab_20_15:
	r10 = r6->array;
	r9 = ((vdynamic**)(r10 + 1))[r5];
	r8 = (h2d__Camera)r9;
	label$d33faab_20_18:
	++r5;
	if( r8 == NULL ) hl_null_access();
	r4 = r2;
	r11 = &r4;
	h2d_Camera_sync(r8,r1,r11);
	goto label$d33faab_20_7;
	label$d33faab_20_24:
	return;
}

void h2d_Scene_clipBounds(h2d__Scene r0,h2d__RenderContext r1,h2d__col__Bounds r2) {
	hxd__Window r9;
	double r4, r5, r6, r7, r10, r11, r12, r13;
	int r8;
	r4 = r0->rotation;
	r5 = 0.;
	if( r4 != r5 ) goto label$d33faab_21_49;
	r4 = r0->absX;
	r4 = -r4;
	r5 = r0->absY;
	r5 = -r5;
	if( r2 == NULL ) hl_null_access();
	r7 = r2->xMin;
	if( !(r4 < r7) ) goto label$d33faab_21_11;
	r2->xMin = r4;
	label$d33faab_21_11:
	r7 = r2->xMax;
	if( !(r7 < r4) ) goto label$d33faab_21_14;
	r2->xMax = r4;
	label$d33faab_21_14:
	r7 = r2->yMin;
	if( !(r5 < r7) ) goto label$d33faab_21_17;
	r2->yMin = r5;
	label$d33faab_21_17:
	r7 = r2->yMax;
	if( !(r7 < r5) ) goto label$d33faab_21_20;
	r2->yMax = r5;
	label$d33faab_21_20:
	r9 = r0->window;
	if( r9 == NULL ) hl_null_access();
	r8 = hxd_Window_get_width(r9);
	r4 = (double)r8;
	r5 = r0->matA;
	r4 = r4 / r5;
	r5 = r0->absX;
	r4 = r4 - r5;
	r9 = r0->window;
	if( r9 == NULL ) hl_null_access();
	r8 = hxd_Window_get_height(r9);
	r5 = (double)r8;
	r6 = r0->matD;
	r5 = r5 / r6;
	r6 = r0->absY;
	r5 = r5 - r6;
	r7 = r2->xMin;
	if( !(r4 < r7) ) goto label$d33faab_21_39;
	r2->xMin = r4;
	label$d33faab_21_39:
	r7 = r2->xMax;
	if( !(r7 < r4) ) goto label$d33faab_21_42;
	r2->xMax = r4;
	label$d33faab_21_42:
	r7 = r2->yMin;
	if( !(r5 < r7) ) goto label$d33faab_21_45;
	r2->yMin = r5;
	label$d33faab_21_45:
	r7 = r2->yMax;
	if( !(r7 < r5) ) goto label$d33faab_21_48;
	r2->yMax = r5;
	label$d33faab_21_48:
	goto label$d33faab_21_171;
	label$d33faab_21_49:
	r9 = r0->window;
	if( r9 == NULL ) hl_null_access();
	r8 = hxd_Window_get_width(r9);
	r4 = (double)r8;
	r5 = r0->matA;
	r4 = r4 / r5;
	r5 = r0->absX;
	r4 = r4 - r5;
	r9 = r0->window;
	if( r9 == NULL ) hl_null_access();
	r8 = hxd_Window_get_height(r9);
	r5 = (double)r8;
	r6 = r0->matD;
	r5 = r5 / r6;
	r6 = r0->absY;
	r5 = r5 - r6;
	r6 = r0->absX;
	r6 = -r6;
	r7 = r0->absY;
	r7 = -r7;
	if( r0 == NULL ) hl_null_access();
	r11 = r0->matA;
	r10 = r6 * r11;
	r12 = r0->matC;
	r11 = r7 * r12;
	r10 = r10 + r11;
	r12 = r0->matB;
	r11 = r6 * r12;
	r13 = r0->matD;
	r12 = r7 * r13;
	r11 = r11 + r12;
	if( r2 == NULL ) hl_null_access();
	r13 = r2->xMin;
	if( !(r10 < r13) ) goto label$d33faab_21_84;
	r2->xMin = r10;
	label$d33faab_21_84:
	r13 = r2->xMax;
	if( !(r13 < r10) ) goto label$d33faab_21_87;
	r2->xMax = r10;
	label$d33faab_21_87:
	r13 = r2->yMin;
	if( !(r11 < r13) ) goto label$d33faab_21_90;
	r2->yMin = r11;
	label$d33faab_21_90:
	r13 = r2->yMax;
	if( !(r13 < r11) ) goto label$d33faab_21_93;
	r2->yMax = r11;
	label$d33faab_21_93:
	r7 = r0->absX;
	r6 = r4 - r7;
	r7 = r0->absY;
	r7 = -r7;
	r11 = r0->matA;
	r10 = r6 * r11;
	r12 = r0->matC;
	r11 = r7 * r12;
	r10 = r10 + r11;
	r12 = r0->matB;
	r11 = r6 * r12;
	r13 = r0->matD;
	r12 = r7 * r13;
	r11 = r11 + r12;
	r13 = r2->xMin;
	if( !(r10 < r13) ) goto label$d33faab_21_110;
	r2->xMin = r10;
	label$d33faab_21_110:
	r13 = r2->xMax;
	if( !(r13 < r10) ) goto label$d33faab_21_113;
	r2->xMax = r10;
	label$d33faab_21_113:
	r13 = r2->yMin;
	if( !(r11 < r13) ) goto label$d33faab_21_116;
	r2->yMin = r11;
	label$d33faab_21_116:
	r13 = r2->yMax;
	if( !(r13 < r11) ) goto label$d33faab_21_119;
	r2->yMax = r11;
	label$d33faab_21_119:
	r6 = r0->absX;
	r6 = -r6;
	r10 = r0->absY;
	r7 = r5 - r10;
	r11 = r0->matA;
	r10 = r6 * r11;
	r12 = r0->matC;
	r11 = r7 * r12;
	r10 = r10 + r11;
	r12 = r0->matB;
	r11 = r6 * r12;
	r13 = r0->matD;
	r12 = r7 * r13;
	r11 = r11 + r12;
	r13 = r2->xMin;
	if( !(r10 < r13) ) goto label$d33faab_21_136;
	r2->xMin = r10;
	label$d33faab_21_136:
	r13 = r2->xMax;
	if( !(r13 < r10) ) goto label$d33faab_21_139;
	r2->xMax = r10;
	label$d33faab_21_139:
	r13 = r2->yMin;
	if( !(r11 < r13) ) goto label$d33faab_21_142;
	r2->yMin = r11;
	label$d33faab_21_142:
	r13 = r2->yMax;
	if( !(r13 < r11) ) goto label$d33faab_21_145;
	r2->yMax = r11;
	label$d33faab_21_145:
	r7 = r0->absX;
	r6 = r4 - r7;
	r10 = r0->absY;
	r7 = r5 - r10;
	r11 = r0->matA;
	r10 = r6 * r11;
	r12 = r0->matC;
	r11 = r7 * r12;
	r10 = r10 + r11;
	r12 = r0->matB;
	r11 = r6 * r12;
	r13 = r0->matD;
	r12 = r7 * r13;
	r11 = r11 + r12;
	r13 = r2->xMin;
	if( !(r10 < r13) ) goto label$d33faab_21_162;
	r2->xMin = r10;
	label$d33faab_21_162:
	r13 = r2->xMax;
	if( !(r13 < r10) ) goto label$d33faab_21_165;
	r2->xMax = r10;
	label$d33faab_21_165:
	r13 = r2->yMin;
	if( !(r11 < r13) ) goto label$d33faab_21_168;
	r2->yMin = r11;
	label$d33faab_21_168:
	r13 = r2->yMax;
	if( !(r13 < r11) ) goto label$d33faab_21_171;
	r2->yMax = r11;
	label$d33faab_21_171:
	h2d_Object_clipBounds(((h2d__Object)r0),r1,r2);
	return;
}

void h2d_Scene_drawContent(h2d__Scene r0,h2d__RenderContext r1) {
	hl__types__ArrayObj r5, r8;
	bool r3;
	h2d__Object r18;
	hl__types__ArrayBytes_Int r14;
	h2d__Camera r9;
	vclosure *r16;
	vdynamic *r10;
	vbyte *r15;
	varray *r11;
	int r4, r6, r7, r12, r13, r17;
	if( r1 == NULL ) hl_null_access();
	r3 = r1->front2back;
	if( !r3 ) goto label$d33faab_22_78;
	r4 = 0;
	r5 = r0->_cameras;
	label$d33faab_22_5:
	if( r5 == NULL ) hl_null_access();
	r7 = r5->length;
	if( r4 >= r7 ) goto label$d33faab_22_76;
	r7 = r5->length;
	if( ((unsigned)r4) < ((unsigned)r7) ) goto label$d33faab_22_13;
	r9 = NULL;
	goto label$d33faab_22_16;
	label$d33faab_22_13:
	r11 = r5->array;
	r10 = ((vdynamic**)(r11 + 1))[r4];
	r9 = (h2d__Camera)r10;
	label$d33faab_22_16:
	++r4;
	if( r9 == NULL ) hl_null_access();
	r3 = r9->visible;
	if( r3 ) goto label$d33faab_22_21;
	goto label$d33faab_22_5;
	label$d33faab_22_21:
	r8 = r0->children;
	if( r8 == NULL ) hl_null_access();
	r6 = r8->length;
	r7 = r0->layerCount;
	h2d_Camera_enter(r9,r1);
	label$d33faab_22_26:
	r12 = r7;
	--r7;
	r13 = 0;
	if( r13 >= r12 ) goto label$d33faab_22_73;
	r13 = 0;
	if( r7 != r13 ) goto label$d33faab_22_35;
	r12 = 0;
	goto label$d33faab_22_47;
	label$d33faab_22_35:
	r14 = r0->layersIndexes;
	if( r14 == NULL ) hl_null_access();
	r13 = 1;
	r12 = r7 - r13;
	r13 = r14->length;
	if( ((unsigned)r12) < ((unsigned)r13) ) goto label$d33faab_22_43;
	r12 = 0;
	goto label$d33faab_22_47;
	label$d33faab_22_43:
	r15 = r14->bytes;
	r13 = 2;
	r13 = r12 << r13;
	r12 = *(int*)(r15 + r13);
	label$d33faab_22_47:
	if( r9 == NULL ) hl_null_access();
	r16 = r9->layerVisible;
	if( r16 == NULL ) hl_null_access();
	r3 = r16->hasValue ? ((bool (*)(vdynamic*,int))r16->fun)((vdynamic*)r16->value,r7) : ((bool (*)(int))r16->fun)(r7);
	if( !r3 ) goto label$d33faab_22_69;
	label$d33faab_22_52:
	if( r6 < r12 ) goto label$d33faab_22_68;
	r8 = r0->children;
	if( r8 == NULL ) hl_null_access();
	r13 = r6;
	--r6;
	r17 = r8->length;
	if( ((unsigned)r13) < ((unsigned)r17) ) goto label$d33faab_22_62;
	r18 = NULL;
	goto label$d33faab_22_65;
	label$d33faab_22_62:
	r11 = r8->array;
	r10 = ((vdynamic**)(r11 + 1))[r13];
	r18 = (h2d__Object)r10;
	label$d33faab_22_65:
	if( r18 == NULL ) hl_null_access();
	((void (*)(h2d__Object,h2d__RenderContext))r18->$type->vobj_proto[13])(r18,r1);
	goto label$d33faab_22_52;
	label$d33faab_22_68:
	goto label$d33faab_22_72;
	label$d33faab_22_69:
	r17 = 1;
	r13 = r12 - r17;
	r6 = r13;
	label$d33faab_22_72:
	goto label$d33faab_22_26;
	label$d33faab_22_73:
	if( r9 == NULL ) hl_null_access();
	h2d_Camera_exit(r9,r1);
	goto label$d33faab_22_5;
	label$d33faab_22_76:
	h2d_Object_draw(((h2d__Object)r0),r1);
	goto label$d33faab_22_144;
	label$d33faab_22_78:
	h2d_Object_draw(((h2d__Object)r0),r1);
	r4 = 0;
	r5 = r0->_cameras;
	label$d33faab_22_81:
	if( r5 == NULL ) hl_null_access();
	r7 = r5->length;
	if( r4 >= r7 ) goto label$d33faab_22_144;
	r7 = r5->length;
	if( ((unsigned)r4) < ((unsigned)r7) ) goto label$d33faab_22_89;
	r9 = NULL;
	goto label$d33faab_22_92;
	label$d33faab_22_89:
	r11 = r5->array;
	r10 = ((vdynamic**)(r11 + 1))[r4];
	r9 = (h2d__Camera)r10;
	label$d33faab_22_92:
	++r4;
	if( r9 == NULL ) hl_null_access();
	r3 = r9->visible;
	if( r3 ) goto label$d33faab_22_97;
	goto label$d33faab_22_81;
	label$d33faab_22_97:
	r6 = 0;
	r7 = 0;
	h2d_Camera_enter(r9,r1);
	label$d33faab_22_100:
	r13 = r0->layerCount;
	if( r7 >= r13 ) goto label$d33faab_22_141;
	r14 = r0->layersIndexes;
	if( r14 == NULL ) hl_null_access();
	r12 = r7;
	++r7;
	r13 = r14->length;
	if( ((unsigned)r12) < ((unsigned)r13) ) goto label$d33faab_22_111;
	r12 = 0;
	goto label$d33faab_22_115;
	label$d33faab_22_111:
	r15 = r14->bytes;
	r13 = 2;
	r13 = r12 << r13;
	r12 = *(int*)(r15 + r13);
	label$d33faab_22_115:
	if( r9 == NULL ) hl_null_access();
	r16 = r9->layerVisible;
	if( r16 == NULL ) hl_null_access();
	r17 = 1;
	r13 = r7 - r17;
	r3 = r16->hasValue ? ((bool (*)(vdynamic*,int))r16->fun)((vdynamic*)r16->value,r13) : ((bool (*)(int))r16->fun)(r13);
	if( !r3 ) goto label$d33faab_22_139;
	label$d33faab_22_122:
	if( r6 >= r12 ) goto label$d33faab_22_138;
	r8 = r0->children;
	if( r8 == NULL ) hl_null_access();
	r13 = r6;
	++r6;
	r17 = r8->length;
	if( ((unsigned)r13) < ((unsigned)r17) ) goto label$d33faab_22_132;
	r18 = NULL;
	goto label$d33faab_22_135;
	label$d33faab_22_132:
	r11 = r8->array;
	r10 = ((vdynamic**)(r11 + 1))[r13];
	r18 = (h2d__Object)r10;
	label$d33faab_22_135:
	if( r18 == NULL ) hl_null_access();
	((void (*)(h2d__Object,h2d__RenderContext))r18->$type->vobj_proto[13])(r18,r1);
	goto label$d33faab_22_122;
	label$d33faab_22_138:
	goto label$d33faab_22_140;
	label$d33faab_22_139:
	r6 = r12;
	label$d33faab_22_140:
	goto label$d33faab_22_100;
	label$d33faab_22_141:
	if( r9 == NULL ) hl_null_access();
	h2d_Camera_exit(r9,r1);
	goto label$d33faab_22_81;
	label$d33faab_22_144:
	return;
}

void h2d_Scene_onAdd(h2d__Scene r0) {
	hxd__Window r2;
	vclosure *r3;
	h2d_Scene_checkResize(r0);
	h2d_Object_onAdd(((h2d__Object)r0));
	r2 = r0->window;
	if( r2 == NULL ) hl_null_access();
	r3 = hl_alloc_closure_ptr(&t$fun_5fa1654,h2d_Scene_checkResize,r0);
	hxd_Window_addResizeEvent(r2,r3);
	return;
}

void h2d_Scene_onRemove(h2d__Scene r0) {
	hxd__Window r2;
	vclosure *r3;
	h2d_Object_onRemove(((h2d__Object)r0));
	r2 = r0->window;
	if( r2 == NULL ) hl_null_access();
	r3 = hl_alloc_closure_ptr(&t$fun_5fa1654,h2d_Scene_checkResize,r0);
	hxd_Window_removeResizeEvent(r2,r3);
	return;
}

void h2d_Scene_new(h2d__Scene r0) {
	hl__types__ArrayObj r7;
	hl_type *r9;
	venum *r1;
	bool r20;
	h2d__Object r3;
	h2d__Camera r11;
	hxd__Window r19;
	h2d__col__Point r16;
	h2d__RenderContext r6;
	h3d__Engine r4;
	h3d__$Engine r5;
	double r14, r15;
	double *r17, *r18;
	vdynamic *r13;
	int r10, r12;
	varray *r8;
	r1 = (venum*)g$h2d_ScaleMode_Resize;
	r0->scaleMode = r1;
	r3 = NULL;
	h2d_Layers_new(((h2d__Layers)r0),r3);
	r5 = (h3d__$Engine)g$_h3d_Engine;
	r4 = r5->CURRENT;
	r6 = (h2d__RenderContext)hl_alloc_obj(&t$h2d_RenderContext);
	h2d_RenderContext_new(r6,r0);
	r0->ctx = r6;
	r9 = &t$h2d_Camera;
	r10 = 0;
	r8 = hl_alloc_array(r9,r10);
	r7 = hl_types_ArrayObj_alloc(r8);
	r0->_cameras = r7;
	r11 = (h2d__Camera)hl_alloc_obj(&t$h2d_Camera);
	h2d_Camera_new(r11,r0);
	r7 = r0->_cameras;
	if( r7 == NULL ) hl_null_access();
	r10 = 0;
	r12 = r7->length;
	if( ((unsigned)r10) < ((unsigned)r12) ) goto label$d33faab_25_23;
	r11 = NULL;
	goto label$d33faab_25_26;
	label$d33faab_25_23:
	r8 = r7->array;
	r13 = ((vdynamic**)(r8 + 1))[r10];
	r11 = (h2d__Camera)r13;
	label$d33faab_25_26:
	r11 = h2d_Scene_set_interactiveCamera(r0,r11);
	if( r4 == NULL ) hl_null_access();
	r10 = r4->width;
	r0->width = r10;
	r10 = r4->height;
	r0->height = r10;
	r14 = 2.;
	r10 = r4->width;
	r15 = (double)r10;
	r14 = r14 / r15;
	r0->viewportA = r14;
	r14 = 2.;
	r10 = r4->height;
	r15 = (double)r10;
	r14 = r14 / r15;
	r0->viewportD = r14;
	r14 = -1.;
	r0->viewportX = r14;
	r14 = -1.;
	r0->viewportY = r14;
	r14 = 1.;
	r0->viewportScaleX = r14;
	r14 = 1.;
	r0->viewportScaleY = r14;
	r14 = 0.;
	r0->offsetX = r14;
	r14 = 0.;
	r0->offsetY = r14;
	r7 = (hl__types__ArrayObj)hl_alloc_obj(&t$hl_types_ArrayObj);
	hl_types_ArrayObj_new(r7);
	r0->interactive = r7;
	r7 = (hl__types__ArrayObj)hl_alloc_obj(&t$hl_types_ArrayObj);
	hl_types_ArrayObj_new(r7);
	r0->eventListeners = r7;
	r16 = (h2d__col__Point)hl_alloc_obj(&t$h2d_col_Point);
	r17 = NULL;
	r18 = NULL;
	h2d_col_Point_new(r16,r17,r18);
	r0->shapePoint = r16;
	r19 = hxd_Window_getInstance();
	r0->window = r19;
	r20 = true;
	r0->posChanged = r20;
	return;
}

