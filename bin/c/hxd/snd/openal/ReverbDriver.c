// Generated by HLC 4.1.5 (HL v5)
#define HLC_BOOT
#include <hlc.h>
#include <hxd/snd/openal/ReverbDriver.h>
void hxd_snd_EffectDriver_new(hxd__snd__EffectDriver);
extern hl_type t$hxd_snd_effect_LowPass;
void hxd_snd_effect_LowPass_new(hxd__snd__effect__LowPass);
#include <haxe/io/Bytes.h>
haxe__io__Bytes hxd_snd_openal_Driver_getTmpBytes(hxd__snd__openal__Driver,int);
#include <hl/natives.h>
int haxe_io_Bytes_getInt32(haxe__io__Bytes,int);
extern String s$1acc93d;
vdynamic* haxe_Exception_thrown(vdynamic*);
extern String s$ae8b669;
void haxe_io_Bytes_setInt32(haxe__io__Bytes,int,int);
#include <hxd/snd/effect/Reverb.h>
extern hl_type t$hxd_snd_effect_Reverb;
extern hl_type t$_dyn;
#include <hxd/snd/openal/SourceHandle.h>
#include <hxd/snd/Effect.h>
int hxd_snd_openal_SourceHandle_acquireAuxiliarySend(hxd__snd__openal__SourceHandle,hxd__snd__Effect);
extern String s$too_many_auxiliary_sends;
extern hxd__snd__effect__$Reverb g$_hxd_snd_effect_Reverb;
bool hl_BaseType_check(hl__BaseType,vdynamic*);
int hxd_snd_openal_SourceHandle_getAuxiliarySend(hxd__snd__openal__SourceHandle,hxd__snd__Effect);
int hxd_snd_openal_SourceHandle_releaseAuxiliarySend(hxd__snd__openal__SourceHandle,hxd__snd__Effect);

void hxd_snd_openal_ReverbDriver_new(hxd__snd__openal__ReverbDriver r0,hxd__snd__openal__Driver r1) {
	hxd__snd__effect__LowPass r3;
	hxd_snd_EffectDriver_new(((hxd__snd__EffectDriver)r0));
	r0->driver = r1;
	r3 = (hxd__snd__effect__LowPass)hl_alloc_obj(&t$hxd_snd_effect_LowPass);
	hxd_snd_effect_LowPass_new(r3);
	r0->dryFilter = r3;
	return;
}

void hxd_snd_openal_ReverbDriver_acquire(hxd__snd__openal__ReverbDriver r0) {
	String r9;
	hxd__snd__EffectDriver r11;
	haxe__io__Bytes r1, r6;
	hxd__snd__effect__LowPass r12;
	double r13;
	vdynamic *r8;
	hxd__snd__openal__Driver r2;
	vbyte *r5;
	int r3, r7, r10;
	r2 = r0->driver;
	if( r2 == NULL ) hl_null_access();
	r3 = 4;
	r1 = hxd_snd_openal_Driver_getTmpBytes(r2,r3);
	r3 = 1;
	if( r1 == NULL ) hl_null_access();
	r5 = r1->b;
	openal_al_gen_effects(r3,r5);
	r3 = 0;
	r3 = haxe_io_Bytes_getInt32(r1,r3);
	r0->inst = r3;
	r3 = openal_al_get_error();
	r7 = 0;
	if( r3 == r7 ) goto label$a231d8e_2_17;
	r9 = (String)s$1acc93d;
	r8 = haxe_Exception_thrown(((vdynamic*)r9));
	hl_throw((vdynamic*)r8);
	label$a231d8e_2_17:
	r3 = r0->inst;
	r7 = 32769;
	r10 = 1;
	openal_al_effecti(r3,r7,r10);
	r2 = r0->driver;
	if( r2 == NULL ) hl_null_access();
	r3 = 4;
	r6 = hxd_snd_openal_Driver_getTmpBytes(r2,r3);
	r3 = 1;
	if( r6 == NULL ) hl_null_access();
	r5 = r6->b;
	openal_al_gen_auxiliary_effect_slots(r3,r5);
	r3 = 0;
	r3 = haxe_io_Bytes_getInt32(r6,r3);
	r0->slot = r3;
	r3 = openal_al_get_error();
	r7 = 0;
	if( r3 == r7 ) goto label$a231d8e_2_38;
	r9 = (String)s$ae8b669;
	r8 = haxe_Exception_thrown(((vdynamic*)r9));
	hl_throw((vdynamic*)r8);
	label$a231d8e_2_38:
	r12 = r0->dryFilter;
	if( r12 == NULL ) hl_null_access();
	r11 = r12->driver;
	if( r11 == NULL ) hl_null_access();
	((void (*)(hxd__snd__EffectDriver))r11->$type->vobj_proto[0])(r11);
	r12 = r0->dryFilter;
	if( r12 == NULL ) hl_null_access();
	r13 = 1.;
	r12->gainHF = r13;
	return;
}

void hxd_snd_openal_ReverbDriver_release(hxd__snd__openal__ReverbDriver r0) {
	hxd__snd__EffectDriver r9;
	haxe__io__Bytes r5, r7;
	hxd__snd__effect__LowPass r10;
	hxd__snd__openal__Driver r6;
	vbyte *r8;
	int r2, r3, r4;
	r2 = r0->slot;
	r3 = 1;
	r4 = 0;
	openal_al_auxiliary_effect_sloti(r2,r3,r4);
	r6 = r0->driver;
	if( r6 == NULL ) hl_null_access();
	r2 = 4;
	r5 = hxd_snd_openal_Driver_getTmpBytes(r6,r2);
	if( r5 == NULL ) hl_null_access();
	r2 = 0;
	r3 = r0->slot;
	haxe_io_Bytes_setInt32(r5,r2,r3);
	r2 = 1;
	r8 = r5->b;
	openal_al_delete_auxiliary_effect_slots(r2,r8);
	r6 = r0->driver;
	if( r6 == NULL ) hl_null_access();
	r2 = 4;
	r7 = hxd_snd_openal_Driver_getTmpBytes(r6,r2);
	if( r7 == NULL ) hl_null_access();
	r2 = 0;
	r3 = r0->inst;
	haxe_io_Bytes_setInt32(r7,r2,r3);
	r2 = 1;
	r8 = r7->b;
	openal_al_delete_effects(r2,r8);
	r10 = r0->dryFilter;
	if( r10 == NULL ) hl_null_access();
	r9 = r10->driver;
	if( r9 == NULL ) hl_null_access();
	((void (*)(hxd__snd__EffectDriver))r9->$type->vobj_proto[1])(r9);
	return;
}

void hxd_snd_openal_ReverbDriver_update(hxd__snd__openal__ReverbDriver r0,vdynamic* r1) {
	float r9;
	hxd__snd__effect__Reverb r2;
	double r6, r7, r8;
	int r4, r5, r10;
	r2 = (hxd__snd__effect__Reverb)hl_dyn_castp(&r1,&t$_dyn,&t$hxd_snd_effect_Reverb);
	r4 = r0->inst;
	r5 = 3;
	r6 = 10.;
	if( r2 == NULL ) hl_null_access();
	r7 = r2->room;
	r8 = 100.;
	r7 = r7 / r8;
	r8 = 20.;
	r7 = r7 / r8;
	r6 = hl_math_pow(r6,r7);
	r9 = (float)r6;
	openal_al_effectf(r4,r5,r9);
	r4 = r0->inst;
	r5 = 4;
	r6 = 10.;
	r7 = r2->roomHF;
	r8 = 100.;
	r7 = r7 / r8;
	r8 = 20.;
	r7 = r7 / r8;
	r6 = hl_math_pow(r6,r7);
	r9 = (float)r6;
	openal_al_effectf(r4,r5,r9);
	r4 = r0->inst;
	r5 = 12;
	r6 = r2->roomRolloffFactor;
	r9 = (float)r6;
	openal_al_effectf(r4,r5,r9);
	r4 = r0->inst;
	r5 = 5;
	r6 = r2->decayTime;
	r9 = (float)r6;
	openal_al_effectf(r4,r5,r9);
	r4 = r0->inst;
	r5 = 6;
	r6 = r2->decayHFRatio;
	r9 = (float)r6;
	openal_al_effectf(r4,r5,r9);
	r4 = r0->inst;
	r5 = 7;
	r6 = 10.;
	r7 = r2->reflections;
	r8 = 100.;
	r7 = r7 / r8;
	r8 = 20.;
	r7 = r7 / r8;
	r6 = hl_math_pow(r6,r7);
	r9 = (float)r6;
	openal_al_effectf(r4,r5,r9);
	r4 = r0->inst;
	r5 = 8;
	r6 = r2->reflectionsDelay;
	r9 = (float)r6;
	openal_al_effectf(r4,r5,r9);
	r4 = r0->inst;
	r5 = 9;
	r6 = 10.;
	r7 = r2->reverb;
	r8 = 100.;
	r7 = r7 / r8;
	r8 = 20.;
	r7 = r7 / r8;
	r6 = hl_math_pow(r6,r7);
	r9 = (float)r6;
	openal_al_effectf(r4,r5,r9);
	r4 = r0->inst;
	r5 = 10;
	r6 = r2->reverbDelay;
	r9 = (float)r6;
	openal_al_effectf(r4,r5,r9);
	r4 = r0->inst;
	r5 = 2;
	r6 = r2->diffusion;
	r7 = 100.;
	r6 = r6 / r7;
	r9 = (float)r6;
	openal_al_effectf(r4,r5,r9);
	r4 = r0->inst;
	r5 = 1;
	r6 = r2->density;
	r7 = 100.;
	r6 = r6 / r7;
	r9 = (float)r6;
	openal_al_effectf(r4,r5,r9);
	r4 = r0->slot;
	r5 = 1;
	r10 = r0->inst;
	openal_al_auxiliary_effect_sloti(r4,r5,r10);
	r4 = r0->slot;
	r5 = 2;
	r6 = r2->wetDryMix;
	r7 = 100.;
	r6 = r6 / r7;
	r9 = (float)r6;
	openal_al_auxiliary_effect_slotf(r4,r5,r9);
	r6 = r2->decayTime;
	r7 = r2->reflectionsDelay;
	r6 = r6 + r7;
	r7 = r2->reverbDelay;
	r6 = r6 + r7;
	r2->retainTime = r6;
	return;
}

void hxd_snd_openal_ReverbDriver_bind(hxd__snd__openal__ReverbDriver r0,vdynamic* r1,hxd__snd__openal__SourceHandle r2) {
	String r10;
	hxd__snd__effect__Reverb r4;
	hxd__snd__openal__Driver r9;
	vdynamic *r3;
	int r6, r7, r8;
	r4 = (hxd__snd__effect__Reverb)hl_dyn_castp(&r1,&t$_dyn,&t$hxd_snd_effect_Reverb);
	if( r2 == NULL ) hl_null_access();
	r6 = hxd_snd_openal_SourceHandle_acquireAuxiliarySend(r2,((hxd__snd__Effect)r4));
	r8 = 1;
	r7 = r6 + r8;
	r9 = r0->driver;
	if( r9 == NULL ) hl_null_access();
	r8 = r9->maxAuxiliarySends;
	if( r8 >= r7 ) goto label$a231d8e_5_12;
	r10 = (String)s$too_many_auxiliary_sends;
	r3 = haxe_Exception_thrown(((vdynamic*)r10));
	hl_throw((vdynamic*)r3);
	label$a231d8e_5_12:
	return;
}

void hxd_snd_openal_ReverbDriver_apply(hxd__snd__openal__ReverbDriver r0,vdynamic* r1,hxd__snd__openal__SourceHandle r2) {
	bool r7;
	hxd__snd__effect__$Reverb r5;
	hxd__snd__effect__Reverb r3, r6;
	int r8, r9, r10, r11, r12;
	r3 = (hxd__snd__effect__Reverb)hl_dyn_castp(&r1,&t$_dyn,&t$hxd_snd_effect_Reverb);
	r5 = (hxd__snd__effect__$Reverb)g$_hxd_snd_effect_Reverb;
	r7 = hl_BaseType_check(((hl__BaseType)r5),((vdynamic*)r3));
	if( !r7 ) goto label$a231d8e_6_6;
	r6 = r3;
	goto label$a231d8e_6_7;
	label$a231d8e_6_6:
	r6 = NULL;
	label$a231d8e_6_7:
	if( r2 == NULL ) hl_null_access();
	r8 = hxd_snd_openal_SourceHandle_getAuxiliarySend(r2,((hxd__snd__Effect)r6));
	r9 = r2->inst;
	r10 = 131078;
	r11 = r0->slot;
	r12 = 0;
	openal_al_source3i(r9,r10,r11,r8,r12);
	return;
}

void hxd_snd_openal_ReverbDriver_unbind(hxd__snd__openal__ReverbDriver r0,vdynamic* r1,hxd__snd__openal__SourceHandle r2) {
	hxd__snd__effect__Reverb r3;
	int r5, r6, r7, r8, r9;
	r3 = (hxd__snd__effect__Reverb)hl_dyn_castp(&r1,&t$_dyn,&t$hxd_snd_effect_Reverb);
	if( r2 == NULL ) hl_null_access();
	r5 = hxd_snd_openal_SourceHandle_releaseAuxiliarySend(r2,((hxd__snd__Effect)r3));
	r6 = r2->inst;
	r7 = 131078;
	r8 = 0;
	r9 = 0;
	openal_al_source3i(r6,r7,r8,r5,r9);
	return;
}

