// Generated by HLC 4.1.5 (HL v5)
#define HLC_BOOT
#include <hlc.h>
#include <hxd/Key.h>
extern hxd__$Key g$_hxd_Key;
#include <hxd/Window.h>
void hxd_Key_onEvent(hxd__Event);
extern hl_type t$fun_b4832bf;
void hxd_Key_dispose(void);
#include <hl/natives.h>
hl__types__ArrayBytes_Int hl_types_ArrayBase_allocI32(vbyte*,int);
hxd__Window hxd_Window_getInstance(void);
void hxd_Window_addEventTarget(hxd__Window,vclosure*);
void hxd_Window_removeEventTarget(hxd__Window,vclosure*);
#include <hxd/EventKind.h>
#include <hxd/Timer.h>
extern hxd__$Timer g$_hxd_Timer;
void hl_types_ArrayBytes_Int___expand(hl__types__ArrayBytes_Int,int);

bool hxd_Key_isDown(int r0) {
	bool r1;
	hl__types__ArrayBytes_Int r2;
	vbyte *r6;
	int r4, r5;
	hxd__$Key r3;
	r3 = (hxd__$Key)g$_hxd_Key;
	r2 = r3->keyPressed;
	if( r2 == NULL ) hl_null_access();
	r5 = r2->length;
	if( ((unsigned)r0) < ((unsigned)r5) ) goto label$ae0efc9_1_7;
	r4 = 0;
	goto label$ae0efc9_1_11;
	label$ae0efc9_1_7:
	r6 = r2->bytes;
	r5 = 2;
	r5 = r0 << r5;
	r4 = *(int*)(r6 + r5);
	label$ae0efc9_1_11:
	r5 = 0;
	if( r4 > r5 ) goto label$ae0efc9_1_15;
	r1 = false;
	goto label$ae0efc9_1_16;
	label$ae0efc9_1_15:
	r1 = true;
	label$ae0efc9_1_16:
	return r1;
}

void hxd_Key_initialize() {
	bool r1;
	hl__types__ArrayBytes_Int r3;
	hxd__Window r6;
	vclosure *r7;
	int r5;
	vbyte *r4;
	hxd__$Key r2;
	static vclosure cl$0 = { &t$fun_b4832bf, hxd_Key_onEvent, 0 };
	r2 = (hxd__$Key)g$_hxd_Key;
	r1 = r2->initDone;
	if( !r1 ) goto label$ae0efc9_2_4;
	hxd_Key_dispose();
	label$ae0efc9_2_4:
	r1 = true;
	r2 = (hxd__$Key)g$_hxd_Key;
	r2->initDone = r1;
	r5 = 0;
	r4 = hl_alloc_bytes(r5);
	r5 = 0;
	r5 = 0;
	r3 = hl_types_ArrayBase_allocI32(r4,r5);
	r2 = (hxd__$Key)g$_hxd_Key;
	r2->keyPressed = r3;
	r6 = hxd_Window_getInstance();
	if( r6 == NULL ) hl_null_access();
	r7 = &cl$0;
	hxd_Window_addEventTarget(r6,r7);
	return;
}

void hxd_Key_dispose() {
	bool r1;
	hl__types__ArrayBytes_Int r5;
	hxd__Window r3;
	vclosure *r4;
	int r7;
	vbyte *r6;
	hxd__$Key r2;
	static vclosure cl$0 = { &t$fun_b4832bf, hxd_Key_onEvent, 0 };
	r2 = (hxd__$Key)g$_hxd_Key;
	r1 = r2->initDone;
	if( !r1 ) goto label$ae0efc9_3_17;
	r3 = hxd_Window_getInstance();
	if( r3 == NULL ) hl_null_access();
	r4 = &cl$0;
	hxd_Window_removeEventTarget(r3,r4);
	r1 = false;
	r2 = (hxd__$Key)g$_hxd_Key;
	r2->initDone = r1;
	r7 = 0;
	r6 = hl_alloc_bytes(r7);
	r7 = 0;
	r7 = 0;
	r5 = hl_types_ArrayBase_allocI32(r6,r7);
	r2 = (hxd__$Key)g$_hxd_Key;
	r2->keyPressed = r5;
	label$ae0efc9_3_17:
	return;
}

void hxd_Key_onEvent(hxd__Event r0) {
	venum *r3;
	bool r12;
	hl__types__ArrayBytes_Int r5;
	hxd__$Timer r7;
	double r10, r11;
	vbyte *r9;
	hxd__$Key r6;
	int r2, r4, r8;
	if( r0 == NULL ) hl_null_access();
	r3 = r0->kind;
	if( r3 == NULL ) hl_null_access();
	r2 = HL__ENUM_INDEX__(r3);
	switch(r2) {
		default:
		case 2:
		case 3:
		case 4:
		case 6:
		case 7:
			goto label$ae0efc9_4_116;
		case 0:
			r2 = r0->button;
			r4 = 5;
			if( r2 >= r4 ) goto label$ae0efc9_4_24;
			r6 = (hxd__$Key)g$_hxd_Key;
			r5 = r6->keyPressed;
			if( r5 == NULL ) hl_null_access();
			r2 = r0->button;
			r7 = (hxd__$Timer)g$_hxd_Timer;
			r4 = r7->frameCount;
			r8 = 1;
			r4 = r4 + r8;
			r8 = r5->length;
			if( ((unsigned)r2) < ((unsigned)r8) ) goto label$ae0efc9_4_20;
			hl_types_ArrayBytes_Int___expand(r5,r2);
			label$ae0efc9_4_20:
			r9 = r5->bytes;
			r8 = 2;
			r8 = r2 << r8;
			*(int*)(r9 + r8) = r4;
			label$ae0efc9_4_24:
			goto label$ae0efc9_4_116;
		case 1:
			r2 = r0->button;
			r4 = 5;
			if( r2 >= r4 ) goto label$ae0efc9_4_44;
			r6 = (hxd__$Key)g$_hxd_Key;
			r5 = r6->keyPressed;
			if( r5 == NULL ) hl_null_access();
			r2 = r0->button;
			r7 = (hxd__$Timer)g$_hxd_Timer;
			r4 = r7->frameCount;
			r8 = 1;
			r4 = r4 + r8;
			r4 = -r4;
			r8 = r5->length;
			if( ((unsigned)r2) < ((unsigned)r8) ) goto label$ae0efc9_4_40;
			hl_types_ArrayBytes_Int___expand(r5,r2);
			label$ae0efc9_4_40:
			r9 = r5->bytes;
			r8 = 2;
			r8 = r2 << r8;
			*(int*)(r9 + r8) = r4;
			label$ae0efc9_4_44:
			goto label$ae0efc9_4_116;
		case 5:
			r6 = (hxd__$Key)g$_hxd_Key;
			r5 = r6->keyPressed;
			if( r5 == NULL ) hl_null_access();
			r10 = r0->wheelDelta;
			r11 = 0.;
			if( !(r11 < r10) ) goto label$ae0efc9_4_53;
			r2 = 6;
			goto label$ae0efc9_4_54;
			label$ae0efc9_4_53:
			r2 = 5;
			label$ae0efc9_4_54:
			r7 = (hxd__$Timer)g$_hxd_Timer;
			r4 = r7->frameCount;
			r8 = 1;
			r4 = r4 + r8;
			r8 = r5->length;
			if( ((unsigned)r2) < ((unsigned)r8) ) goto label$ae0efc9_4_61;
			hl_types_ArrayBytes_Int___expand(r5,r2);
			label$ae0efc9_4_61:
			r9 = r5->bytes;
			r8 = 2;
			r8 = r2 << r8;
			*(int*)(r9 + r8) = r4;
			goto label$ae0efc9_4_116;
		case 8:
			r6 = (hxd__$Key)g$_hxd_Key;
			r12 = r6->ALLOW_KEY_REPEAT;
			if( r12 ) goto label$ae0efc9_4_84;
			r6 = (hxd__$Key)g$_hxd_Key;
			r5 = r6->keyPressed;
			if( r5 == NULL ) hl_null_access();
			r2 = r0->keyCode;
			r4 = r5->length;
			if( ((unsigned)r2) < ((unsigned)r4) ) goto label$ae0efc9_4_77;
			r2 = 0;
			goto label$ae0efc9_4_81;
			label$ae0efc9_4_77:
			r9 = r5->bytes;
			r4 = 2;
			r4 = r2 << r4;
			r2 = *(int*)(r9 + r4);
			label$ae0efc9_4_81:
			r4 = 0;
			if( r4 >= r2 ) goto label$ae0efc9_4_84;
			return;
			label$ae0efc9_4_84:
			r6 = (hxd__$Key)g$_hxd_Key;
			r5 = r6->keyPressed;
			if( r5 == NULL ) hl_null_access();
			r2 = r0->keyCode;
			r7 = (hxd__$Timer)g$_hxd_Timer;
			r4 = r7->frameCount;
			r8 = 1;
			r4 = r4 + r8;
			r8 = r5->length;
			if( ((unsigned)r2) < ((unsigned)r8) ) goto label$ae0efc9_4_95;
			hl_types_ArrayBytes_Int___expand(r5,r2);
			label$ae0efc9_4_95:
			r9 = r5->bytes;
			r8 = 2;
			r8 = r2 << r8;
			*(int*)(r9 + r8) = r4;
			goto label$ae0efc9_4_116;
		case 9:
			r6 = (hxd__$Key)g$_hxd_Key;
			r5 = r6->keyPressed;
			if( r5 == NULL ) hl_null_access();
			r2 = r0->keyCode;
			r7 = (hxd__$Timer)g$_hxd_Timer;
			r4 = r7->frameCount;
			r8 = 1;
			r4 = r4 + r8;
			r4 = -r4;
			r8 = r5->length;
			if( ((unsigned)r2) < ((unsigned)r8) ) goto label$ae0efc9_4_112;
			hl_types_ArrayBytes_Int___expand(r5,r2);
			label$ae0efc9_4_112:
			r9 = r5->bytes;
			r8 = 2;
			r8 = r2 << r8;
			*(int*)(r9 + r8) = r4;
	}
	label$ae0efc9_4_116:
	return;
}

